import{j as e,w as l,o as a,a as t,b as o,c as s,F as u,p as r,t as n,l as i,q as d,y as m,s as c,d as v,B as p,r as g,x as b}from"./HXycOAlW.js";import{_ as y}from"./D1uvpjsy.js";import{G as f}from"./0iwS8AcL.js";import{s as x}from"./BxyD9DOn.js";import"./CP1Hj45X.js";import"./CPBe7JJp.js";import"./BadZoQ71.js";import"./Dyo0McTI.js";import"./BCo6x5W8.js";const h={class:"space-y-6"},w={key:0,class:"bg-gray-50 p-4 rounded-lg"},k={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},j={class:"flex justify-center mb-3"},U=["src"],V={class:"text-center"},C={class:"font-medium truncate"},z={class:"text-sm text-gray-500"},B=["onClick"],M={key:1,class:"space-y-4"},L={class:"bg-gray-50 p-4 rounded-lg"},P={class:"space-y-3"},Y={key:0,class:"bg-gray-50 p-4 rounded-lg"},X={class:"space-y-3"},$={class:"grid grid-cols-2 gap-2"},q={class:"text-right text-sm text-gray-500"},G={class:"grid grid-cols-2 gap-2"},R={key:1,class:"bg-gray-50 p-4 rounded-lg"},_={class:"space-y-3"},W={key:0},F={class:"flex justify-center"},E=["src"],O={class:"text-right text-sm text-gray-500"},J={class:"grid grid-cols-2 gap-2"},N={class:"bg-gray-50 p-4 rounded-lg"},T={class:"space-y-3"},A={key:0},H={class:"text-right text-sm text-gray-500"},I={class:"flex space-x-4"},K=["disabled"],Z={key:0},D={key:1,class:"flex items-center justify-center"},Q={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},S={class:"flex items-center justify-between mb-2"},ee={class:"text-blue-700"},le={class:"w-full bg-gray-200 rounded-full h-2.5"},ae={class:"mt-2 text-sm text-blue-700"},te={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},oe={class:"mt-2 text-green-700"},se={class:"mt-3 space-y-2"},ue=["href","download"],re={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ne={class:"mt-2 text-red-700"},ie={key:0,class:"mt-2 text-sm text-gray-600"},de={__name:"index",setup(de){const me=g({type:"text"}),ce=g({text:"Watermark",size:30,opacity:30,color:"#000000",position:"bottom-right",marginX:20,marginY:20}),ve=g({image:null,opacity:30,position:"bottom-right",marginX:20,marginY:20}),pe=g({format:"same",quality:90}),ge=g([]),be=b(()=>ge.value),ye=g(!1),fe=g(!1),xe=g(""),he=g(""),we=g(""),ke=g(0),je=g(""),Ue=g([]),Ve=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 选择水印类型：文本水印或图片水印","3. 配置水印参数：根据选择的类型设置相应的参数",'4. 点击"开始添加水印"按钮进行处理',"5. 等待处理完成，下载添加水印后的图片"],Ce=e=>e.split(".").pop().toLowerCase(),ze=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},Be=e=>{const l=e.target.files[0];l&&(ve.value.image=URL.createObjectURL(l))},Me=e=>{ge.value=e,he.value="",fe.value=!1},Le=e=>{he.value=e,we.value=Pe(e)},Pe=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Ye=async()=>{if(0!==be.length)if("text"!==me.value.type||ce.value.text)if("image"!==me.value.type||ve.value.image){ye.value=!0,he.value="",we.value="",fe.value=!1,ke.value=0,je.value="准备处理...",Ue.value=[];try{await new Promise(e=>{let l=0;const a=x(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),ke.value=l,je.value=l<30?"正在分析图片...":l<60?"正在准备水印...":l<90?"正在添加水印...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});be.value,me.value,ce.value,ve.value,pe.value;xe.value=`成功为 ${be.length} 个图片添加水印！`,fe.value=!0,be.forEach((e,l)=>{const a=Ce(e.name),t="same"===pe.value.format?a:pe.value.format,o=new Blob(["模拟添加水印后的图片内容"],{type:`image/${t}`}),s=URL.createObjectURL(o),u=`watermarked_${e.name.replace(/\.[^/.]+$/,`.${t}`)}`;Ue.value.push({url:s,filename:u})}),Ue.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=Ue.value[0].url,e.download=Ue.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){he.value=`处理失败：${e.message||"未知错误"}`,we.value=Pe(he.value)}finally{ye.value=!1}}else he.value="请上传水印图片";else he.value="请输入水印文本";else he.value="请选择文件"},Xe=()=>{ge.value=[],me.value={type:"text"},ce.value={text:"Watermark",size:30,opacity:30,color:"#000000",position:"bottom-right",marginX:20,marginY:20},ve.value={image:null,opacity:30,position:"bottom-right",marginX:20,marginY:20},pe.value={format:"same",quality:90},he.value="",we.value="",fe.value=!1,xe.value="",ke.value=0,je.value="",Ue.value=[]};return(g,b)=>(a(),e(y,{title:"图片水印添加",description:"为图片添加文字或图片水印，保护版权",tips:Ve},{default:l(()=>[t("div",h,[o(f,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":104857600,modelValue:ge.value,"onUpdate:modelValue":b[0]||(b[0]=e=>ge.value=e),onFilesChanged:Me,onError:Le},null,8,["modelValue"]),be.value.length>0?(a(),s("div",w,[b[15]||(b[15]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",k,[(a(!0),s(u,null,r(be.value,(e,l)=>(a(),s("div",{key:l,class:"bg-white rounded border p-3"},[t("div",j,[t("img",{src:g.URL.createObjectURL(e),class:"max-h-32 object-contain",alt:"Preview"},null,8,U)]),t("div",V,[t("div",C,n(e.name),1),t("div",z,n(Ce(e.name))+" • "+n(ze(e.size)),1)]),t("button",{onClick:e=>(e=>{ge.value.splice(e,1),0===ge.value.length&&Xe()})(l),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,B)]))),128))])])):i("",!0),be.value.length>0?(a(),s("div",M,[t("div",L,[b[18]||(b[18]=t("h3",{class:"text-lg font-semibold mb-3"},"水印类型",-1)),t("div",P,[t("div",null,[b[17]||(b[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印类型",-1)),d(t("select",{"onUpdate:modelValue":b[1]||(b[1]=e=>me.value.type=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[16]||(b[16]=[t("option",{value:"text"},"文本水印",-1),t("option",{value:"image"},"图片水印",-1)])],512),[[m,me.value.type]])])])]),"text"===me.value.type?(a(),s("div",Y,[b[27]||(b[27]=t("h3",{class:"text-lg font-semibold mb-3"},"文本水印设置",-1)),t("div",X,[t("div",null,[b[19]||(b[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印文本",-1)),d(t("input",{"onUpdate:modelValue":b[2]||(b[2]=e=>ce.value.text=e),type:"text",placeholder:"请输入水印文本",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.text]])]),t("div",$,[t("div",null,[b[20]||(b[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"字体大小",-1)),d(t("input",{"onUpdate:modelValue":b[3]||(b[3]=e=>ce.value.size=e),type:"number",min:"10",max:"200",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.size,void 0,{number:!0}]])]),t("div",null,[b[21]||(b[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"透明度",-1)),d(t("input",{"onUpdate:modelValue":b[4]||(b[4]=e=>ce.value.opacity=e),type:"range",min:"0",max:"100",class:"w-full"},null,512),[[c,ce.value.opacity,void 0,{number:!0}]]),t("div",q,n(ce.value.opacity)+"%",1)])]),t("div",null,[b[22]||(b[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"字体颜色",-1)),d(t("input",{"onUpdate:modelValue":b[5]||(b[5]=e=>ce.value.color=e),type:"color",class:"w-full h-10 border border-gray-300 rounded-md"},null,512),[[c,ce.value.color]])]),t("div",null,[b[24]||(b[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印位置",-1)),d(t("select",{"onUpdate:modelValue":b[6]||(b[6]=e=>ce.value.position=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[23]||(b[23]=[t("option",{value:"top-left"},"左上角",-1),t("option",{value:"top-right"},"右上角",-1),t("option",{value:"bottom-left"},"左下角",-1),t("option",{value:"bottom-right"},"右下角",-1),t("option",{value:"center"},"居中",-1)])],512),[[m,ce.value.position]])]),t("div",G,[t("div",null,[b[25]||(b[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水平边距",-1)),d(t("input",{"onUpdate:modelValue":b[7]||(b[7]=e=>ce.value.marginX=e),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.marginX,void 0,{number:!0}]])]),t("div",null,[b[26]||(b[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"垂直边距",-1)),d(t("input",{"onUpdate:modelValue":b[8]||(b[8]=e=>ce.value.marginY=e),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.marginY,void 0,{number:!0}]])])])])])):i("",!0),"image"===me.value.type?(a(),s("div",R,[b[35]||(b[35]=t("h3",{class:"text-lg font-semibold mb-3"},"图片水印设置",-1)),t("div",_,[t("div",null,[b[28]||(b[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"上传水印图片",-1)),t("input",{type:"file",accept:".png, .jpg, .jpeg, .webp",onChange:Be,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,32)]),ve.value.image?(a(),s("div",W,[b[29]||(b[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印预览",-1)),t("div",F,[t("img",{src:ve.value.image,class:"max-h-24 object-contain",alt:"Watermark Preview"},null,8,E)])])):i("",!0),t("div",null,[b[30]||(b[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"透明度",-1)),d(t("input",{"onUpdate:modelValue":b[9]||(b[9]=e=>ve.value.opacity=e),type:"range",min:"0",max:"100",class:"w-full"},null,512),[[c,ve.value.opacity,void 0,{number:!0}]]),t("div",O,n(ve.value.opacity)+"%",1)]),t("div",null,[b[32]||(b[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印位置",-1)),d(t("select",{"onUpdate:modelValue":b[10]||(b[10]=e=>ve.value.position=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[31]||(b[31]=[t("option",{value:"top-left"},"左上角",-1),t("option",{value:"top-right"},"右上角",-1),t("option",{value:"bottom-left"},"左下角",-1),t("option",{value:"bottom-right"},"右下角",-1),t("option",{value:"center"},"居中",-1)])],512),[[m,ve.value.position]])]),t("div",J,[t("div",null,[b[33]||(b[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水平边距",-1)),d(t("input",{"onUpdate:modelValue":b[11]||(b[11]=e=>ve.value.marginX=e),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ve.value.marginX,void 0,{number:!0}]])]),t("div",null,[b[34]||(b[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"垂直边距",-1)),d(t("input",{"onUpdate:modelValue":b[12]||(b[12]=e=>ve.value.marginY=e),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ve.value.marginY,void 0,{number:!0}]])])])])])):i("",!0),t("div",N,[b[39]||(b[39]=t("h3",{class:"text-lg font-semibold mb-3"},"输出设置",-1)),t("div",T,[t("div",null,[b[37]||(b[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),d(t("select",{"onUpdate:modelValue":b[13]||(b[13]=e=>pe.value.format=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[36]||(b[36]=[t("option",{value:"same"},"保持原格式",-1),t("option",{value:"png"},"PNG",-1),t("option",{value:"jpg"},"JPG",-1),t("option",{value:"webp"},"WebP",-1)])],512),[[m,pe.value.format]])]),"jpg"===pe.value.format||"webp"===pe.value.format?(a(),s("div",A,[b[38]||(b[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出质量",-1)),d(t("input",{"onUpdate:modelValue":b[14]||(b[14]=e=>pe.value.quality=e),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[c,pe.value.quality,void 0,{number:!0}]]),t("div",H,n(pe.value.quality)+"%",1)])):i("",!0)])])])):i("",!0),t("div",I,[t("button",{onClick:Ye,disabled:!be.value.length||ye.value||"text"===me.value.type&&!ce.value.text||"image"===me.value.type&&!ve.value.image,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[ye.value?(a(),s("span",D,[b[40]||(b[40]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),v(" 处理中... "+n(ke.value)+"% ",1)])):(a(),s("span",Z,"开始添加水印"))],8,K),t("button",{onClick:Xe,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),ye.value?(a(),s("div",Q,[t("div",S,[b[41]||(b[41]=t("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),t("span",ee,n(ke.value)+"%",1)]),t("div",le,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:p({width:ke.value+"%"})},null,4)]),t("p",ae,n(je.value),1)])):i("",!0),fe.value?(a(),s("div",te,[b[42]||(b[42]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),t("p",oe,n(xe.value),1),t("div",se,[(a(!0),s(u,null,r(Ue.value,(e,l)=>(a(),s("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载水印结果 "+n(l+1),9,ue))),128))])])):i("",!0),he.value?(a(),s("div",re,[b[43]||(b[43]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),t("p",ne,n(he.value),1),we.value?(a(),s("p",ie,"建议："+n(we.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{de as default};
