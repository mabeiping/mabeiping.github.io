import{j as q,w as K,o as n,a as l,b as X,c as r,F as L,p as B,t as v,l as c,q as m,v as J,C as O,y as U,s as C,d as Q,B as Y,r as a,x as Z}from"./5KiIeb3O.js";import{_ as ee}from"./D50zL9At.js";import{G as le}from"./9UHln5xC.js";import{s as te}from"./CkncbWtC.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";import"./DlAUqK2U.js";const se={class:"space-y-6"},oe={key:0,class:"bg-gray-50 p-4 rounded-lg"},ne={class:"space-y-2"},re={class:"flex items-center"},ae={class:"font-medium"},ue={class:"text-sm text-gray-500"},ie=["onClick"],de={key:1,class:"bg-gray-50 p-4 rounded-lg"},ve={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},ce=["value"],pe={class:"font-medium"},me={class:"text-sm text-gray-500"},ge={key:2,class:"space-y-4"},be={class:"space-y-2"},fe={class:"flex items-center space-x-2"},xe={class:"flex items-center space-x-2"},ye={class:"flex items-center space-x-2"},he={key:0,class:"bg-white p-4 rounded-lg border"},we={key:0},ke={key:0,class:"mt-2"},Fe={key:1},Me={key:0,class:"mt-2"},Ce={key:1,class:"bg-white p-4 rounded-lg border"},Ve={class:"space-y-2"},_e={class:"flex space-x-4"},Le=["disabled"],Be={key:0},Oe={key:1,class:"flex items-center justify-center"},Ue={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Pe={class:"flex items-center justify-between mb-2"},ze={class:"text-blue-700"},Te={class:"w-full bg-gray-200 rounded-full h-2.5"},je={class:"mt-2 text-sm text-blue-700"},Se={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},$e={class:"mt-2 text-green-700"},Ee={class:"mt-3 space-y-2"},Ie=["href","download"],He={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ne={class:"mt-2 text-red-700"},Ae={key:0,class:"mt-2 text-sm text-gray-600"},Ze={__name:"index",setup(De){const P=[{value:"docx",label:"Word (.docx)",description:"适合编辑和共享",extensions:[".docx",".doc"]},{value:"md",label:"Markdown (.md)",description:"适合写作和版本控制",extensions:[".md"]},{value:"html",label:"HTML (.html)",description:"适合网页展示",extensions:[".html"]},{value:"txt",label:"文本 (.txt)",description:"纯文本格式",extensions:[".txt"]},{value:"split",label:"拆分文档",description:"将文档拆分为多个文件",extensions:[".docx",".doc"]},{value:"merge",label:"合并文档",description:"将多个文档合并为一个文件",extensions:[".docx",".doc"]},{value:"encrypt",label:"加密文档",description:"为文档添加密码保护",extensions:[".docx",".doc"]}],o=a(""),f=a({includeImages:!0,preserveFormatting:!0,handleLinks:!0}),i=a({splitMode:"page",pagesPerFile:1,mergeOrder:"upload",customOrder:""}),p=a({password:"",confirmPassword:"",encryptionLevel:"medium"}),g=a([]),b=Z(()=>g.value),F=a(!1),M=a(!1),V=a(""),d=a(""),y=a(""),h=a(0),w=a(""),x=a([]),k=a([]),$=["1. 上传文件：支持Word、Markdown、HTML和文本格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含图片、保留格式、处理超链接等","5. 对于拆分/合并/加密操作，设置相应的选项",'6. 点击"开始转换"按钮进行处理',"7. 等待处理完成，系统会自动下载处理后的文件","8. 查看处理结果，确保内容和格式的准确性"],z=s=>s.split(".").pop().toLowerCase(),E=s=>{if(s===0)return"0 B";const e=1024,t=["B","KB","MB","GB"],u=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,u)).toFixed(2))+" "+t[u]},I=s=>{g.value.splice(s,1),g.value.length===0?S():T()},H=s=>{g.value=s,s.length>0?T():(k.value=[],o.value=""),d.value="",M.value=!1},T=()=>{if(g.value.length===0){k.value=[];return}const s=z(g.value[0].name),e=[];P.forEach(t=>{(!t.extensions.some(u=>s===u.replace(".",""))||t.value==="split"||t.value==="merge"||t.value==="encrypt")&&e.push(t)}),k.value=e,e.length>0?o.value=e[0].value:o.value=""},N=s=>{d.value=s,y.value=j(s)},j=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",A=()=>new Promise(s=>{let e=0;const t=te(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),h.value=e,e<30?w.value="正在分析文件...":e<70?w.value="正在转换文件...":w.value="正在生成结果...",e===100&&(clearInterval(t),setTimeout(s,500))},500)}),D=async()=>{if(b.length===0){d.value="请选择文件";return}if(!o.value){d.value="请选择目标格式";return}if(o.value==="encrypt"){if(!p.value.password){d.value="请输入加密密码";return}if(p.value.password!==p.value.confirmPassword){d.value="两次输入的密码不一致";return}}F.value=!0,d.value="",y.value="",M.value=!1,h.value=0,w.value="准备转换...",x.value=[];try{await A();let s={files:b.value,targetFormat:o.value,options:f.value};o.value==="split"||o.value==="merge"?s.splitMergeOptions=i.value:o.value==="encrypt"&&(s.encryptOptions=p.value),console.log("转换参数:",s);const e=P.find(t=>t.value===o.value);V.value=`成功将 ${b.length} 个文件转换为 ${e.label} 格式！`,M.value=!0,b.forEach((t,u)=>{let _=o.value;(o.value==="split"||o.value==="merge"||o.value==="encrypt")&&(_="docx");const G=new Blob(["模拟转换后的文件内容"],{type:"application/octet-stream"}),R=URL.createObjectURL(G),W=`converted_${t.name.replace(/\.[^/.]+$/,`.${_}`)}`;x.value.push({url:R,filename:W})}),x.value.length>0&&setTimeout(()=>{const t=document.createElement("a");t.href=x.value[0].url,t.download=x.value[0].filename,document.body.appendChild(t),t.click(),document.body.removeChild(t)},1e3)}catch(s){d.value=`转换失败：${s.message||"未知错误"}`,y.value=j(d.value)}finally{F.value=!1}},S=()=>{g.value=[],o.value="",f.value={includeImages:!0,preserveFormatting:!0,handleLinks:!0},i.value={splitMode:"page",pagesPerFile:1,mergeOrder:"upload",customOrder:""},p.value={password:"",confirmPassword:"",encryptionLevel:"medium"},d.value="",y.value="",M.value=!1,V.value="",h.value=0,w.value="",x.value=[],k.value=[]};return(s,e)=>(n(),q(ee,{title:"办公文档格式转换",description:"支持doc/docx批量拆分合并加密、MD/HTML/TXT/Word互转",tips:$},{default:K(()=>[l("div",se,[X(le,{multiple:!0,accept:[".doc",".docx",".md",".html",".txt"],"max-size":100*1024*1024,modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=t=>g.value=t),onFilesChanged:H,onError:N},null,8,["modelValue"]),b.value.length>0?(n(),r("div",oe,[e[14]||(e[14]=l("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),l("div",ne,[(n(!0),r(L,null,B(b.value,(t,u)=>(n(),r("div",{key:u,class:"flex items-center justify-between p-2 bg-white rounded border"},[l("div",re,[e[12]||(e[12]=l("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),l("div",null,[l("div",ae,v(t.name),1),l("div",ue,v(z(t.name))+" • "+v(E(t.size)),1)])]),l("button",{onClick:_=>I(u),class:"text-red-500 hover:text-red-700"},[...e[13]||(e[13]=[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ie)]))),128))])])):c("",!0),b.value.length>0&&k.value.length>0?(n(),r("div",de,[e[15]||(e[15]=l("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),l("div",ve,[(n(!0),r(L,null,B(k.value,t=>(n(),r("label",{key:t.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[m(l("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=u=>o.value=u),value:t.value,class:"w-4 h-4 text-blue-600"},null,8,ce),[[J,o.value]]),l("div",null,[l("div",pe,v(t.label),1),l("div",me,v(t.description),1)])]))),128))])])):c("",!0),b.value.length>0?(n(),r("div",ge,[l("div",null,[e[19]||(e[19]=l("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),l("div",be,[l("label",fe,[m(l("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>f.value.includeImages=t),class:"w-4 h-4 text-blue-600"},null,512),[[O,f.value.includeImages]]),e[16]||(e[16]=l("span",null,"包含图片",-1))]),l("label",xe,[m(l("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=t=>f.value.preserveFormatting=t),class:"w-4 h-4 text-blue-600"},null,512),[[O,f.value.preserveFormatting]]),e[17]||(e[17]=l("span",null,"保留格式",-1))]),l("label",ye,[m(l("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=t=>f.value.handleLinks=t),class:"w-4 h-4 text-blue-600"},null,512),[[O,f.value.handleLinks]]),e[18]||(e[18]=l("span",null,"处理超链接",-1))])])]),o.value==="split"||o.value==="merge"?(n(),r("div",he,[e[26]||(e[26]=l("h3",{class:"text-lg font-semibold mb-3"},"文档拆分/合并选项",-1)),o.value==="split"?(n(),r("div",we,[e[22]||(e[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"拆分方式",-1)),m(l("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.splitMode=t),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[20]||(e[20]=[l("option",{value:"page"},"按页码拆分",-1),l("option",{value:"section"},"按章节拆分",-1),l("option",{value:"size"},"按文件大小拆分",-1)])],512),[[U,i.value.splitMode]]),i.value.splitMode==="page"?(n(),r("div",ke,[e[21]||(e[21]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"每页拆分",-1)),m(l("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>i.value.pagesPerFile=t),type:"number",min:"1",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[C,i.value.pagesPerFile,void 0,{number:!0}]])])):c("",!0)])):o.value==="merge"?(n(),r("div",Fe,[e[25]||(e[25]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"合并顺序",-1)),m(l("select",{"onUpdate:modelValue":e[7]||(e[7]=t=>i.value.mergeOrder=t),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[23]||(e[23]=[l("option",{value:"upload"},"按上传顺序",-1),l("option",{value:"name"},"按文件名排序",-1),l("option",{value:"custom"},"自定义顺序",-1)])],512),[[U,i.value.mergeOrder]]),i.value.mergeOrder==="custom"?(n(),r("div",Me,[e[24]||(e[24]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"自定义顺序（用逗号分隔）",-1)),m(l("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>i.value.customOrder=t),type:"text",placeholder:"例如：file1.docx,file2.docx",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[C,i.value.customOrder]])])):c("",!0)])):c("",!0)])):c("",!0),o.value==="encrypt"?(n(),r("div",Ce,[e[31]||(e[31]=l("h3",{class:"text-lg font-semibold mb-3"},"文档加密选项",-1)),l("div",Ve,[l("div",null,[e[27]||(e[27]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密密码",-1)),m(l("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>p.value.password=t),type:"password",placeholder:"请输入加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[C,p.value.password]])]),l("div",null,[e[28]||(e[28]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"确认密码",-1)),m(l("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>p.value.confirmPassword=t),type:"password",placeholder:"请确认加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[C,p.value.confirmPassword]])]),l("div",null,[e[30]||(e[30]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密级别",-1)),m(l("select",{"onUpdate:modelValue":e[11]||(e[11]=t=>p.value.encryptionLevel=t),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[29]||(e[29]=[l("option",{value:"low"},"低级别加密",-1),l("option",{value:"medium"},"中级别加密",-1),l("option",{value:"high"},"高级别加密",-1)])],512),[[U,p.value.encryptionLevel]])])])])):c("",!0)])):c("",!0),l("div",_e,[l("button",{onClick:D,disabled:!b.value.length||!o.value||F.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[F.value?(n(),r("span",Oe,[e[32]||(e[32]=l("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),Q(" 处理中... "+v(h.value)+"% ",1)])):(n(),r("span",Be,"开始转换"))],8,Le),l("button",{onClick:S,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),F.value?(n(),r("div",Ue,[l("div",Pe,[e[33]||(e[33]=l("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),l("span",ze,v(h.value)+"%",1)]),l("div",Te,[l("div",{class:"bg-blue-600 h-2.5 rounded-full",style:Y({width:h.value+"%"})},null,4)]),l("p",je,v(w.value),1)])):c("",!0),M.value?(n(),r("div",Se,[e[34]||(e[34]=l("div",{class:"flex items-center"},[l("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),l("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),l("p",$e,v(V.value),1),l("div",Ee,[(n(!0),r(L,null,B(x.value,(t,u)=>(n(),r("a",{key:u,href:t.url,download:t.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+v(u+1),9,Ie))),128))])])):c("",!0),d.value?(n(),r("div",He,[e[35]||(e[35]=l("div",{class:"flex items-center"},[l("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),l("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),l("p",Ne,v(d.value),1),y.value?(n(),r("p",Ae,"建议："+v(y.value),1)):c("",!0)])):c("",!0)])]),_:1}))}};export{Ze as default};
