import{N as S,u as J,_ as A,a as Q,b as Y}from"./CrK8G4f3.js";import{e as F,f as G,c as a,o as l,a as e,F as C,r as $,t as k,g as b,n as K,h as f,i as I,d as X,j as Z,k as q,b as T,l as ee,v as te,m as E}from"./BX7h51oD.js";import{_ as O}from"./DlAUqK2U.js";import"./BXTAbidz.js";const oe={id:"tool-entrance",class:"py-2"},se={class:"mx-auto px-2"},ne=["id"],ae={class:"text-base font-bold text-[#333] mb-2"},le={class:"flex flex-col gap-2 mb-2"},re=["id","onClick"],ie={class:"mr-2"},ce={class:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 whitespace-nowrap overflow-hidden text-ellipsis max-w-[60px]"},de={class:"flex items-center space-x-2 min-w-0"},ue={class:"text-sm font-normal text-[#333] whitespace-nowrap overflow-hidden text-ellipsis flex-shrink-0 group-hover:text-blue-500 group-hover:underline"},he={class:"text-xs text-[#999] whitespace-nowrap overflow-hidden text-ellipsis flex-1 group-hover:text-blue-500 group-hover:underline"},me={key:0,class:"mt-1 px-20"},ve=["onClick"],pe={__name:"ToolCards",setup(x){const s=f(""),d=r=>{r&&window.open(r,"_blank")},v=r=>{window.location.href=`/category?name=${encodeURIComponent(r)}`},p=r=>r?r.substring(0,2):"",c=()=>{const r=window.location.hash;r?s.value=r.substring(1):s.value=""},y=()=>{c(),s.value&&setTimeout(()=>{s.value=""},2e3)};return F(()=>{c(),window.addEventListener("hashchange",y)}),G(()=>{window.removeEventListener("hashchange",y)}),(r,g)=>(l(),a("section",oe,[e("div",se,[g[1]||(g[1]=e("h2",{class:"text-2xl font-bold text-text-primary mb-2"},"综合资源",-1)),(l(!0),a(C,null,$(Z(S),_=>(l(),a("div",{key:_.category,id:_.category.toLowerCase().replace(/\s+/g,"-"),class:"py-1 border-b border-blue-500"},[e("h3",ae,k(_.category),1),e("div",le,[(l(!0),a(C,null,$(_.resources.slice(0,5),h=>(l(),a("div",{key:h.id,id:h.id,onClick:L=>d(h.link),class:K(["group","rounded-lg","px-3","flex","items-center","cursor-pointer","transition-all","duration-300",s.value===h.id?"bg-yellow-50 border border-yellow-200 animate-pulse":""])},[e("div",ie,[e("span",ce,k(p(h.netdiskType)),1)]),e("div",de,[e("h4",ue,k(h.title),1),e("span",he,k(h.highlight),1)])],10,re))),128)),_.resources.length>5?(l(),a("div",me,[e("a",{href:"#",onClick:I(h=>v(_.category),["prevent"]),class:"text-sm text-blue-500 hover:underline flex items-center"},[...g[0]||(g[0]=[X(" 查看更多 ",-1),e("span",{class:"ml-1"},"→",-1)])],8,ve)])):b("",!0)])],8,ne))),128))])]))}},_e=O(pe,[["__scopeId","data-v-e842bb57"]]),fe=()=>{const x={};return S.forEach(s=>{s.resources.forEach(d=>{x[d.title]=d.id})}),x},R=fe();Object.keys(R).length;S.map(x=>({name:x.category,count:x.resources.length}));const xe={class:"min-h-screen bg-background"},ge={class:"flex pt-nav-height"},be={class:"flex-1 lg:ml-sidebar-left overflow-y-auto"},ye={class:"max-w-8xl mx-auto px-4 py-2"},we={class:"mb-8"},ke={class:"relative max-w-2xl mx-auto"},Ce={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-background border border-input rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto"},$e={key:0,class:"p-4"},Te={class:"space-y-1"},He=["onClick"],Ie={key:1},Se={key:0,class:"p-4 border-b border-input"},Le={class:"space-y-2"},Ne=["href","onClick"],Me={class:"text-sm font-medium"},ze=["innerHTML"],Ee={key:1,class:"p-4"},Fe={class:"space-y-2"},Oe=["href","onClick"],Re={class:"text-sm font-medium"},Be=["innerHTML"],Pe={key:2,class:"p-4 text-center text-muted-foreground"},Ve={__name:"index",setup(x){J({title:"Work资源工具站 - 免费办公模板与工具聚合平台",meta:[{name:"description",content:"Work资源工具站提供免费Office模板下载、格式转换工具等办公辅助服务，高效、无广告。包含Word模板、Excel表格、PPT演示文稿、PDF工具等资源，助力办公效率提升。"},{name:"keywords",content:"Work资源工具站, Office模板, Word模板, Excel模板, PPT模板, PDF工具, 格式转换, 办公工具, 免费模板"}]});const s=f(""),d=f(!1),v=f([]),p=f([]),c=f([]),y=f([]),r=f({}),g=E(()=>v.value.length>0||p.value.length>0),_=E(()=>c.value.length>0),h=()=>{const t=Object.entries(R).map(([o,i])=>{const u=`#${i}`;return{id:i,name:o,path:u}});y.value=t},L=(t,o)=>{let i;return(...u)=>{clearTimeout(i),i=setTimeout(()=>t.apply(null,u),o)}},N=()=>{const t=s.value.trim();if(!t){v.value=[],p.value=[];return}if(r.value[t]){const m=r.value[t];v.value=m.exact,p.value=m.fuzzy;return}const o=y.value,i=o.filter(m=>m.name.toLowerCase()===t.toLowerCase()),u=o.filter(m=>m.name.toLowerCase().includes(t.toLowerCase())&&!i.some(w=>w.id===m.id)).slice(0,5);v.value=i,p.value=u,r.value[t]={exact:i,fuzzy:u}},B=L(N,300);q(s,()=>{B(),d.value=!0});const M=(t,o)=>{if(!o)return t;const i=new RegExp(`(${o})`,"gi");return t.replace(i,'<span class="bg-yellow-200 text-yellow-800 px-1 rounded">$1</span>')},P=t=>{!t||c.value.includes(t)||(c.value.unshift(t),c.value.length>10&&(c.value=c.value.slice(0,10)),localStorage.setItem("searchHistory",JSON.stringify(c.value)))},z=(t,o)=>{P(o);const i=`#${t}`,u=document.querySelector(i);if(u){const w=u.getBoundingClientRect().top,n=window.pageYOffset+w-60;window.scrollTo({top:n,behavior:"smooth"})}d.value=!1},V=t=>{s.value=t,N(),d.value=!0},W=()=>{s.value="",v.value=[],p.value=[],d.value=!1},j=()=>{c.value=[],localStorage.removeItem("searchHistory")},D=()=>{setTimeout(()=>{d.value=!1},200)},U=()=>{const t=localStorage.getItem("searchHistory");if(t)try{c.value=JSON.parse(t)}catch(o){console.error("Failed to load search history:",o),c.value=[]}};return F(()=>{h(),U()}),(t,o)=>{const i=A,u=Q,m=_e,w=Y;return l(),a("div",xe,[T(i),e("div",ge,[T(u),e("main",be,[e("div",ye,[e("div",we,[e("div",ke,[ee(e("input",{"onUpdate:modelValue":o[0]||(o[0]=n=>s.value=n),type:"text",placeholder:"搜索站内链接标题...",class:"w-full px-4 py-3 pr-12 rounded-lg border border-input bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary",onFocus:o[1]||(o[1]=n=>d.value=!0),onBlur:D},null,544),[[te,s.value]]),e("button",{class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-primary",onClick:W}," × "),d.value&&(g.value||s.value||_.value)?(l(),a("div",Ce,[!s.value&&_.value?(l(),a("div",$e,[e("div",{class:"flex justify-between items-center mb-2"},[o[2]||(o[2]=e("h3",{class:"text-sm font-medium text-muted-foreground"},"搜索历史",-1)),e("button",{class:"text-xs text-muted-foreground hover:text-primary",onClick:j}," 清除 ")]),e("div",Te,[(l(!0),a(C,null,$(c.value,(n,H)=>(l(),a("button",{key:H,class:"w-full text-left px-3 py-2 text-sm hover:bg-muted rounded-md",onClick:We=>V(n)},k(n),9,He))),128))])])):s.value?(l(),a("div",Ie,[v.value.length>0?(l(),a("div",Se,[o[3]||(o[3]=e("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"精确匹配",-1)),e("div",Le,[(l(!0),a(C,null,$(v.value,n=>(l(),a("a",{key:n.id,href:n.path,class:"block px-3 py-2 rounded-md hover:bg-muted",onClick:I(H=>z(n.id,n.name),["prevent"])},[e("div",Me,[e("span",{innerHTML:M(n.name,s.value)},null,8,ze)])],8,Ne))),128))])])):b("",!0),p.value.length>0?(l(),a("div",Ee,[o[4]||(o[4]=e("h3",{class:"text-sm font-medium text-muted-foreground mb-2"},"模糊匹配",-1)),e("div",Fe,[(l(!0),a(C,null,$(p.value,n=>(l(),a("a",{key:n.id,href:n.path,class:"block px-3 py-2 rounded-md hover:bg-muted",onClick:I(H=>z(n.id,n.name),["prevent"])},[e("div",Re,[e("span",{innerHTML:M(n.name,s.value)},null,8,Be)])],8,Oe))),128))])])):b("",!0),g.value?b("",!0):(l(),a("div",Pe," 未找到匹配结果 "))])):b("",!0)])):b("",!0)])]),T(m),T(w)])])])])}}},Ae=O(Ve,[["__scopeId","data-v-67c2587a"]]);export{Ae as default};
