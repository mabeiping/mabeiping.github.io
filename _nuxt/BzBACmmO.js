import{j as N,w as O,o as n,a as e,b as W,c as r,F as j,p as P,t as a,l as i,q as m,y as k,s as _,d as D,B as T,r as d,x as I}from"./5KiIeb3O.js";import{_ as J}from"./D50zL9At.js";import{G as A}from"./9UHln5xC.js";import{s as K}from"./CkncbWtC.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";import"./DlAUqK2U.js";const Q={class:"space-y-6"},X={key:0,class:"bg-gray-50 p-4 rounded-lg"},Y={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},Z={class:"flex justify-center mb-3"},ee=["src"],te={class:"text-center"},oe={class:"font-medium truncate"},se={class:"text-sm text-gray-500"},le=["onClick"],ne={key:1,class:"space-y-4"},re={class:"bg-gray-50 p-4 rounded-lg"},ue={class:"space-y-3"},ae={key:0,class:"grid grid-cols-2 gap-2"},ie={key:1},de={key:0,class:"mt-2 flex items-center space-x-2"},pe={key:2},me={class:"bg-gray-50 p-4 rounded-lg"},ce={class:"space-y-3"},ve={key:0},ge={class:"text-right text-sm text-gray-500"},be={class:"flex space-x-4"},fe=["disabled"],xe={key:0},ye={key:1,class:"flex items-center justify-center"},he={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},we={class:"flex items-center justify-between mb-2"},ke={class:"text-blue-700"},_e={class:"w-full bg-gray-200 rounded-full h-2.5"},Ve={class:"mt-2 text-sm text-blue-700"},Ce={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ue={class:"mt-2 text-green-700"},Fe={class:"mt-3 space-y-2"},Be=["href","download"],je={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Pe={class:"mt-2 text-red-700"},Me={key:0,class:"mt-2 text-sm text-gray-600"},Oe={__name:"index",setup(ze){const l=d({mode:"custom",width:800,height:600,aspectRatio:"1:1",customWidth:1,customHeight:1,position:"center",preset:"1920x1080"}),u=d({format:"same",quality:90}),g=d([]),v=I(()=>g.value),h=d(!1),w=d(!1),V=d(""),c=d(""),x=d(""),y=d(0),b=d(""),f=d([]),M=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 选择裁剪模式：自定义尺寸、按比例裁剪、正方形或预设尺寸","3. 设置裁剪参数：根据选择的模式设置相应的参数","4. 选择裁剪位置：居中、四角等位置选项","5. 配置输出设置：选择输出格式和质量",'6. 点击"开始裁剪"按钮进行处理',"7. 等待处理完成，下载裁剪后的图片"],U=s=>s.split(".").pop().toLowerCase(),z=s=>{if(s===0)return"0 B";const t=1024,o=["B","KB","MB","GB"],p=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,p)).toFixed(2))+" "+o[p]},R=s=>{g.value.splice(s,1),g.value.length===0&&B()},L=s=>{g.value=s,c.value="",w.value=!1},S=s=>{c.value=s,x.value=F(s)},F=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",$=()=>new Promise(s=>{let t=0;const o=K(()=>{t+=Math.floor(Math.random()*10)+5,t>100&&(t=100),y.value=t,t<30?b.value="正在分析图片...":t<60?b.value="正在计算裁剪区域...":t<90?b.value="正在执行裁剪操作...":b.value="正在生成结果...",t===100&&(clearInterval(o),setTimeout(s,500))},500)}),q=async()=>{if(v.length===0){c.value="请选择文件";return}h.value=!0,c.value="",x.value="",w.value=!1,y.value=0,b.value="准备处理...",f.value=[];try{await $();let s={files:v.value,cropOptions:l.value,outputOptions:u.value};console.log("处理参数:",s),V.value=`成功裁剪 ${v.length} 个图片！`,w.value=!0,v.forEach((t,o)=>{const p=U(t.name),C=u.value.format==="same"?p:u.value.format,G=new Blob(["模拟裁剪后的图片内容"],{type:`image/${C}`}),H=URL.createObjectURL(G),E=`cropped_${t.name.replace(/\.[^/.]+$/,`.${C}`)}`;f.value.push({url:H,filename:E})}),f.value.length>0&&setTimeout(()=>{const t=document.createElement("a");t.href=f.value[0].url,t.download=f.value[0].filename,document.body.appendChild(t),t.click(),document.body.removeChild(t)},1e3)}catch(s){c.value=`处理失败：${s.message||"未知错误"}`,x.value=F(c.value)}finally{h.value=!1}},B=()=>{g.value=[],l.value={mode:"custom",width:800,height:600,aspectRatio:"1:1",customWidth:1,customHeight:1,position:"center",preset:"1920x1080"},u.value={format:"same",quality:90},c.value="",x.value="",w.value=!1,V.value="",y.value=0,b.value="",f.value=[]};return(s,t)=>(n(),N(J,{title:"图片裁剪处理",description:"裁剪图片尺寸，去除不需要的部分",tips:M},{default:O(()=>[e("div",Q,[W(A,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":100*1024*1024,modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o),onFilesChanged:L,onError:S},null,8,["modelValue"]),v.value.length>0?(n(),r("div",X,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),e("div",Y,[(n(!0),r(j,null,P(v.value,(o,p)=>(n(),r("div",{key:p,class:"bg-white rounded border p-3"},[e("div",Z,[e("img",{src:s.URL.createObjectURL(o),class:"max-h-32 object-contain",alt:"Preview"},null,8,ee)]),e("div",te,[e("div",oe,a(o.name),1),e("div",se,a(U(o.name))+" • "+a(z(o.size)),1)]),e("button",{onClick:C=>R(p),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,le)]))),128))])])):i("",!0),v.value.length>0?(n(),r("div",ne,[e("div",re,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold mb-3"},"裁剪设置",-1)),e("div",ue,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"裁剪模式",-1)),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.mode=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[12]||(t[12]=[e("option",{value:"custom"},"自定义尺寸",-1),e("option",{value:"aspect"},"按比例裁剪",-1),e("option",{value:"square"},"裁剪为正方形",-1),e("option",{value:"preset"},"预设尺寸",-1)])],512),[[k,l.value.mode]])]),l.value.mode==="custom"?(n(),r("div",ae,[m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.width=o),type:"number",placeholder:"宽度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,l.value.width,void 0,{number:!0}]]),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.height=o),type:"number",placeholder:"高度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,l.value.height,void 0,{number:!0}]])])):i("",!0),l.value.mode==="aspect"?(n(),r("div",ie,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"宽高比",-1)),m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.aspectRatio=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[14]||(t[14]=[e("option",{value:"1:1"},"1:1 (正方形)",-1),e("option",{value:"4:3"},"4:3 (标准)",-1),e("option",{value:"16:9"},"16:9 (宽屏)",-1),e("option",{value:"3:2"},"3:2 (照片)",-1),e("option",{value:"9:16"},"9:16 (竖屏)",-1),e("option",{value:"custom"},"自定义比例",-1)])],512),[[k,l.value.aspectRatio]]),l.value.aspectRatio==="custom"?(n(),r("div",de,[m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.customWidth=o),type:"number",placeholder:"宽",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,l.value.customWidth,void 0,{number:!0}]]),t[15]||(t[15]=e("span",null,":",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.customHeight=o),type:"number",placeholder:"高",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,l.value.customHeight,void 0,{number:!0}]])])):i("",!0)])):i("",!0),l.value.mode==="preset"?(n(),r("div",pe,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"预设尺寸",-1)),m(e("select",{"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.preset=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[17]||(t[17]=[e("option",{value:"1920x1080"},"1920x1080 (Full HD)",-1),e("option",{value:"1280x720"},"1280x720 (HD)",-1),e("option",{value:"800x600"},"800x600 (标准)",-1),e("option",{value:"600x600"},"600x600 (正方形)",-1),e("option",{value:"400x400"},"400x400 (小正方形)",-1),e("option",{value:"1080x1920"},"1080x1920 (竖屏)",-1)])],512),[[k,l.value.preset]])])):i("",!0),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"裁剪位置",-1)),m(e("select",{"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.position=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[19]||(t[19]=[e("option",{value:"center"},"居中",-1),e("option",{value:"top-left"},"左上角",-1),e("option",{value:"top-right"},"右上角",-1),e("option",{value:"bottom-left"},"左下角",-1),e("option",{value:"bottom-right"},"右下角",-1)])],512),[[k,l.value.position]])])])]),e("div",me,[t[25]||(t[25]=e("h3",{class:"text-lg font-semibold mb-3"},"输出设置",-1)),e("div",ce,[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),m(e("select",{"onUpdate:modelValue":t[9]||(t[9]=o=>u.value.format=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[22]||(t[22]=[e("option",{value:"same"},"保持原格式",-1),e("option",{value:"png"},"PNG",-1),e("option",{value:"jpg"},"JPG",-1),e("option",{value:"webp"},"WebP",-1)])],512),[[k,u.value.format]])]),u.value.format==="jpg"||u.value.format==="webp"?(n(),r("div",ve,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出质量",-1)),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>u.value.quality=o),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[_,u.value.quality,void 0,{number:!0}]]),e("div",ge,a(u.value.quality)+"%",1)])):i("",!0)])])])):i("",!0),e("div",be,[e("button",{onClick:q,disabled:!v.value.length||h.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[h.value?(n(),r("span",ye,[t[26]||(t[26]=e("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),D(" 处理中... "+a(y.value)+"% ",1)])):(n(),r("span",xe,"开始裁剪"))],8,fe),e("button",{onClick:B,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),h.value?(n(),r("div",he,[e("div",we,[t[27]||(t[27]=e("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),e("span",ke,a(y.value)+"%",1)]),e("div",_e,[e("div",{class:"bg-blue-600 h-2.5 rounded-full",style:T({width:y.value+"%"})},null,4)]),e("p",Ve,a(b.value),1)])):i("",!0),w.value?(n(),r("div",Ce,[t[28]||(t[28]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),e("p",Ue,a(V.value),1),e("div",Fe,[(n(!0),r(j,null,P(f.value,(o,p)=>(n(),r("a",{key:p,href:o.url,download:o.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载裁剪结果 "+a(p+1),9,Be))),128))])])):i("",!0),c.value?(n(),r("div",je,[t[29]||(t[29]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),e("p",Pe,a(c.value),1),x.value?(n(),r("p",Me,"建议："+a(x.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{Oe as default};
