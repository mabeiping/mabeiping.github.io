import{$ as e,w as l,m as a,p as t,q as o,n as s,F as u,u as r,x as n,D as i,z as d,J as c,K as m,v,L as p,k as g,l as b}from"./DwDdtX2U.js";import{_ as f}from"./BGYMMrNt.js";import{G as x}from"./DaJPXVd5.js";import{s as y}from"./Ta3x3s_8.js";import"./DFiMgQNB.js";import"./DwL8tNwU.js";import"./Dzf--W9j.js";import"./DiBmY6iY.js";const h={class:"space-y-6"},w={key:0,class:"bg-gray-50 p-4 rounded-lg"},k={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},j={class:"flex justify-center mb-3"},U=["src"],V={class:"text-center"},C={class:"font-medium truncate"},M={class:"text-sm text-gray-500"},B=["onClick"],R={key:1,class:"space-y-4"},L={class:"bg-gray-50 p-4 rounded-lg"},P={class:"space-y-3"},q={key:0,class:"grid grid-cols-2 gap-2"},z={key:1},H={key:0,class:"mt-2 flex items-center space-x-2"},$={key:2},G={class:"bg-gray-50 p-4 rounded-lg"},W={class:"space-y-3"},F={key:0},_={class:"text-right text-sm text-gray-500"},D={class:"flex space-x-4"},E=["disabled"],J={key:0},K={key:1,class:"flex items-center justify-center"},N={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},O={class:"flex items-center justify-between mb-2"},T={class:"text-blue-700"},A={class:"w-full bg-gray-200 rounded-full h-2.5"},I={class:"mt-2 text-sm text-blue-700"},Q={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},S={class:"mt-2 text-green-700"},X={class:"mt-3 space-y-2"},Y=["href","download"],Z={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ee={class:"mt-2 text-red-700"},le={key:0,class:"mt-2 text-sm text-gray-600"},ae={__name:"index",setup(ae){const te=g({mode:"custom",width:800,height:600,aspectRatio:"1:1",customWidth:1,customHeight:1,position:"center",preset:"1920x1080"}),oe=g({format:"same",quality:90}),se=g([]),ue=b(()=>se.value),re=g(!1),ne=g(!1),ie=g(""),de=g(""),ce=g(""),me=g(0),ve=g(""),pe=g([]),ge=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 选择裁剪模式：自定义尺寸、按比例裁剪、正方形或预设尺寸","3. 设置裁剪参数：根据选择的模式设置相应的参数","4. 选择裁剪位置：居中、四角等位置选项","5. 配置输出设置：选择输出格式和质量",'6. 点击"开始裁剪"按钮进行处理',"7. 等待处理完成，下载裁剪后的图片"],be=e=>e.split(".").pop().toLowerCase(),fe=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},xe=e=>{se.value=e,de.value="",ne.value=!1},ye=e=>{de.value=e,ce.value=he(e)},he=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",we=async()=>{if(0!==ue.length){re.value=!0,de.value="",ce.value="",ne.value=!1,me.value=0,ve.value="准备处理...",pe.value=[];try{await new Promise(e=>{let l=0;const a=y(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),me.value=l,ve.value=l<30?"正在分析图片...":l<60?"正在计算裁剪区域...":l<90?"正在执行裁剪操作...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});ue.value,te.value,oe.value;ie.value=`成功裁剪 ${ue.length} 个图片！`,ne.value=!0,ue.forEach((e,l)=>{const a=be(e.name),t="same"===oe.value.format?a:oe.value.format,o=new Blob(["模拟裁剪后的图片内容"],{type:`image/${t}`}),s=URL.createObjectURL(o),u=`cropped_${e.name.replace(/\.[^/.]+$/,`.${t}`)}`;pe.value.push({url:s,filename:u})}),pe.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=pe.value[0].url,e.download=pe.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){de.value=`处理失败：${e.message||"未知错误"}`,ce.value=he(de.value)}finally{re.value=!1}}else de.value="请选择文件"},ke=()=>{se.value=[],te.value={mode:"custom",width:800,height:600,aspectRatio:"1:1",customWidth:1,customHeight:1,position:"center",preset:"1920x1080"},oe.value={format:"same",quality:90},de.value="",ce.value="",ne.value=!1,ie.value="",me.value=0,ve.value="",pe.value=[]};return(g,b)=>(a(),e(f,{title:"图片裁剪处理",description:"裁剪图片尺寸，去除不需要的部分",tips:ge},{default:l(()=>[t("div",h,[o(x,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":104857600,modelValue:se.value,"onUpdate:modelValue":b[0]||(b[0]=e=>se.value=e),onFilesChanged:xe,onError:ye},null,8,["modelValue"]),ue.value.length>0?(a(),s("div",w,[b[11]||(b[11]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",k,[(a(!0),s(u,null,r(ue.value,(e,l)=>(a(),s("div",{key:l,class:"bg-white rounded border p-3"},[t("div",j,[t("img",{src:g.URL.createObjectURL(e),class:"max-h-32 object-contain",alt:"Preview"},null,8,U)]),t("div",V,[t("div",C,n(e.name),1),t("div",M,n(be(e.name))+" • "+n(fe(e.size)),1)]),t("button",{onClick:e=>(e=>{se.value.splice(e,1),0===se.value.length&&ke()})(l),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,B)]))),128))])])):i("",!0),ue.value.length>0?(a(),s("div",R,[t("div",L,[b[21]||(b[21]=t("h3",{class:"text-lg font-semibold mb-3"},"裁剪设置",-1)),t("div",P,[t("div",null,[b[13]||(b[13]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"裁剪模式",-1)),d(t("select",{"onUpdate:modelValue":b[1]||(b[1]=e=>te.value.mode=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[12]||(b[12]=[t("option",{value:"custom"},"自定义尺寸",-1),t("option",{value:"aspect"},"按比例裁剪",-1),t("option",{value:"square"},"裁剪为正方形",-1),t("option",{value:"preset"},"预设尺寸",-1)])],512),[[c,te.value.mode]])]),"custom"===te.value.mode?(a(),s("div",q,[d(t("input",{"onUpdate:modelValue":b[2]||(b[2]=e=>te.value.width=e),type:"number",placeholder:"宽度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,te.value.width,void 0,{number:!0}]]),d(t("input",{"onUpdate:modelValue":b[3]||(b[3]=e=>te.value.height=e),type:"number",placeholder:"高度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,te.value.height,void 0,{number:!0}]])])):i("",!0),"aspect"===te.value.mode?(a(),s("div",z,[b[16]||(b[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"宽高比",-1)),d(t("select",{"onUpdate:modelValue":b[4]||(b[4]=e=>te.value.aspectRatio=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[14]||(b[14]=[t("option",{value:"1:1"},"1:1 (正方形)",-1),t("option",{value:"4:3"},"4:3 (标准)",-1),t("option",{value:"16:9"},"16:9 (宽屏)",-1),t("option",{value:"3:2"},"3:2 (照片)",-1),t("option",{value:"9:16"},"9:16 (竖屏)",-1),t("option",{value:"custom"},"自定义比例",-1)])],512),[[c,te.value.aspectRatio]]),"custom"===te.value.aspectRatio?(a(),s("div",H,[d(t("input",{"onUpdate:modelValue":b[5]||(b[5]=e=>te.value.customWidth=e),type:"number",placeholder:"宽",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,te.value.customWidth,void 0,{number:!0}]]),b[15]||(b[15]=t("span",null,":",-1)),d(t("input",{"onUpdate:modelValue":b[6]||(b[6]=e=>te.value.customHeight=e),type:"number",placeholder:"高",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,te.value.customHeight,void 0,{number:!0}]])])):i("",!0)])):i("",!0),"preset"===te.value.mode?(a(),s("div",$,[b[18]||(b[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"预设尺寸",-1)),d(t("select",{"onUpdate:modelValue":b[7]||(b[7]=e=>te.value.preset=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[17]||(b[17]=[t("option",{value:"1920x1080"},"1920x1080 (Full HD)",-1),t("option",{value:"1280x720"},"1280x720 (HD)",-1),t("option",{value:"800x600"},"800x600 (标准)",-1),t("option",{value:"600x600"},"600x600 (正方形)",-1),t("option",{value:"400x400"},"400x400 (小正方形)",-1),t("option",{value:"1080x1920"},"1080x1920 (竖屏)",-1)])],512),[[c,te.value.preset]])])):i("",!0),t("div",null,[b[20]||(b[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"裁剪位置",-1)),d(t("select",{"onUpdate:modelValue":b[8]||(b[8]=e=>te.value.position=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[19]||(b[19]=[t("option",{value:"center"},"居中",-1),t("option",{value:"top-left"},"左上角",-1),t("option",{value:"top-right"},"右上角",-1),t("option",{value:"bottom-left"},"左下角",-1),t("option",{value:"bottom-right"},"右下角",-1)])],512),[[c,te.value.position]])])])]),t("div",G,[b[25]||(b[25]=t("h3",{class:"text-lg font-semibold mb-3"},"输出设置",-1)),t("div",W,[t("div",null,[b[23]||(b[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),d(t("select",{"onUpdate:modelValue":b[9]||(b[9]=e=>oe.value.format=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[22]||(b[22]=[t("option",{value:"same"},"保持原格式",-1),t("option",{value:"png"},"PNG",-1),t("option",{value:"jpg"},"JPG",-1),t("option",{value:"webp"},"WebP",-1)])],512),[[c,oe.value.format]])]),"jpg"===oe.value.format||"webp"===oe.value.format?(a(),s("div",F,[b[24]||(b[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出质量",-1)),d(t("input",{"onUpdate:modelValue":b[10]||(b[10]=e=>oe.value.quality=e),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[m,oe.value.quality,void 0,{number:!0}]]),t("div",_,n(oe.value.quality)+"%",1)])):i("",!0)])])])):i("",!0),t("div",D,[t("button",{onClick:we,disabled:!ue.value.length||re.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[re.value?(a(),s("span",K,[b[26]||(b[26]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),v(" 处理中... "+n(me.value)+"% ",1)])):(a(),s("span",J,"开始裁剪"))],8,E),t("button",{onClick:ke,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),re.value?(a(),s("div",N,[t("div",O,[b[27]||(b[27]=t("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),t("span",T,n(me.value)+"%",1)]),t("div",A,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:p({width:me.value+"%"})},null,4)]),t("p",I,n(ve.value),1)])):i("",!0),ne.value?(a(),s("div",Q,[b[28]||(b[28]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),t("p",S,n(ie.value),1),t("div",X,[(a(!0),s(u,null,r(pe.value,(e,l)=>(a(),s("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载裁剪结果 "+n(l+1),9,Y))),128))])])):i("",!0),de.value?(a(),s("div",Z,[b[29]||(b[29]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),t("p",ee,n(de.value),1),ce.value?(a(),s("p",le,"建议："+n(ce.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{ae as default};
