import{_ as e,w as l,m as a,p as t,q as o,n as s,x as n,D as u,z as r,J as d,a7 as c,k as i}from"./DFWWPSrV.js";import{_ as m}from"./C1jkWaCi.js";import{G as p}from"./BGFgIxDv.js";import{_ as b}from"./nEzmyvu1.js";import"./CdYbPlRr.js";import"./BM3HdAYC.js";import"./DUMejLMI.js";const v={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},g={class:"lg:col-span-3 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},y={key:0,class:"mt-4 p-4 bg-green-50 rounded-md"},x={class:"mt-2 space-y-2"},f={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},h={class:"space-y-4"},w={key:0,class:"mt-4 p-4 bg-blue-50 rounded-md"},k={class:"mt-2"},D={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},j={key:0,class:"mt-4 space-y-4"},U={key:0,class:"mt-4"},C={class:"w-full h-64 bg-gray-100 rounded-md flex items-center justify-center"},T=["src"],_={class:"mt-4 flex space-x-4"},R=b({__name:"index",setup(b){const R=i(null),$=i(null),E=e=>{R.value=e[0]},L=e=>{R.value=e,setTimeout(()=>{$.value={attendanceDays:22,absenceDays:3,overtimeHours:15}},1500)},M=()=>{const e=new Blob([JSON.stringify($.value,null,2)],{type:"application/json"}),l=URL.createObjectURL(e),a=document.createElement("a");a.href=l,a.download="attendance-result.json",a.click(),URL.revokeObjectURL(l)},S=i({startDate:"",endDate:"",calcType:"workingDays"}),V=i(null),z=()=>{S.value.startDate&&S.value.endDate?setTimeout(()=>{const e=new Date(S.value.startDate),l=new Date(S.value.endDate),a=Math.abs(l-e),t=Math.ceil(a/864e5);switch(S.value.calcType){case"workingDays":V.value=`工作日数量: ${Math.floor(.7*t)} 天`;break;case"holidays":V.value=`节假日数量: ${Math.ceil(.3*t)} 天`;break;case"countdown":V.value=`距离目标日期还有: ${t} 天`}},1e3):V.value="请选择开始和结束日期"},F=i(null),O=i(null),G=i({type:"line"}),H=i(null),I=e=>{F.value=e[0]},J=e=>{F.value=e,O.value=!0},N=()=>{O.value&&setTimeout(()=>{H.value=`https://neeko-copilot.bytedance.net/api/text2image?prompt=${encodeURIComponent("data visualization chart")}&size=800x600`},1500)},P=e=>{if(!H.value)return;const l=document.createElement("a");l.href=H.value,l.download=`chart.${e}`,l.click()};return(i,b)=>(a(),e(m,{title:"日历/考勤/数据统计",description:"支持Excel考勤表自动统计、日期批量计算、表格数据生成图表"},{default:l(()=>[t("div",v,[t("div",g,[b[7]||(b[7]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Excel考勤表自动统计",-1)),o(p,{accept:[".xls",".xlsx",".csv"],multiple:!1,onFilesSelected:E,onUploadComplete:L}),$.value?(a(),s("div",y,[b[6]||(b[6]=t("h4",{class:"font-medium text-green-800"},"统计结果",-1)),t("div",x,[t("p",null,"出勤天数: "+n($.value.attendanceDays),1),t("p",null,"缺勤天数: "+n($.value.absenceDays),1),t("p",null,"加班时长: "+n($.value.overtimeHours)+" 小时",1)]),t("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:M}," 下载统计结果 ")])):u("",!0)]),t("div",f,[b[13]||(b[13]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"日期批量计算",-1)),t("div",h,[t("div",null,[b[8]||(b[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"开始日期",-1)),r(t("input",{type:"date","onUpdate:modelValue":b[0]||(b[0]=e=>S.value.startDate=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[d,S.value.startDate]])]),t("div",null,[b[9]||(b[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"结束日期",-1)),r(t("input",{type:"date","onUpdate:modelValue":b[1]||(b[1]=e=>S.value.endDate=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[d,S.value.endDate]])]),t("div",null,[b[11]||(b[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"计算类型",-1)),r(t("select",{"onUpdate:modelValue":b[2]||(b[2]=e=>S.value.calcType=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[10]||(b[10]=[t("option",{value:"workingDays"},"工作日",-1),t("option",{value:"holidays"},"节假日",-1),t("option",{value:"countdown"},"倒计时",-1)])],512),[[c,S.value.calcType]])]),t("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:z}," 计算 ")]),V.value?(a(),s("div",w,[b[12]||(b[12]=t("h4",{class:"font-medium text-blue-800"},"计算结果",-1)),t("p",k,n(V.value),1)])):u("",!0)]),t("div",D,[b[17]||(b[17]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"表格数据生成图表",-1)),o(p,{accept:[".xls",".xlsx",".csv",".json"],multiple:!1,onFilesSelected:I,onUploadComplete:J}),O.value?(a(),s("div",j,[t("div",null,[b[15]||(b[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"图表类型",-1)),r(t("select",{"onUpdate:modelValue":b[3]||(b[3]=e=>G.value.type=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[14]||(b[14]=[t("option",{value:"line"},"折线图",-1),t("option",{value:"bar"},"柱状图",-1),t("option",{value:"pie"},"饼图",-1)])],512),[[c,G.value.type]])]),t("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:N}," 生成图表 "),H.value?(a(),s("div",U,[b[16]||(b[16]=t("h4",{class:"font-medium text-gray-900 mb-2"},"生成的图表",-1)),t("div",C,[t("img",{src:H.value,alt:"生成的图表",class:"max-w-full max-h-full"},null,8,T)]),t("div",_,[t("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:b[4]||(b[4]=e=>P("png"))}," 下载为PNG "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:b[5]||(b[5]=e=>P("pdf"))}," 下载为PDF ")])])):u("",!0)])):u("",!0)])])]),_:1}))}},[["__scopeId","data-v-2b7caab4"]]);export{R as default};
