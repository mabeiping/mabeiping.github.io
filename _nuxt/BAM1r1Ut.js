import{c as e,a as l,A as a,z as t,t as s,l as r,B as u,F as o,p as n,q as d,C as i,r as v,o as c,v as p}from"./CU9sc1yl.js";import{s as b}from"./Uj4zMvJp.js";import{_ as m}from"./BCo6x5W8.js";const g={class:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md"},x={key:0,class:"mb-4"},f={key:1,class:"mb-4"},y={key:2,class:"mt-6 p-4 bg-gray-50 rounded-lg"},h={class:"flex items-center justify-between"},w={class:"font-medium text-gray-800"},k={class:"text-sm text-gray-500"},D={key:3,class:"mt-6"},F={class:"w-full bg-gray-200 rounded-full h-2.5"},M={class:"text-center mt-2 text-gray-600"},P={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},B=["value"],C={class:"group"},j={class:"mt-3 p-4 border rounded-lg"},z={class:"space-y-3"},I={class:"flex items-center"},L={class:"flex items-center"},U={class:"flex items-center"},W=["disabled"],_={key:0,class:"mt-6"},T={class:"w-full bg-gray-200 rounded-full h-2.5"},V={class:"text-center mt-2 text-gray-600"},A={key:1,class:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg"},E={class:"text-green-600 mb-4"},S=["href"],$={key:2,class:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg"},q={class:"text-red-600"},G=m({__name:"index",setup(m){const G=v(null),K=v(null),N=v(!1),Z=v(!1),H=v(0),J=v("word"),O=v(!1),Q=v(0),R=v(null),X=v(null),Y=v({optimizeForWeb:!1,preserveLayout:!0,includeImages:!0}),ee=[{value:"word",label:"Word (.docx)"},{value:"excel",label:"Excel (.xlsx)"},{value:"ppt",label:"PowerPoint (.pptx)"},{value:"pdf",label:"PDF (.pdf)"}],le=e=>{e.preventDefault(),N.value=!0},ae=e=>{e.preventDefault(),N.value=!1},te=e=>{e.preventDefault(),N.value=!1;const l=e.dataTransfer.files;l.length>0&&re(l[0])},se=e=>{const l=e.target.files[0];l&&re(l)},re=e=>{X.value=null,e.name.toLowerCase().endsWith(".pdf")?e.size>52428800?X.value="文件大小不能超过 50MB":ue(e):X.value="仅支持 PDF 格式文件"},ue=e=>{Z.value=!0,H.value=0;const l=b(()=>{H.value+=5,H.value>=100&&(clearInterval(l),setTimeout(()=>{Z.value=!1,K.value=e},500))},200)},oe=()=>{K.value=null,G.value&&(G.value.value=""),X.value=null},ne=e=>{if(0===e)return"0 Bytes";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB"][l]},de=e=>{const l=ee.find(l=>l.value===e);return l?l.label:e},ie=async()=>{if(K.value){O.value=!0,Q.value=0,X.value=null;try{await new Promise(e=>{const l=b(()=>{Q.value+=5,Q.value>=100&&(clearInterval(l),setTimeout(e,500))},200)}),R.value={downloadUrl:"#",fileName:K.value.name.replace(/\.[^/.]+$/,"")+ve(J.value),fileSize:K.value.size}}catch(e){X.value="转换失败，请重试"}finally{O.value=!1}}else X.value="请选择要转换的文件"},ve=e=>({word:".docx",excel:".xlsx",ppt:".pptx",pdf:".pdf"}[e]||".pdf"),ce=()=>{K.value=null,G.value&&(G.value.value=""),N.value=!1,Z.value=!1,H.value=0,J.value="word",R.value=null,Q.value=0,X.value=null};return(v,b)=>(c(),e("div",g,[b[15]||(b[15]=l("h1",{class:"text-2xl font-bold mb-6 text-center"},"PDF格式转换",-1)),b[16]||(b[16]=l("div",{class:"mb-8"},[l("p",{class:"text-gray-600 mb-4"},"支持PDF与Word/Excel/PPT等格式互转，操作简单快捷")],-1)),l("form",{onSubmit:a(ie,["prevent"]),class:"space-y-6"},[l("div",{class:t(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-all duration-300",{"border-blue-500 bg-blue-50":N.value,"border-red-500 bg-red-50":X.value}]),onDragover:a(le,["prevent"]),onDragleave:a(ae,["prevent"]),onDrop:a(te,["prevent"])},[N.value?(c(),e("div",x,[...b[6]||(b[6]=[l("svg",{class:"w-16 h-16 mx-auto text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),l("p",{class:"mt-2 text-blue-600 font-medium"},"释放文件以上传",-1)])])):(c(),e("div",f,[...b[7]||(b[7]=[l("svg",{class:"w-16 h-16 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),l("p",{class:"mt-2 text-gray-600"},"拖拽 PDF 文件到此处或点击选择",-1),l("p",{class:"text-gray-400 text-sm mt-1"},"仅支持 PDF 格式文件，最大文件大小 50MB",-1)])])),l("input",{type:"file",ref_key:"fileInput",ref:G,class:"hidden",accept:".pdf",onChange:se},null,544),l("button",{type:"button",onClick:b[0]||(b[0]=e=>v.$refs.fileInput.click()),class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300"}," 选择 PDF 文件 "),K.value?(c(),e("div",y,[l("div",h,[l("div",null,[l("div",w,s(K.value.name),1),l("div",k,s(ne(K.value.size)),1)]),l("button",{type:"button",onClick:oe,class:"text-red-500 hover:text-red-700"},[...b[8]||(b[8]=[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])])):r("",!0),Z.value?(c(),e("div",D,[l("div",F,[l("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:u({width:H.value+"%"})},null,4)]),l("p",M,s(H.value)+"%",1)])):r("",!0)],34),l("div",null,[b[9]||(b[9]=l("label",{class:"block text-gray-700 font-medium mb-2"},"转换为",-1)),l("div",P,[(c(),e(o,null,n(ee,e=>l("label",{key:e.value,class:t(["flex items-center p-3 border rounded-lg cursor-pointer hover:border-blue-500 transition duration-200",{"border-blue-500 bg-blue-50":J.value===e.value}])},[d(l("input",{type:"radio",value:e.value,"onUpdate:modelValue":b[1]||(b[1]=e=>J.value=e),class:"mr-2"},null,8,B),[[p,J.value]]),l("span",null,s(e.label),1)],2)),64))])]),l("div",null,[l("details",C,[b[13]||(b[13]=l("summary",{class:"cursor-pointer list-none flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[l("span",{class:"font-medium"},"高级选项"),l("span",{class:"transition-transform duration-300 group-open:rotate-180"},"▼")],-1)),l("div",j,[l("div",z,[l("label",I,[d(l("input",{type:"checkbox","onUpdate:modelValue":b[2]||(b[2]=e=>Y.value.optimizeForWeb=e),class:"mr-2"},null,512),[[i,Y.value.optimizeForWeb]]),b[10]||(b[10]=l("span",null,"优化为web使用",-1))]),l("label",L,[d(l("input",{type:"checkbox","onUpdate:modelValue":b[3]||(b[3]=e=>Y.value.preserveLayout=e),class:"mr-2"},null,512),[[i,Y.value.preserveLayout]]),b[11]||(b[11]=l("span",null,"保持原始布局",-1))]),l("label",U,[d(l("input",{type:"checkbox","onUpdate:modelValue":b[4]||(b[4]=e=>Y.value.includeImages=e),class:"mr-2"},null,512),[[i,Y.value.includeImages]]),b[12]||(b[12]=l("span",null,"包含图片",-1))])])])])]),l("button",{type:"submit",disabled:!K.value||O.value,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},s(O.value?"转换中...":"开始转换"),9,W)],32),O.value?(c(),e("div",_,[l("div",T,[l("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:u({width:Q.value+"%"})},null,4)]),l("p",V,s(Q.value)+"%",1)])):r("",!0),R.value?(c(),e("div",A,[b[14]||(b[14]=l("h3",{class:"font-semibold text-green-700 mb-2"},"转换成功",-1)),l("p",E,"文件已成功转换为 "+s(de(J.value))+" 格式",1),l("a",{href:R.value.downloadUrl,class:"inline-block bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300",download:""}," 下载文件 ",8,S),l("button",{onClick:ce,class:"ml-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-lg transition duration-300"}," 再次转换 ")])):r("",!0),X.value?(c(),e("div",$,[l("p",q,s(X.value),1),l("button",{onClick:b[5]||(b[5]=e=>X.value=null),class:"mt-2 text-red-600 hover:text-red-800 text-sm"}," 关闭 ")])):r("",!0)]))}},[["__scopeId","data-v-2abd437e"]]);export{G as default};
