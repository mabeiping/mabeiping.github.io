import{i as R,w as W,o,a as t,b as X,c as a,F as M,r as V,t as u,f as v,j as p,v as H,y as C,p as j,k as J,d as K,x as Q,l as r,m as Y}from"./-R7zUpUx.js";import{_ as Z}from"./1SagYtif.js";import{G as ee}from"./zseaTYbb.js";import{s as te}from"./CI8PMl9t.js";import"./C_FLJhYl.js";import"./Cu7bTl1K.js";import"./DlAUqK2U.js";const le={class:"space-y-6"},se={key:0,class:"bg-gray-50 p-4 rounded-lg"},oe={class:"space-y-2"},ae={class:"flex items-center"},ne={class:"font-medium"},re={class:"text-sm text-gray-500"},ie=["onClick"],ue={key:1,class:"bg-gray-50 p-4 rounded-lg"},de={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},ve=["value"],pe={class:"font-medium"},ce={class:"text-sm text-gray-500"},me={key:2,class:"space-y-4"},ge={class:"space-y-2"},be={class:"flex items-center space-x-2"},fe={class:"flex items-center space-x-2"},xe={class:"flex items-center space-x-2"},ye={key:0,class:"bg-white p-4 rounded-lg border"},he={class:"space-y-2"},we={class:"flex items-center space-x-2"},ke={key:1,class:"bg-white p-4 rounded-lg border"},Fe={class:"space-y-2"},_e={class:"text-right text-sm text-gray-500"},Ce={key:0},De={class:"flex items-center space-x-2"},Me={class:"flex space-x-4"},Ve=["disabled"],je={key:0},Pe={key:1,class:"flex items-center justify-center"},Se={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Be={class:"flex items-center justify-between mb-2"},Oe={class:"text-blue-700"},Ue={class:"w-full bg-gray-200 rounded-full h-2.5"},ze={class:"mt-2 text-sm text-blue-700"},Le={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ae={class:"mt-2 text-green-700"},Ee={class:"mt-3 space-y-2"},Ge=["href","download"],$e={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ie={class:"mt-2 text-red-700"},Te={key:0,class:"mt-2 text-sm text-gray-600"},Qe={__name:"index",setup(qe){const P=[{value:"dwg",label:"DWG (.dwg)",description:"AutoCAD图纸格式",extensions:[".dwg"]},{value:"dxf",label:"DXF (.dxf)",description:"Drawing Exchange Format",extensions:[".dxf"]},{value:"pdf",label:"PDF (.pdf)",description:"便携式文档格式",extensions:[".pdf"]},{value:"png",label:"PNG (.png)",description:"便携式网络图形",extensions:[".png"]},{value:"jpg",label:"JPG (.jpg)",description:"JPEG图片格式",extensions:[".jpg",".jpeg"]}],n=r(""),b=r({includeLayers:!0,preserveScale:!0,includeMetadata:!1}),f=r({pageSize:"a4",pageOrientation:"landscape",vectorOutput:!0}),c=r({resolution:300,quality:80,antialiasing:!0}),m=r([]),g=Y(()=>m.value),F=r(!1),_=r(!1),D=r(""),d=r(""),y=r(""),h=r(0),w=r(""),x=r([]),k=r([]),L=["1. 上传文件：支持DWG、DXF、PDF和图片格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含图层、保留比例、包含元数据等",'5. 点击"开始转换"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保图纸格式正确"],S=s=>s.split(".").pop().toLowerCase(),A=s=>{if(s===0)return"0 B";const e=1024,l=["B","KB","MB","GB"],i=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,i)).toFixed(2))+" "+l[i]},E=s=>{m.value.splice(s,1),m.value.length===0?U():B()},G=s=>{m.value=s,s.length>0?B():(k.value=[],n.value=""),d.value="",_.value=!1},B=()=>{if(m.value.length===0){k.value=[];return}const s=S(m.value[0].name),e=[];P.forEach(l=>{l.extensions.some(i=>s===i.replace(".",""))||e.push(l)}),k.value=e,e.length>0?n.value=e[0].value:n.value=""},$=s=>{d.value=s,y.value=O(s)},O=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",I=()=>new Promise(s=>{let e=0;const l=te(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),h.value=e,e<30?w.value="正在分析CAD文件...":e<70?w.value="正在转换格式...":w.value="正在生成结果...",e===100&&(clearInterval(l),setTimeout(s,500))},500)}),T=async()=>{if(g.length===0){d.value="请选择文件";return}if(!n.value){d.value="请选择目标格式";return}F.value=!0,d.value="",y.value="",_.value=!1,h.value=0,w.value="准备转换...",x.value=[];try{await I();let s={files:g.value,targetFormat:n.value,options:b.value};n.value==="pdf"?s.pdfOptions=f.value:["png","jpg"].includes(n.value)&&(s.imageOptions=c.value),console.log("转换参数:",s);const e=P.find(l=>l.value===n.value);D.value=`成功将 ${g.length} 个文件转换为 ${e.label} 格式！`,_.value=!0,g.forEach((l,i)=>{const z=new Blob(["模拟转换后的CAD文件内容"],{type:"application/octet-stream"}),q=URL.createObjectURL(z),N=`converted_${l.name.replace(/\.[^/.]+$/,`.${n.value}`)}`;x.value.push({url:q,filename:N})}),x.value.length>0&&setTimeout(()=>{const l=document.createElement("a");l.href=x.value[0].url,l.download=x.value[0].filename,document.body.appendChild(l),l.click(),document.body.removeChild(l)},1e3)}catch(s){d.value=`转换失败：${s.message||"未知错误"}`,y.value=O(d.value)}finally{F.value=!1}},U=()=>{m.value=[],n.value="",b.value={includeLayers:!0,preserveScale:!0,includeMetadata:!1},f.value={pageSize:"a4",pageOrientation:"landscape",vectorOutput:!0},c.value={resolution:300,quality:80,antialiasing:!0},d.value="",y.value="",_.value=!1,D.value="",h.value=0,w.value="",x.value=[],k.value=[]};return(s,e)=>(o(),R(Z,{title:"CAD图纸转换",description:"DWG/DXF与PDF/图片等格式互转",tips:L},{default:W(()=>[t("div",le,[X(ee,{multiple:!0,accept:[".dwg",".dxf",".pdf",".png",".jpg",".jpeg"],"max-size":200*1024*1024,modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),onFilesChanged:G,onError:$},null,8,["modelValue"]),g.value.length>0?(o(),a("div",se,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",oe,[(o(!0),a(M,null,V(g.value,(l,i)=>(o(),a("div",{key:i,class:"flex items-center justify-between p-2 bg-white rounded border"},[t("div",ae,[e[11]||(e[11]=t("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),t("div",null,[t("div",ne,u(l.name),1),t("div",re,u(S(l.name))+" • "+u(A(l.size)),1)])]),t("button",{onClick:z=>E(i),class:"text-red-500 hover:text-red-700"},[...e[12]||(e[12]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ie)]))),128))])])):v("",!0),g.value.length>0&&k.value.length>0?(o(),a("div",ue,[e[14]||(e[14]=t("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),t("div",de,[(o(!0),a(M,null,V(k.value,l=>(o(),a("label",{key:l.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[p(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=i=>n.value=i),value:l.value,class:"w-4 h-4 text-blue-600"},null,8,ve),[[H,n.value]]),t("div",null,[t("div",pe,u(l.label),1),t("div",ce,u(l.description),1)])]))),128))])])):v("",!0),g.value.length>0?(o(),a("div",me,[t("div",null,[e[18]||(e[18]=t("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),t("div",ge,[t("label",be,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=l=>b.value.includeLayers=l),class:"w-4 h-4 text-blue-600"},null,512),[[C,b.value.includeLayers]]),e[15]||(e[15]=t("span",null,"包含图层",-1))]),t("label",fe,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=l=>b.value.preserveScale=l),class:"w-4 h-4 text-blue-600"},null,512),[[C,b.value.preserveScale]]),e[16]||(e[16]=t("span",null,"保留比例",-1))]),t("label",xe,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=l=>b.value.includeMetadata=l),class:"w-4 h-4 text-blue-600"},null,512),[[C,b.value.includeMetadata]]),e[17]||(e[17]=t("span",null,"包含元数据",-1))])])]),n.value==="pdf"?(o(),a("div",ye,[e[24]||(e[24]=t("h3",{class:"text-lg font-semibold mb-3"},"PDF转换选项",-1)),t("div",he,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"页面大小",-1)),p(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>f.value.pageSize=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[19]||(e[19]=[t("option",{value:"a4"},"A4",-1),t("option",{value:"a3"},"A3",-1),t("option",{value:"letter"},"Letter",-1),t("option",{value:"custom"},"自定义",-1)])],512),[[j,f.value.pageSize]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"页面方向",-1)),p(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>f.value.pageOrientation=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[21]||(e[21]=[t("option",{value:"portrait"},"纵向",-1),t("option",{value:"landscape"},"横向",-1)])],512),[[j,f.value.pageOrientation]])]),t("div",null,[t("label",we,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=l=>f.value.vectorOutput=l),class:"w-4 h-4 text-blue-600"},null,512),[[C,f.value.vectorOutput]]),e[23]||(e[23]=t("span",null,"矢量输出",-1))])])])])):v("",!0),["png","jpg"].includes(n.value)?(o(),a("div",ke,[e[29]||(e[29]=t("h3",{class:"text-lg font-semibold mb-3"},"图片转换选项",-1)),t("div",Fe,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"分辨率",-1)),p(t("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>c.value.resolution=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[25]||(e[25]=[t("option",{value:"72"},"72 DPI",-1),t("option",{value:"150"},"150 DPI",-1),t("option",{value:"300"},"300 DPI",-1),t("option",{value:"600"},"600 DPI",-1)])],512),[[j,c.value.resolution]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"图片质量",-1)),p(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>c.value.quality=l),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[J,c.value.quality,void 0,{number:!0}]]),t("div",_e,u(c.value.quality)+"%",1)]),n.value==="jpg"?(o(),a("div",Ce,[t("label",De,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=l=>c.value.antialiasing=l),class:"w-4 h-4 text-blue-600"},null,512),[[C,c.value.antialiasing]]),e[28]||(e[28]=t("span",null,"抗锯齿",-1))])])):v("",!0)])])):v("",!0)])):v("",!0),t("div",Me,[t("button",{onClick:T,disabled:!g.value.length||!n.value||F.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[F.value?(o(),a("span",Pe,[e[30]||(e[30]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),K(" 处理中... "+u(h.value)+"% ",1)])):(o(),a("span",je,"开始转换"))],8,Ve),t("button",{onClick:U,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),F.value?(o(),a("div",Se,[t("div",Be,[e[31]||(e[31]=t("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),t("span",Oe,u(h.value)+"%",1)]),t("div",Ue,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:Q({width:h.value+"%"})},null,4)]),t("p",ze,u(w.value),1)])):v("",!0),_.value?(o(),a("div",Le,[e[32]||(e[32]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),t("p",Ae,u(D.value),1),t("div",Ee,[(o(!0),a(M,null,V(x.value,(l,i)=>(o(),a("a",{key:i,href:l.url,download:l.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+u(i+1),9,Ge))),128))])])):v("",!0),d.value?(o(),a("div",$e,[e[33]||(e[33]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),t("p",Ie,u(d.value),1),y.value?(o(),a("p",Te,"建议："+u(y.value),1)):v("",!0)])):v("",!0)])]),_:1}))}};export{Qe as default};
