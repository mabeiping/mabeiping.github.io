import{i as R,w as K,o,a as l,b as q,c as n,F as V,r as L,t as u,f as m,j as v,v as J,y as h,p as H,d as Q,x as W,l as r,m as X}from"./-R7zUpUx.js";import{_ as Y}from"./1SagYtif.js";import{G as Z}from"./zseaTYbb.js";import{s as ee}from"./CI8PMl9t.js";import"./C_FLJhYl.js";import"./Cu7bTl1K.js";import"./DlAUqK2U.js";const le={class:"space-y-6"},te={key:0,class:"bg-gray-50 p-4 rounded-lg"},se={class:"space-y-2"},oe={class:"flex items-center"},ne={class:"font-medium"},ae={class:"text-sm text-gray-500"},re=["onClick"],ie={key:1,class:"bg-gray-50 p-4 rounded-lg"},ue={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},de=["value"],ve={class:"font-medium"},ce={class:"text-sm text-gray-500"},pe={key:2,class:"space-y-4"},me={class:"space-y-2"},ge={class:"flex items-center space-x-2"},be={class:"flex items-center space-x-2"},fe={class:"flex items-center space-x-2"},xe={key:0,class:"bg-white p-4 rounded-lg border"},he={class:"space-y-2"},ye={class:"flex items-center space-x-2"},ke={key:1,class:"bg-white p-4 rounded-lg border"},we={class:"space-y-2"},Ce={class:"flex items-center space-x-2"},_e={class:"flex items-center space-x-2"},Fe={class:"flex items-center space-x-2"},Me={class:"flex space-x-4"},Ve=["disabled"],Le={key:0},Se={key:1,class:"flex items-center justify-center"},Be={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Oe={class:"flex items-center justify-between mb-2"},ze={class:"text-blue-700"},Ue={class:"w-full bg-gray-200 rounded-full h-2.5"},Te={class:"mt-2 text-sm text-blue-700"},He={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},De={class:"mt-2 text-green-700"},Ee={class:"mt-3 space-y-2"},je=["href","download"],Pe={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ae={class:"mt-2 text-red-700"},$e={key:0,class:"mt-2 text-sm text-gray-600"},We={__name:"index",setup(Ie){const S=[{value:"eml",label:"EML (.eml)",description:"电子邮件格式",extensions:[".eml"]},{value:"msg",label:"MSG (.msg)",description:"Outlook邮件格式",extensions:[".msg"]},{value:"pdf",label:"PDF (.pdf)",description:"便携式文档格式",extensions:[".pdf"]},{value:"html",label:"HTML (.html)",description:"网页格式",extensions:[".html"]},{value:"txt",label:"文本 (.txt)",description:"纯文本格式",extensions:[".txt"]}],a=r(""),g=r({includeAttachments:!0,preserveFormatting:!0,includeHeaders:!1}),b=r({pageSize:"a4",pageOrientation:"portrait",includeTableOfContents:!1}),f=r({inlineCss:!0,responsiveDesign:!0,embedImages:!0}),c=r([]),p=X(()=>c.value),_=r(!1),F=r(!1),M=r(""),d=r(""),y=r(""),k=r(0),w=r(""),x=r([]),C=r([]),D=["1. 上传文件：支持EML、MSG、PDF、HTML和文本格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含附件、保留格式、包含邮件头等",'5. 点击"开始转换"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保内容和格式的准确性"],B=s=>s.split(".").pop().toLowerCase(),E=s=>{if(s===0)return"0 B";const e=1024,t=["B","KB","MB","GB"],i=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,i)).toFixed(2))+" "+t[i]},j=s=>{c.value.splice(s,1),c.value.length===0?U():O()},P=s=>{c.value=s,s.length>0?O():(C.value=[],a.value=""),d.value="",F.value=!1},O=()=>{if(c.value.length===0){C.value=[];return}const s=B(c.value[0].name),e=[];S.forEach(t=>{t.extensions.some(i=>s===i.replace(".",""))||e.push(t)}),C.value=e,e.length>0?a.value=e[0].value:a.value=""},A=s=>{d.value=s,y.value=z(s)},z=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",$=()=>new Promise(s=>{let e=0;const t=ee(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),k.value=e,e<30?w.value="正在分析邮件文件...":e<70?w.value="正在转换格式...":w.value="正在生成结果...",e===100&&(clearInterval(t),setTimeout(s,500))},500)}),I=async()=>{if(p.length===0){d.value="请选择文件";return}if(!a.value){d.value="请选择目标格式";return}_.value=!0,d.value="",y.value="",F.value=!1,k.value=0,w.value="准备转换...",x.value=[];try{await $();let s={files:p.value,targetFormat:a.value,options:g.value};a.value==="pdf"?s.pdfOptions=b.value:a.value==="html"&&(s.htmlOptions=f.value),console.log("转换参数:",s);const e=S.find(t=>t.value===a.value);M.value=`成功将 ${p.length} 个文件转换为 ${e.label} 格式！`,F.value=!0,p.forEach((t,i)=>{const T=new Blob(["模拟转换后的邮件内容"],{type:"application/octet-stream"}),G=URL.createObjectURL(T),N=`converted_${t.name.replace(/\.[^/.]+$/,`.${a.value}`)}`;x.value.push({url:G,filename:N})}),x.value.length>0&&setTimeout(()=>{const t=document.createElement("a");t.href=x.value[0].url,t.download=x.value[0].filename,document.body.appendChild(t),t.click(),document.body.removeChild(t)},1e3)}catch(s){d.value=`转换失败：${s.message||"未知错误"}`,y.value=z(d.value)}finally{_.value=!1}},U=()=>{c.value=[],a.value="",g.value={includeAttachments:!0,preserveFormatting:!0,includeHeaders:!1},b.value={pageSize:"a4",pageOrientation:"portrait",includeTableOfContents:!1},f.value={inlineCss:!0,responsiveDesign:!0,embedImages:!0},d.value="",y.value="",F.value=!1,M.value="",k.value=0,w.value="",x.value=[],C.value=[]};return(s,e)=>(o(),R(Y,{title:"邮件格式转换",description:"EML/MSG与PDF/HTML等格式互转",tips:D},{default:K(()=>[l("div",le,[q(Z,{multiple:!0,accept:[".eml",".msg",".pdf",".html",".txt"],"max-size":100*1024*1024,modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),onFilesChanged:P,onError:A},null,8,["modelValue"]),p.value.length>0?(o(),n("div",te,[e[13]||(e[13]=l("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),l("div",se,[(o(!0),n(V,null,L(p.value,(t,i)=>(o(),n("div",{key:i,class:"flex items-center justify-between p-2 bg-white rounded border"},[l("div",oe,[e[11]||(e[11]=l("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),l("div",null,[l("div",ne,u(t.name),1),l("div",ae,u(B(t.name))+" • "+u(E(t.size)),1)])]),l("button",{onClick:T=>j(i),class:"text-red-500 hover:text-red-700"},[...e[12]||(e[12]=[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,re)]))),128))])])):m("",!0),p.value.length>0&&C.value.length>0?(o(),n("div",ie,[e[14]||(e[14]=l("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),l("div",ue,[(o(!0),n(V,null,L(C.value,t=>(o(),n("label",{key:t.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[v(l("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=i=>a.value=i),value:t.value,class:"w-4 h-4 text-blue-600"},null,8,de),[[J,a.value]]),l("div",null,[l("div",ve,u(t.label),1),l("div",ce,u(t.description),1)])]))),128))])])):m("",!0),p.value.length>0?(o(),n("div",pe,[l("div",null,[e[18]||(e[18]=l("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),l("div",me,[l("label",ge,[v(l("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>g.value.includeAttachments=t),class:"w-4 h-4 text-blue-600"},null,512),[[h,g.value.includeAttachments]]),e[15]||(e[15]=l("span",null,"包含附件",-1))]),l("label",be,[v(l("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=t=>g.value.preserveFormatting=t),class:"w-4 h-4 text-blue-600"},null,512),[[h,g.value.preserveFormatting]]),e[16]||(e[16]=l("span",null,"保留格式",-1))]),l("label",fe,[v(l("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=t=>g.value.includeHeaders=t),class:"w-4 h-4 text-blue-600"},null,512),[[h,g.value.includeHeaders]]),e[17]||(e[17]=l("span",null,"包含邮件头",-1))])])]),a.value==="pdf"?(o(),n("div",xe,[e[24]||(e[24]=l("h3",{class:"text-lg font-semibold mb-3"},"PDF转换选项",-1)),l("div",he,[l("div",null,[e[20]||(e[20]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"页面大小",-1)),v(l("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>b.value.pageSize=t),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[19]||(e[19]=[l("option",{value:"a4"},"A4",-1),l("option",{value:"letter"},"Letter",-1),l("option",{value:"legal"},"Legal",-1)])],512),[[H,b.value.pageSize]])]),l("div",null,[e[22]||(e[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"页面方向",-1)),v(l("select",{"onUpdate:modelValue":e[6]||(e[6]=t=>b.value.pageOrientation=t),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[21]||(e[21]=[l("option",{value:"portrait"},"纵向",-1),l("option",{value:"landscape"},"横向",-1)])],512),[[H,b.value.pageOrientation]])]),l("div",null,[l("label",ye,[v(l("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>b.value.includeTableOfContents=t),class:"w-4 h-4 text-blue-600"},null,512),[[h,b.value.includeTableOfContents]]),e[23]||(e[23]=l("span",null,"包含目录",-1))])])])])):m("",!0),a.value==="html"?(o(),n("div",ke,[e[28]||(e[28]=l("h3",{class:"text-lg font-semibold mb-3"},"HTML转换选项",-1)),l("div",we,[l("div",null,[l("label",Ce,[v(l("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>f.value.inlineCss=t),class:"w-4 h-4 text-blue-600"},null,512),[[h,f.value.inlineCss]]),e[25]||(e[25]=l("span",null,"内联CSS样式",-1))])]),l("div",null,[l("label",_e,[v(l("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=t=>f.value.responsiveDesign=t),class:"w-4 h-4 text-blue-600"},null,512),[[h,f.value.responsiveDesign]]),e[26]||(e[26]=l("span",null,"响应式设计",-1))])]),l("div",null,[l("label",Fe,[v(l("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=t=>f.value.embedImages=t),class:"w-4 h-4 text-blue-600"},null,512),[[h,f.value.embedImages]]),e[27]||(e[27]=l("span",null,"嵌入图片",-1))])])])])):m("",!0)])):m("",!0),l("div",Me,[l("button",{onClick:I,disabled:!p.value.length||!a.value||_.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[_.value?(o(),n("span",Se,[e[29]||(e[29]=l("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),Q(" 处理中... "+u(k.value)+"% ",1)])):(o(),n("span",Le,"开始转换"))],8,Ve),l("button",{onClick:U,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),_.value?(o(),n("div",Be,[l("div",Oe,[e[30]||(e[30]=l("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),l("span",ze,u(k.value)+"%",1)]),l("div",Ue,[l("div",{class:"bg-blue-600 h-2.5 rounded-full",style:W({width:k.value+"%"})},null,4)]),l("p",Te,u(w.value),1)])):m("",!0),F.value?(o(),n("div",He,[e[31]||(e[31]=l("div",{class:"flex items-center"},[l("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),l("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),l("p",De,u(M.value),1),l("div",Ee,[(o(!0),n(V,null,L(x.value,(t,i)=>(o(),n("a",{key:i,href:t.url,download:t.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+u(i+1),9,je))),128))])])):m("",!0),d.value?(o(),n("div",Pe,[e[32]||(e[32]=l("div",{class:"flex items-center"},[l("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),l("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),l("p",Ae,u(d.value),1),y.value?(o(),n("p",$e,"建议："+u(y.value),1)):m("",!0)])):m("",!0)])]),_:1}))}};export{We as default};
