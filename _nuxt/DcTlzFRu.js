import{h as W,w as T,o as i,a as t,c as m,i as w,j as v,y as E,d as V,t as u,k as a,q as d,v as F,m as N,F as h,r as k,p as H}from"./SaazSTpp.js";import{_}from"./C6HMMAnQ.js";import"./SMMEOewN.js";import"./BtRl-Aal.js";const O={class:"space-y-6"},q={class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors"},A={key:0,class:"space-y-4"},G={class:"p-4 bg-gray-50 rounded-lg"},K={class:"text-sm text-text-primary"},$={class:"text-sm text-text-secondary"},J={class:"space-y-4"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q={class:"space-y-3"},X={class:"flex items-center gap-2"},Y={class:"flex items-center gap-2"},Z={class:"flex items-center gap-2"},ee={class:"space-y-3"},te={class:"flex items-center gap-2"},se={class:"flex items-center gap-2"},oe={class:"flex items-center gap-2"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},re={class:"space-y-3"},ae={class:"flex items-center gap-2"},ne={class:"flex items-center gap-2"},de={class:"flex items-center gap-2"},ie={class:"space-y-3"},ue={class:"flex items-center gap-2"},pe={class:"flex items-center gap-2"},me=["disabled"],ce={key:1,class:"space-y-4"},xe={class:"p-4 bg-green-50 rounded-lg"},ve={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},ye={class:"text-2xl font-bold text-primary"},ge={class:"text-2xl font-bold text-primary"},fe={class:"text-2xl font-bold text-green-500"},be={class:"text-2xl font-bold text-green-500"},we={class:"bg-gray-50 rounded-lg p-4 max-h-[400px] overflow-y-auto"},he={class:"w-full text-sm"},ke={class:"border-b border-gray-200"},Ue={__name:"data-cleaning-tool",setup(Ce){const C=v(null),c=v(null),y=v(!1),r=v(null),g=v(""),R=v("success"),o=v({removeEmptyRows:!0,removeEmptyColumns:!0,fillEmptyWith:!1,fillValue:"",trimWhitespace:!0,removeDuplicates:!0,standardizeCase:!1,caseType:"lower",removeSpecialChars:!1,standardizeDates:!1,standardizeNumbers:!1,removeHeaderRow:!1,addRowIndex:!1}),z=()=>{C.value.click()},U=l=>{const e=l.target.files[0];e&&(c.value=e)},D=l=>{const e=l.dataTransfer.files[0];e&&(c.value=e)},j=()=>{c.value=null,r.value=null},M=()=>{if(!c.value){f("请先选择文件","error");return}y.value=!0,setTimeout(()=>{const l=S();r.value=l,y.value=!1,f("数据清洗完成","success")},1500)},S=()=>{const l=["ID","姓名","邮箱","电话","地址","日期"],e=[["1","张三","zhangsan@example.com","13800138000","北京市朝阳区","2024-01-01"],["2","李四","lisi@example.com","13800138001","上海市浦东新区","2024-01-02"],["3","王五","wangwu@example.com","13800138002","广州市天河区","2024-01-03"],["4","赵六","zhaoliu@example.com","13800138003","深圳市南山区","2024-01-04"],["5","钱七","qianqi@example.com","13800138004","杭州市西湖区","2024-01-05"]];return{headers:o.value.addRowIndex?["行号",...l]:l,preview:o.value.addRowIndex?e.map((s,n)=>[String(n+1),...s]):e,rows:100,columns:l.length,removedRows:5,removedColumns:1}},B=()=>{const l=r.value.headers.join(","),e=r.value.preview.map(b=>b.join(",")),s=[l,...e].join(`
`),n=new Blob([s],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(n),p=document.createElement("a");p.href=x,p.download="cleaned_data.csv",p.click(),URL.revokeObjectURL(x),f("CSV文件已下载","success")},I=()=>{const l=r.value.headers.join("	"),e=r.value.preview.map(b=>b.join("	")),s=[l,...e].join(`
`),n=new Blob(["\uFEFF"+s],{type:"application/vnd.ms-excel"}),x=URL.createObjectURL(n),p=document.createElement("a");p.href=x,p.download="cleaned_data.xls",p.click(),URL.revokeObjectURL(x),f("Excel文件已下载","success")},L=l=>{if(l===0)return"0 Bytes";const e=1024,s=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(l)/Math.log(e));return Math.round(l/Math.pow(e,n)*100)/100+" "+s[n]},f=(l,e)=>{g.value=l,R.value=e,setTimeout(()=>{g.value=""},3e3)};return(l,e)=>(i(),W(_,{title:"数据清洗工具",description:"清洗和标准化Excel数据"},{default:T(()=>[t("div",O,[t("div",q,[t("input",{ref_key:"fileInput",ref:C,type:"file",accept:".xlsx,.xls,.csv",onChange:U,class:"hidden"},null,544),t("div",{onClick:z,onDragover:e[0]||(e[0]=E(()=>{},["prevent"])),onDrop:E(D,["prevent"]),class:"cursor-pointer"},[...e[14]||(e[14]=[t("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),t("p",{class:"text-text-primary mb-2"},"点击或拖拽Excel/CSV文件到此处",-1),t("p",{class:"text-sm text-text-secondary"},"支持 .xlsx, .xls, .csv 格式",-1)])],32)]),c.value?(i(),m("div",A,[t("div",{class:"flex items-center justify-between"},[e[15]||(e[15]=t("h3",{class:"text-lg font-semibold text-text-primary"},"文件信息",-1)),t("button",{onClick:j,class:"px-3 py-1.5 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors"}," 清除文件 ")]),t("div",G,[t("p",K,[e[16]||(e[16]=t("strong",null,"文件名:",-1)),V(" "+u(c.value.name),1)]),t("p",$,[e[17]||(e[17]=t("strong",null,"大小:",-1)),V(" "+u(L(c.value.size)),1)])]),t("div",J,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold text-text-primary"},"清洗选项",-1)),t("div",P,[t("div",Q,[e[21]||(e[21]=t("h4",{class:"font-medium text-text-primary"},"空值处理",-1)),t("div",X,[a(t("input",{id:"removeEmptyRows","onUpdate:modelValue":e[1]||(e[1]=s=>o.value.removeEmptyRows=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.removeEmptyRows]]),e[18]||(e[18]=t("label",{for:"removeEmptyRows",class:"text-sm text-text-secondary"},"删除空行",-1))]),t("div",Y,[a(t("input",{id:"removeEmptyColumns","onUpdate:modelValue":e[2]||(e[2]=s=>o.value.removeEmptyColumns=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.removeEmptyColumns]]),e[19]||(e[19]=t("label",{for:"removeEmptyColumns",class:"text-sm text-text-secondary"},"删除空列",-1))]),t("div",Z,[a(t("input",{id:"fillEmptyWith","onUpdate:modelValue":e[3]||(e[3]=s=>o.value.fillEmptyWith=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.fillEmptyWith]]),e[20]||(e[20]=t("label",{for:"fillEmptyWith",class:"text-sm text-text-secondary"},"填充空值为:",-1)),a(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.fillValue=s),type:"text",placeholder:"默认值",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-primary focus:border-transparent"},null,512),[[F,o.value.fillValue]])])]),t("div",ee,[e[26]||(e[26]=t("h4",{class:"font-medium text-text-primary"},"文本处理",-1)),t("div",te,[a(t("input",{id:"trimWhitespace","onUpdate:modelValue":e[5]||(e[5]=s=>o.value.trimWhitespace=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.trimWhitespace]]),e[22]||(e[22]=t("label",{for:"trimWhitespace",class:"text-sm text-text-secondary"},"去除首尾空格",-1))]),t("div",se,[a(t("input",{id:"removeDuplicates","onUpdate:modelValue":e[6]||(e[6]=s=>o.value.removeDuplicates=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.removeDuplicates]]),e[23]||(e[23]=t("label",{for:"removeDuplicates",class:"text-sm text-text-secondary"},"删除重复行",-1))]),t("div",oe,[a(t("input",{id:"standardizeCase","onUpdate:modelValue":e[7]||(e[7]=s=>o.value.standardizeCase=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.standardizeCase]]),e[25]||(e[25]=t("label",{for:"standardizeCase",class:"text-sm text-text-secondary"},"统一大小写:",-1)),a(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.value.caseType=s),class:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-primary focus:border-transparent"},[...e[24]||(e[24]=[t("option",{value:"lower"},"小写",-1),t("option",{value:"upper"},"大写",-1),t("option",{value:"title"},"首字母大写",-1)])],512),[[N,o.value.caseType]])])])]),t("div",le,[t("div",re,[e[30]||(e[30]=t("h4",{class:"font-medium text-text-primary"},"数据格式",-1)),t("div",ae,[a(t("input",{id:"removeSpecialChars","onUpdate:modelValue":e[9]||(e[9]=s=>o.value.removeSpecialChars=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.removeSpecialChars]]),e[27]||(e[27]=t("label",{for:"removeSpecialChars",class:"text-sm text-text-secondary"},"去除特殊字符",-1))]),t("div",ne,[a(t("input",{id:"standardizeDates","onUpdate:modelValue":e[10]||(e[10]=s=>o.value.standardizeDates=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.standardizeDates]]),e[28]||(e[28]=t("label",{for:"standardizeDates",class:"text-sm text-text-secondary"},"标准化日期格式",-1))]),t("div",de,[a(t("input",{id:"standardizeNumbers","onUpdate:modelValue":e[11]||(e[11]=s=>o.value.standardizeNumbers=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.standardizeNumbers]]),e[29]||(e[29]=t("label",{for:"standardizeNumbers",class:"text-sm text-text-secondary"},"标准化数字格式",-1))])]),t("div",ie,[e[33]||(e[33]=t("h4",{class:"font-medium text-text-primary"},"高级选项",-1)),t("div",ue,[a(t("input",{id:"removeHeaderRow","onUpdate:modelValue":e[12]||(e[12]=s=>o.value.removeHeaderRow=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.removeHeaderRow]]),e[31]||(e[31]=t("label",{for:"removeHeaderRow",class:"text-sm text-text-secondary"},"删除标题行",-1))]),t("div",pe,[a(t("input",{id:"addRowIndex","onUpdate:modelValue":e[13]||(e[13]=s=>o.value.addRowIndex=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[d,o.value.addRowIndex]]),e[32]||(e[32]=t("label",{for:"addRowIndex",class:"text-sm text-text-secondary"},"添加行号列",-1))])])])]),t("button",{onClick:M,disabled:y.value,class:"w-full py-3 px-4 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"},u(y.value?"处理中...":"清洗数据"),9,me)])):w("",!0),r.value?(i(),m("div",ce,[t("div",{class:"flex items-center justify-between"},[e[35]||(e[35]=t("h3",{class:"text-lg font-semibold text-text-primary"},"清洗结果",-1)),t("div",{class:"flex gap-2"},[t("button",{onClick:B,class:"px-3 py-1.5 bg-green-500 text-white text-sm rounded-lg hover:bg-green-600 transition-colors"}," 下载CSV "),t("button",{onClick:I,class:"px-3 py-1.5 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-colors"}," 下载Excel ")])]),t("div",xe,[t("div",ve,[t("div",null,[t("p",ye,u(r.value.rows),1),e[36]||(e[36]=t("p",{class:"text-sm text-text-secondary"},"总行数",-1))]),t("div",null,[t("p",ge,u(r.value.columns),1),e[37]||(e[37]=t("p",{class:"text-sm text-text-secondary"},"总列数",-1))]),t("div",null,[t("p",fe,u(r.value.removedRows),1),e[38]||(e[38]=t("p",{class:"text-sm text-text-secondary"},"删除行数",-1))]),t("div",null,[t("p",be,u(r.value.removedColumns),1),e[39]||(e[39]=t("p",{class:"text-sm text-text-secondary"},"删除列数",-1))])])]),t("div",we,[t("table",he,[t("thead",null,[t("tr",ke,[(i(!0),m(h,null,k(r.value.headers,(s,n)=>(i(),m("th",{key:n,class:"px-2 py-2 text-left font-medium text-text-primary"},u(s),1))),128))])]),t("tbody",null,[(i(!0),m(h,null,k(r.value.preview,(s,n)=>(i(),m("tr",{key:n,class:"border-b border-gray-100"},[(i(!0),m(h,null,k(s,(x,p)=>(i(),m("td",{key:p,class:"px-2 py-2 text-text-secondary"},u(x),1))),128))]))),128))])])])])):w("",!0),g.value?(i(),m("div",{key:2,class:H(["fixed top-4 right-4 px-4 py-2 rounded-lg shadow-lg z-50",R.value==="success"?"bg-green-500 text-white":"bg-red-500 text-white"])},u(g.value),3)):w("",!0)])]),_:1}))}};export{Ue as default};
