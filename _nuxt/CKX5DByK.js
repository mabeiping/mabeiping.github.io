import{n as e,p as l,z as a,a8 as s,J as r,D as t,a7 as o,F as d,u as n,x as u,v as i,k as m,C as c,m as p}from"./DFWWPSrV.js";import v from"./CAdd_UJG.js";import{_ as g}from"./nEzmyvu1.js";const x={class:"min-h-screen bg-gray-50"},y={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},b={class:"bg-white rounded-lg shadow-sm p-4 mb-6"},f={class:"space-y-4"},h={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},k={class:"flex items-center p-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 transition-colors"},w={class:"flex items-center p-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 transition-colors"},M={class:"flex items-center p-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 transition-colors"},Y={class:"flex items-center p-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 transition-colors"},V={class:"flex items-center p-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 transition-colors"},C={class:"flex items-center p-2 border border-gray-300 rounded-md cursor-pointer hover:bg-gray-50 transition-colors"},D={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},B={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},j={key:2},U=["value"],L={class:"bg-white rounded-lg shadow-sm p-4 mb-6"},z={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center"},A={class:"mt-2 text-sm text-gray-600"},F={for:"file-upload",class:"relative cursor-pointer bg-white rounded-md font-medium text-primary-600 hover:text-primary-500 focus-within:outline-none"},_={key:0,class:"mt-4 p-3 bg-gray-50 rounded-md"},E={class:"flex items-center"},H={class:"ml-3 flex-1"},X={class:"text-sm font-medium text-gray-900"},G={class:"text-xs text-gray-500"},I={class:"flex justify-center mb-6"},S=["disabled"],q={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},J={key:0,class:"bg-white rounded-lg shadow-sm p-4 mb-6"},K={key:0,class:"space-y-4"},N={class:"bg-green-50 border border-green-200 rounded-md p-4"},O={class:"flex items-start"},P={class:"ml-3"},Q={class:"text-sm font-medium text-green-800"},R={key:0,class:"space-y-3"},T={class:"text-sm font-medium text-gray-900 mb-1"},W={key:0,class:"text-xs text-gray-600"},Z={key:1,class:"mt-2"},$={class:"text-xs text-gray-600 list-disc list-inside space-y-1"},ee={key:1,class:"mt-4"},le=["href"],ae={key:1,class:"bg-red-50 border border-red-200 rounded-md p-4"},se={class:"flex items-start"},re={class:"ml-3"},te={class:"text-sm font-medium text-red-800"},oe={key:0,class:"text-xs text-red-600 mt-1"},de=g({__name:"validate",setup(g){const de=c(),ne=m(null),ue=m(!1),ie=m(null),me=m(["duplicate","empty"]),ce=m(""),pe=m(""),ve=m("YYYY-MM-DD"),ge=m("integer"),xe=m(""),ye=m("all"),be=m([]),fe=m(""),he=e=>{const l=e.target.files[0];l&&(ne.value=l)},ke=()=>{ne.value=null,ie.value=null,be.value=[]},we=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},Me=async()=>{if(ne.value&&0!==me.value.length){ue.value=!0,ie.value=null;try{const e={file:ne.value,rules:me.value,sheet:ye.value,columns:fe.value};me.value.includes("range")&&(e.minValue=ce.value,e.maxValue=pe.value),me.value.includes("format")&&(e.dateFormat=ve.value,e.numberFormat=ge.value),me.value.includes("formula")&&(e.formula=xe.value);const l=await v.excelValidate(e);ie.value=l}catch(e){ie.value={success:!1,message:"验证失败："+e.message,suggestion:"请检查文件是否损坏，或尝试使用其他文件"}}finally{ue.value=!1}}},Ye=()=>{de.back()};return(m,c)=>(p(),e("div",x,[l("div",{class:"bg-white shadow-sm"},[l("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},[l("div",{class:"flex justify-between h-16"},[c[14]||(c[14]=l("div",{class:"flex items-center"},[l("h1",{class:"text-xl font-semibold text-gray-900"},"Excel数据验证工具")],-1)),l("div",{class:"flex items-center"},[l("button",{onClick:Ye,class:"text-gray-600 hover:text-gray-900 mr-4"},[...c[13]||(c[13]=[l("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])])])])])]),l("main",y,[c[47]||(c[47]=l("div",{class:"bg-white rounded-lg shadow-sm p-4 mb-6"},[l("p",{class:"text-gray-600"},"检查Excel数据的完整性、一致性和准确性，支持多种验证规则。")],-1)),l("div",b,[c[32]||(c[32]=l("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"验证选项",-1)),l("div",f,[l("div",null,[c[21]||(c[21]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"验证规则",-1)),l("div",h,[l("label",k,[a(l("input",{"onUpdate:modelValue":c[0]||(c[0]=e=>me.value=e),type:"checkbox",value:"duplicate",class:"mr-2 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[s,me.value]]),c[15]||(c[15]=l("span",{class:"text-sm"},"重复数据检测",-1))]),l("label",w,[a(l("input",{"onUpdate:modelValue":c[1]||(c[1]=e=>me.value=e),type:"checkbox",value:"empty",class:"mr-2 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[s,me.value]]),c[16]||(c[16]=l("span",{class:"text-sm"},"空值检测",-1))]),l("label",M,[a(l("input",{"onUpdate:modelValue":c[2]||(c[2]=e=>me.value=e),type:"checkbox",value:"format",class:"mr-2 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[s,me.value]]),c[17]||(c[17]=l("span",{class:"text-sm"},"格式验证",-1))]),l("label",Y,[a(l("input",{"onUpdate:modelValue":c[3]||(c[3]=e=>me.value=e),type:"checkbox",value:"range",class:"mr-2 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[s,me.value]]),c[18]||(c[18]=l("span",{class:"text-sm"},"数值范围验证",-1))]),l("label",V,[a(l("input",{"onUpdate:modelValue":c[4]||(c[4]=e=>me.value=e),type:"checkbox",value:"unique",class:"mr-2 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[s,me.value]]),c[19]||(c[19]=l("span",{class:"text-sm"},"唯一性验证",-1))]),l("label",C,[a(l("input",{"onUpdate:modelValue":c[5]||(c[5]=e=>me.value=e),type:"checkbox",value:"formula",class:"mr-2 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"},null,512),[[s,me.value]]),c[20]||(c[20]=l("span",{class:"text-sm"},"公式验证",-1))])])]),me.value.includes("range")?(p(),e("div",D,[l("div",null,[c[22]||(c[22]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"最小值",-1)),a(l("input",{"onUpdate:modelValue":c[6]||(c[6]=e=>ce.value=e),type:"number",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"最小值"},null,512),[[r,ce.value]])]),l("div",null,[c[23]||(c[23]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"最大值",-1)),a(l("input",{"onUpdate:modelValue":c[7]||(c[7]=e=>pe.value=e),type:"number",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"最大值"},null,512),[[r,pe.value]])])])):t("",!0),me.value.includes("format")?(p(),e("div",B,[l("div",null,[c[25]||(c[25]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"日期格式",-1)),a(l("select",{"onUpdate:modelValue":c[8]||(c[8]=e=>ve.value=e),class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[...c[24]||(c[24]=[l("option",{value:"YYYY-MM-DD"},"YYYY-MM-DD",-1),l("option",{value:"DD/MM/YYYY"},"DD/MM/YYYY",-1),l("option",{value:"MM/DD/YYYY"},"MM/DD/YYYY",-1)])],512),[[o,ve.value]])]),l("div",null,[c[27]||(c[27]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"数字格式",-1)),a(l("select",{"onUpdate:modelValue":c[9]||(c[9]=e=>ge.value=e),class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[...c[26]||(c[26]=[l("option",{value:"integer"},"整数",-1),l("option",{value:"decimal"},"小数",-1),l("option",{value:"percentage"},"百分比",-1)])],512),[[o,ge.value]])])])):t("",!0),me.value.includes("formula")?(p(),e("div",j,[c[28]||(c[28]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"验证公式",-1)),a(l("input",{"onUpdate:modelValue":c[10]||(c[10]=e=>xe.value=e),type:"text",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"例如: A1>0"},null,512),[[r,xe.value]])])):t("",!0),l("div",null,[c[30]||(c[30]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"工作表",-1)),a(l("select",{"onUpdate:modelValue":c[11]||(c[11]=e=>ye.value=e),class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[c[29]||(c[29]=l("option",{value:"all"},"所有工作表",-1)),(p(!0),e(d,null,n(be.value,l=>(p(),e("option",{key:l,value:l},u(l),9,U))),128))],512),[[o,ye.value]])]),l("div",null,[c[31]||(c[31]=l("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"列范围",-1)),a(l("input",{"onUpdate:modelValue":c[12]||(c[12]=e=>fe.value=e),type:"text",class:"w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"例如: A-C, E, G-I"},null,512),[[r,fe.value]])])])]),l("div",L,[c[39]||(c[39]=l("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"文件上传",-1)),l("div",z,[c[35]||(c[35]=l("svg",{class:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),l("p",A,[l("label",F,[c[33]||(c[33]=l("span",null,"选择Excel文件",-1)),l("input",{id:"file-upload",name:"file-upload",type:"file",class:"sr-only",accept:".xlsx,.xls",onChange:he},null,32)]),c[34]||(c[34]=l("span",{class:"text-gray-500"},"或拖放文件到此处",-1))]),c[36]||(c[36]=l("p",{class:"text-xs text-gray-500 mt-1"}," 支持XLSX、XLS格式，最大文件大小10MB ",-1))]),ne.value?(p(),e("div",_,[l("div",E,[c[38]||(c[38]=l("div",{class:"flex-shrink-0 h-10 w-10 bg-gray-200 rounded-md flex items-center justify-center"},[l("svg",{class:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})])],-1)),l("div",H,[l("p",X,u(ne.value.name),1),l("p",G,u(we(ne.value.size)),1)]),l("button",{onClick:ke,class:"text-red-600 hover:text-red-900"},[...c[37]||(c[37]=[l("svg",{class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])])):t("",!0)]),l("div",I,[l("button",{onClick:Me,disabled:!ne.value||0===me.value.length||ue.value,class:"bg-primary-600 text-white px-6 py-2 rounded-md hover:bg-primary-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors flex items-center"},[ue.value?(p(),e("svg",q,[...c[40]||(c[40]=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):t("",!0),i(" "+u(ue.value?"验证中...":"开始验证"),1)],8,S)]),ie.value?(p(),e("div",J,[c[46]||(c[46]=l("h2",{class:"text-lg font-medium text-gray-900 mb-4"},"验证结果",-1)),ie.value.success?(p(),e("div",K,[l("div",N,[l("div",O,[c[41]||(c[41]=l("div",{class:"flex-shrink-0"},[l("svg",{class:"h-5 w-5 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),l("div",P,[l("p",Q,u(ie.value.message),1)])])]),ie.value.details?(p(),e("div",R,[c[43]||(c[43]=l("h3",{class:"text-sm font-medium text-gray-900 mb-2"},"详细结果",-1)),(p(!0),e(d,null,n(ie.value.details,(a,s)=>(p(),e("div",{key:s,class:"border border-gray-200 rounded-md p-3"},[l("h4",T,u(a.rule)+": "+u(a.status?"通过":"失败"),1),a.message?(p(),e("p",W,u(a.message),1)):t("",!0),a.issues&&a.issues.length>0?(p(),e("div",Z,[c[42]||(c[42]=l("p",{class:"text-xs font-medium text-gray-700 mb-1"},"问题列表:",-1)),l("ul",$,[(p(!0),e(d,null,n(a.issues,(l,a)=>(p(),e("li",{key:a},u(l),1))),128))])])):t("",!0)]))),128))])):t("",!0),ie.value.reportLink?(p(),e("div",ee,[l("a",{href:ie.value.reportLink,download:"validation-report.xlsx",class:"flex items-center p-3 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors"},[...c[44]||(c[44]=[l("svg",{class:"h-5 w-5 text-gray-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),l("span",{class:"text-gray-700"},"下载验证报告",-1)])],8,le)])):t("",!0)])):(p(),e("div",ae,[l("div",se,[c[45]||(c[45]=l("div",{class:"flex-shrink-0"},[l("svg",{class:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),l("div",re,[l("p",te,u(ie.value.message),1),ie.value.suggestion?(p(),e("p",oe,u(ie.value.suggestion),1)):t("",!0)])])]))])):t("",!0)])]))}},[["__scopeId","data-v-ab13d1a1"]]);export{de as default};
