import{h as $,w as I,o as a,a as e,c as i,i as g,j as n,y as M,t as d,F as _,r as C,k as x,m as B,q as z,p as N}from"./DCjyjKAr.js";import{_ as A}from"./D0U6RbFw.js";import"./DkZTtWde.js";import"./D9bAZPev.js";const H={class:"space-y-6"},R={class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors"},S={key:0,class:"space-y-4"},W={class:"text-lg font-semibold text-text-primary"},q={class:"space-y-2"},O={class:"flex items-center gap-3"},G={class:"text-sm font-medium text-text-primary"},K={class:"text-xs text-text-secondary"},J=["onClick"],Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},X={class:"flex items-center gap-2"},Y={class:"flex items-center gap-2"},Z=["disabled"],ee={key:1,class:"space-y-4"},te={class:"space-y-2"},oe={class:"flex items-center gap-3"},se={class:"text-sm font-medium text-text-primary"},le={class:"text-xs text-text-secondary"},re=["onClick"],ce={__name:"format-convert",setup(ne){const f=n(null),r=n([]),u=n([]),c=n("docx"),y=n("high"),b=n(!0),h=n(!0),p=n(!1),m=n(""),w=n("success"),L=()=>{f.value.click()},P=o=>{const t=Array.from(o.target.files);r.value=[...r.value,...t]},D=o=>{const s=Array.from(o.dataTransfer.files).filter(l=>l.type==="application/pdf");if(s.length===0){v("请选择PDF文件","error");return}r.value=[...r.value,...s]},V=o=>{r.value.splice(o,1)},U=()=>{if(r.value.length===0){v("请先选择文件","error");return}p.value=!0,setTimeout(()=>{u.value=r.value.map(o=>{const t=c.value;return{name:o.name.replace(".pdf",`.${t}`),size:Math.round(o.size*.8),originalFile:o}}),p.value=!1,v("转换完成！","success")},2e3)},k=o=>{const t=new Blob(["Converted content"],{type:"text/plain"}),s=URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=o.name,l.click(),URL.revokeObjectURL(s),v(`已下载 ${o.name}`,"success")},j=()=>{u.value.forEach(o=>{k(o)})},E=o=>({docx:"Word 文档",doc:"Word 文档",xlsx:"Excel 表格",xls:"Excel 表格",pptx:"PowerPoint 演示文稿",ppt:"PowerPoint 演示文稿",txt:"纯文本",rtf:"富文本格式",html:"HTML 网页"})[o]||o,F=o=>{if(o===0)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(o)/Math.log(t));return Math.round(o/Math.pow(t,l)*100)/100+" "+s[l]},v=(o,t)=>{m.value=o,w.value=t,setTimeout(()=>{m.value=""},3e3)};return(o,t)=>(a(),$(A,{title:"PDF格式转换",description:"将PDF文件转换为其他格式"},{default:I(()=>[e("div",H,[e("div",R,[e("input",{ref_key:"fileInput",ref:f,type:"file",accept:".pdf",multiple:"",onChange:P,class:"hidden"},null,544),e("div",{onClick:L,onDragover:t[0]||(t[0]=M(()=>{},["prevent"])),onDrop:M(D,["prevent"]),class:"cursor-pointer"},[...t[5]||(t[5]=[e("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),e("p",{class:"text-text-primary mb-2"},"点击或拖拽PDF文件到此处",-1),e("p",{class:"text-sm text-text-secondary"},"支持多个文件上传",-1)])],32)]),r.value.length>0?(a(),i("div",S,[e("h3",W,"已选择的文件 ("+d(r.value.length)+")",1),e("div",q,[(a(!0),i(_,null,C(r.value,(s,l)=>(a(),i("div",{key:l,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",O,[t[6]||(t[6]=e("svg",{class:"w-8 h-8 text-red-500",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h6v6h6v10H6z"})],-1)),e("div",null,[e("p",G,d(s.name),1),e("p",K,d(F(s.size)),1)])]),e("button",{onClick:T=>V(l),class:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors"},[...t[7]||(t[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,J)]))),128))]),e("div",Q,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-text-secondary mb-2"},"输出格式",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[...t[8]||(t[8]=[e("option",{value:"docx"},"Word 文档 (.docx)",-1),e("option",{value:"doc"},"Word 文档 (.doc)",-1),e("option",{value:"xlsx"},"Excel 表格 (.xlsx)",-1),e("option",{value:"xls"},"Excel 表格 (.xls)",-1),e("option",{value:"pptx"},"PowerPoint 演示文稿 (.pptx)",-1),e("option",{value:"ppt"},"PowerPoint 演示文稿 (.ppt)",-1),e("option",{value:"txt"},"纯文本 (.txt)",-1),e("option",{value:"rtf"},"富文本格式 (.rtf)",-1),e("option",{value:"html"},"HTML 网页 (.html)",-1)])],512),[[B,c.value]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-text-secondary mb-2"},"转换质量",-1)),x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[...t[10]||(t[10]=[e("option",{value:"high"},"高质量 (推荐)",-1),e("option",{value:"medium"},"中等质量",-1),e("option",{value:"low"},"低质量 (文件更小)",-1)])],512),[[B,y.value]])])]),e("div",X,[x(e("input",{id:"preserveFormatting","onUpdate:modelValue":t[3]||(t[3]=s=>b.value=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[z,b.value]]),t[12]||(t[12]=e("label",{for:"preserveFormatting",class:"text-sm text-text-secondary"},"保留原始格式",-1))]),e("div",Y,[x(e("input",{id:"includeImages","onUpdate:modelValue":t[4]||(t[4]=s=>h.value=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"},null,512),[[z,h.value]]),t[13]||(t[13]=e("label",{for:"includeImages",class:"text-sm text-text-secondary"},"包含图片",-1))]),e("button",{onClick:U,disabled:p.value,class:"w-full py-3 px-4 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"},d(p.value?"转换中...":`转换为 ${E(c.value)}`),9,Z)])):g("",!0),u.value.length>0?(a(),i("div",ee,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold text-text-primary"},"转换结果",-1)),e("div",te,[(a(!0),i(_,null,C(u.value,(s,l)=>(a(),i("div",{key:l,class:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200"},[e("div",oe,[t[14]||(t[14]=e("svg",{class:"w-8 h-8 text-green-500",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})],-1)),e("div",null,[e("p",se,d(s.name),1),e("p",le,d(F(s.size)),1)])]),e("button",{onClick:T=>k(s),class:"px-4 py-2 bg-green-500 text-white text-sm rounded-lg hover:bg-green-600 transition-colors"}," 下载 ",8,re)]))),128))]),e("button",{onClick:j,class:"w-full py-3 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"}," 下载全部文件 ")])):g("",!0),m.value?(a(),i("div",{key:2,class:N(["fixed top-4 right-4 px-4 py-2 rounded-lg shadow-lg z-50",w.value==="success"?"bg-green-500 text-white":"bg-red-500 text-white"])},d(m.value),3)):g("",!0)])]),_:1}))}};export{ce as default};
