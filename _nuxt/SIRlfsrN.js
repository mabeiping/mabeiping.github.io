import{o as e,G as l,m as a,n as t,p as s,H as r,E as o,x as n,F as u,u as i,D as d,q as c,w as v,z as p,I as g,J as b,K as x,v as m,L as f,T as y,k as h}from"./DwDdtX2U.js";import w from"./DHycn8vl.js";import{_ as k}from"./DwL8tNwU.js";const j={id:"format-converter",class:"mb-6"},P={class:"bg-white rounded-xl shadow-sm"},D={class:"p-4"},C={class:"flex flex-col items-center justify-center space-y-3"},F={class:"text-xs text-gray-500 mt-0.5"},M=["accept"],L={key:0,class:"mt-4"},_={class:"flex items-center justify-between bg-gray-100 p-2 rounded-lg mb-2"},B={class:"flex items-center space-x-2"},R={class:"text-xs font-medium"},q={class:"space-y-1"},V={class:"text-xs truncate"},U={class:"text-xs text-gray-500"},z=["onClick"],G={key:0,class:"space-y-4"},T={class:"bg-gray-50 p-3 rounded-lg"},A={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-1.5"},I=["value"],W={class:"text-xs"},E={class:"text-xs text-gray-500"},J={key:0,class:"bg-gray-50 p-3 rounded-lg"},N={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},S=["value"],$={key:0},H={key:1},K={class:"text-xs text-gray-500 text-center"},O={class:"flex space-x-3"},X=["disabled"],Y={key:0},Q={key:1,class:"flex items-center justify-center"},Z={key:1,class:"mt-3"},ee={class:"w-full bg-gray-200 rounded-full h-2"},le={class:"mt-1 flex justify-between items-center"},ae={class:"text-xs text-gray-600"},te={class:"text-xs text-gray-500"},se={class:"mt-1 flex justify-between text-xs text-gray-400"},re={key:0,class:"mt-1 text-xs text-gray-500"},oe={class:"flex justify-between"},ne={key:0,class:"mt-4"},ue={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-3"},ie={class:"mt-1 text-sm text-green-700"},de={class:"mt-2 space-y-1.5"},ce=["href","download","onClick"],ve={key:0,class:"mt-3"},pe={class:"bg-white p-2 rounded border border-gray-200"},ge=["src"],be={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-3"},xe={class:"mt-1 text-sm text-red-700"},me={key:0,class:"mt-1 text-xs text-gray-600"},fe=k({__name:"FormatConverter",setup(k){const fe=h([".pdf",".doc",".docx",".xls",".xlsx",".jpg",".jpeg",".png",".gif",".webp"]),ye=h(null),he=h([]),we=h(!1),ke=h(""),je=h(""),Pe=h(!1),De=h(null),Ce=h(0),Fe=h(""),Me=h(-1),Le=h({queue_length:0,processing_rate:0,average_wait_time:0}),_e=h({processMode:"format-preserve",quality:80,pageRange:"",preserveLayout:!0,includeImages:!0}),Be=h([]),Re=h([{value:"format-preserve",label:"保留原格式还原"},{value:"text-image",label:"文字 + 图片提取"},{value:"text-only",label:"纯文字提取"}]),qe={pdf:[{value:"docx",label:"Word (.docx)",description:"适合编辑文本内容"},{value:"txt",label:"文本 (.txt)",description:"纯文本格式"},{value:"jpg",label:"图片 (.jpg)",description:"将PDF转换为图片"},{value:"png",label:"图片 (.png)",description:"无损压缩图片格式"},{value:"webp",label:"图片 (.webp)",description:"现代网页图片格式"}],doc:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"},{value:"txt",label:"文本 (.txt)",description:"纯文本格式"}],docx:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"},{value:"txt",label:"文本 (.txt)",description:"纯文本格式"}],xls:[{value:"csv",label:"CSV (.csv)",description:"逗号分隔值"},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],xlsx:[{value:"csv",label:"CSV (.csv)",description:"逗号分隔值"},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],ppt:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],pptx:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],txt:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"},{value:"docx",label:"Word (.docx)",description:"适合编辑文本内容"}],jpg:[{value:"png",label:"PNG (.png)",description:"无损压缩格式"},{value:"webp",label:"WebP (.webp)",description:"现代网页图片格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}],jpeg:[{value:"png",label:"PNG (.png)",description:"无损压缩格式"},{value:"webp",label:"WebP (.webp)",description:"现代网页图片格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}],png:[{value:"jpg",label:"JPG (.jpg)",description:"有损压缩格式"},{value:"webp",label:"WebP (.webp)",description:"现代网页图片格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}],webp:[{value:"jpg",label:"JPG (.jpg)",description:"通用图片格式"},{value:"png",label:"PNG (.png)",description:"无损压缩格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}]},Ve=e=>{e.preventDefault(),we.value=!0},Ue=e=>{e.preventDefault(),we.value=!0},ze=e=>{e.preventDefault();const l=e.currentTarget.getBoundingClientRect();(e.clientX<l.left||e.clientX>=l.right||e.clientY<l.top||e.clientY>=l.bottom)&&(we.value=!1)},Ge=e=>{e.preventDefault(),we.value=!1;const l=Array.from(e.dataTransfer.files);Ae(l)},Te=e=>{const l=Array.from(e.target.files);Ae(l)},Ae=e=>{if(0===e.length)return;if(e.length>10)return void alert("最多支持上传10个文件");const l=e.map(e=>{const l=e.name.split(".");return l.length>1?l.pop().toLowerCase():""}),a=[...new Set(l)];if(a.length>1)return void alert("仅允许上传相同后缀名的文件");const t=a[0];ke.value=t,We(t),Ie(e)},Ie=e=>{he.value=e},We=e=>{Be.value=qe[e]||[],Be.value.length>0?(je.value=Be.value[0].value,Ee(Be.value[0].value)):je.value=""},Ee=e=>{Re.value={docx:[{value:"format-preserve",label:"保留原格式还原"},{value:"text-image",label:"文字 + 图片提取"},{value:"text-only",label:"纯文字提取"}],txt:[{value:"text-only",label:"纯文字提取"}],html:[{value:"text-image",label:"文字 + 图片提取"},{value:"text-only",label:"纯文字提取"}],jpg:[{value:"text-image",label:"文字 + 图片提取"}],png:[{value:"text-image",label:"文字 + 图片提取"}],webp:[{value:"text-image",label:"文字 + 图片提取"}],xlsx:[{value:"format-preserve",label:"保留原格式还原"},{value:"text-only",label:"纯文字提取"}],md:[{value:"format-preserve",label:"保留原格式还原"},{value:"text-only",label:"纯文字提取"}],csv:[{value:"text-only",label:"纯文字提取"}],pdf:[{value:"format-preserve",label:"保留原格式还原"}]}[e]||[{value:"format-preserve",label:"保留原格式还原"}];const l=Re.value[0].value;_e.value.processMode=l},Je=()=>{he.value=[],ke.value="",je.value="",Be.value=[],De.value=null,_e.value={processMode:"standard",quality:80,pageRange:"",preserveLayout:!0,includeImages:!0},ye.value&&(ye.value.value="")},Ne=async()=>{if(je.value){Pe.value=!0,Ce.value=0,Fe.value="准备开始处理...",Me.value=-1,De.value=null;try{Me.value=0,Fe.value="上传中：正在上传文件到服务器";for(let a=0;a<=66;a++)Ce.value=a,await new Promise(e=>setTimeout(e,30));const e={files:he.value,source_format:ke.value,target_format:je.value,process_mode:_e.value.processMode,quality:_e.value.quality,pageRange:_e.value.pageRange};Me.value=1,Fe.value="处理中：服务器正在转换文件格式";const l=await w.formatConvert(e);Me.value=2,Fe.value="返回结果中：正在获取转换结果";for(let a=67;a<=99;a++)Ce.value=a,await new Promise(e=>setTimeout(e,20));Ce.value=100,Fe.value="处理完成：正在显示结果",await new Promise(e=>setTimeout(e,300)),De.value=l}catch(e){De.value={success:!1,message:`转换失败：${e.message||"未知错误"}`,suggestion:"请检查文件是否损坏，或尝试使用其他文件"}}finally{setTimeout(()=>{Pe.value=!1,Ce.value=0,Fe.value="",Me.value=-1},500)}}else alert("请选择目标格式")},Se=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]};return e(()=>{}),l(je,e=>{e&&Ee(e)}),(e,l)=>(a(),t("section",j,[s("div",P,[l[17]||(l[17]=s("div",{class:"border-b border-gray-200 px-4 py-1"},[s("h2",{class:"text-lg font-bold text-gray-800"},"格式转换")],-1)),s("div",D,[s("div",{class:o(["border-2 border-dashed border-gray-300 rounded-lg p-4 text-center transition-all duration-300 mb-4",{"border-blue-500 bg-blue-50":we.value}]),onDragover:r(Ve,["prevent"]),onDragenter:r(Ue,["prevent"]),onDragleave:r(ze,["prevent"]),onDrop:r(Ge,["prevent"])},[s("div",C,[l[6]||(l[6]=s("svg",{class:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),s("div",null,[s("p",F," 拖拽文件到此处或点击选择，支持："+n(fe.value.join(", ")),1),l[5]||(l[5]=s("p",{class:"text-xs text-gray-400 mt-0.5"}," 提示：仅允许上传相同后缀名的文件，最多支持10个文件 ",-1))]),s("input",{type:"file",ref_key:"fileInput",ref:ye,onChange:Te,accept:fe.value.join(","),multiple:"",class:"hidden"},null,40,M),s("button",{onClick:l[0]||(l[0]=l=>e.$refs.fileInput.click()),class:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"}," 选择文件 ")]),he.value.length>0?(a(),t("div",L,[s("div",_,[s("div",B,[l[7]||(l[7]=s("svg",{class:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20"},[s("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V4z","clip-rule":"evenodd"})],-1)),s("span",R,n(he.value.length)+" 个文件已选择 ",1)]),s("button",{onClick:Je,class:"text-red-500 hover:text-red-700 text-xs"}," 清空 ")]),s("div",q,[(a(!0),t(u,null,i(he.value,(e,l)=>(a(),t("div",{key:l,class:"flex items-center justify-between bg-gray-50 p-1.5 rounded"},[s("span",V,n(e.name),1),s("span",U,n(Se(e.size)),1),s("button",{onClick:e=>(e=>{he.value.splice(e,1),0===he.value.length&&(ke.value="",je.value="",Be.value=[],De.value=null)})(l),class:"text-red-500 hover:text-red-700 text-xs ml-2"}," × ",8,z)]))),128))])])):d("",!0)],34),c(y,{name:"fade-slide",mode:"out-in"},{default:v(()=>[he.value.length>0&&ke.value?(a(),t("div",G,[s("div",T,[l[8]||(l[8]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"目标格式",-1)),s("div",A,[(a(!0),t(u,null,i(Be.value,e=>(a(),t("label",{key:e.value,class:o(["flex items-center space-x-1.5 cursor-pointer p-1.5 border rounded-md hover:bg-gray-100 transition-colors",{"border-blue-500 bg-blue-50":je.value===e.value}])},[p(s("input",{type:"radio","onUpdate:modelValue":l[1]||(l[1]=e=>je.value=e),value:e.value,class:"w-2.5 h-2.5 text-blue-600"},null,8,I),[[g,je.value]]),s("div",null,[s("div",W,n(e.label),1),s("div",E,n(e.description),1)])],2))),128))])]),je.value?(a(),t("div",J,[l[12]||(l[12]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"操作参数",-1)),s("div",N,[s("div",null,[l[9]||(l[9]=s("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"处理方式",-1)),p(s("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>_e.value.processMode=e),class:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"},[(a(!0),t(u,null,i(Re.value,e=>(a(),t("option",{key:e.value,value:e.value},n(e.label),9,S))),128))],512),[[b,_e.value.processMode]])]),["pdf","docx","doc"].includes(ke.value)?(a(),t("div",$,[l[10]||(l[10]=s("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"页面范围",-1)),p(s("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>_e.value.pageRange=e),type:"text",placeholder:"例如：1-5, 7, 9-12（留空表示全部）",class:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"},null,512),[[x,_e.value.pageRange]])])):d("",!0),["jpg","jpeg","png","webp"].includes(ke.value)?(a(),t("div",H,[l[11]||(l[11]=s("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"图片质量",-1)),p(s("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>_e.value.quality=e),type:"range",min:"1",max:"100",class:"w-full"},null,512),[[x,_e.value.quality,void 0,{number:!0}]]),s("p",K,n(_e.value.quality)+"%",1)])):d("",!0)])])):d("",!0),s("div",O,[s("button",{onClick:Ne,disabled:!je.value||Pe.value,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm"},[Pe.value?(a(),t("span",Q,[...l[13]||(l[13]=[s("svg",{class:"animate-spin -ml-1 mr-1 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),m(" 处理中... ",-1)])])):(a(),t("span",Y,"开始转换"))],8,X),s("button",{onClick:Je,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm"}," 重置 ")]),Pe.value?(a(),t("div",Z,[s("div",ee,[s("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-in-out",style:f({width:Ce.value+"%"})},null,4)]),s("div",le,[s("p",ae,n(Fe.value),1),s("p",te,n(Ce.value)+"%",1)]),s("div",se,[s("span",{class:o({"text-blue-600 font-medium":Me.value>=0})},"上传中",2),s("span",{class:o({"text-blue-600 font-medium":Me.value>=1})},"处理中",2),s("span",{class:o({"text-blue-600 font-medium":Me.value>=2})},"返回结果中",2)]),Me.value>=1?(a(),t("div",re,[s("div",oe,[s("span",null,"剩余处理请求: "+n(Le.value.queue_length),1),s("span",null,"处理速率: "+n((60*Le.value.processing_rate).toFixed(1))+" 请求/分钟",1)])])):d("",!0)])):d("",!0)])):d("",!0)]),_:1}),De.value?(a(),t("div",ne,[De.value.success?(a(),t("div",ue,[l[15]||(l[15]=s("div",{class:"flex items-center"},[s("svg",{class:"w-4 h-4 text-green-500 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",ie,n(De.value.message),1),s("div",de,[(a(!0),t(u,null,i(De.value.downloadLinks,(e,l)=>(a(),t("a",{key:l,href:e.url,download:e.filename,class:"block px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 transition-colors text-center text-sm",onClick:r(l=>(async e=>{try{const l=e.url,a=await fetch(l);if(!a.ok)throw new Error(`下载失败: ${a.status}`);const t=await a.blob(),s=document.createElement("a");s.href=URL.createObjectURL(t),s.download=e.filename,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(s.href)}catch(l){alert("下载失败，请稍后重试")}})(e),["prevent"])}," 下载转换结果 "+n(l+1),9,ce))),128))]),["jpg","jpeg","png","webp"].includes(je.value)&&De.value.downloadLinks?(a(),t("div",ve,[l[14]||(l[14]=s("p",{class:"text-sm font-medium text-gray-700 mb-1"},"转换预览",-1)),s("div",pe,[s("img",{src:De.value.downloadLinks[0].url,alt:"转换结果预览",class:"max-w-full max-h-40 object-contain"},null,8,ge)])])):d("",!0)])):(a(),t("div",be,[l[16]||(l[16]=s("div",{class:"flex items-center"},[s("svg",{class:"w-4 h-4 text-red-500 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",xe,n(De.value.message),1),De.value.suggestion?(a(),t("p",me,"建议："+n(De.value.suggestion),1)):d("",!0)]))])):d("",!0)])])]))}},[["__scopeId","data-v-b1b9400b"]]);export{fe as default};
