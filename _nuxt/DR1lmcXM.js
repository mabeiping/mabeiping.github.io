import{j as e,w as l,o as t,a as o,b as a,c as s,q as r,y as u,l as d,t as n,s as i,F as c,p as m,r as p}from"./BGpdZ-s9.js";import{_ as g}from"./B4wm4ekp.js";import{G as v}from"./BtAA_ILT.js";import{_ as b}from"./BCo6x5W8.js";import"./DILYegs3.js";import"./D_BBTi0O.js";import"./9Oz-M6e1.js";import"./DKLvglw8.js";const f={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},x={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},h={key:0,class:"mt-4 space-y-4"},y={key:1,class:"mt-4 p-4 bg-green-50 rounded-md"},w={class:"mt-2"},k={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},F={class:"space-y-4"},D={key:0},O={key:0,class:"mt-4 p-4 bg-green-50 rounded-md"},U={class:"mt-2"},j={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},C={key:0,class:"mt-4 space-y-4"},_={class:"font-medium text-gray-900 mb-2"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-2"},T={key:1,class:"mt-4 p-4 bg-green-50 rounded-md"},P={class:"mt-2"},E=b({__name:"index",setup(b){const E=p(null),S=p("pdf"),V=p(null),N=e=>{E.value=e[0]},W=e=>{E.value=e},q=()=>{E.value&&setTimeout(()=>{V.value={fileName:E.value.name.replace(/\.[^/.]+$/,"")+"."+S.value,url:"#"}},1500)},z=()=>{if(!V.value)return;const e=document.createElement("a");e.href=V.value.url,e.download=V.value.fileName,e.click()},G=p("split"),I=p([]),Y=p(""),Z=p(null),A=e=>{I.value=e},B=e=>{I.value=e},H=()=>{0!==I.value.length&&setTimeout(()=>{let e="";switch(G.value){case"split":e="OFD文件已成功拆分";break;case"merge":e=`${I.value.length}个OFD文件已成功合并`;break;case"encrypt":e="OFD文件已成功加密";break;case"extract":e="OFD文件内容已成功提取"}Z.value={message:e,url:"#"}},1500)},J=()=>{if(!Z.value)return;const e=document.createElement("a");e.href=Z.value.url,e.download="processed-ofd"+("split"===G.value?"-parts":"")+".ofd",e.click()},K=p([]),L=p(null),M=e=>{K.value=e},Q=e=>{K.value=e},R=()=>{0!==K.value.length&&setTimeout(()=>{L.value={message:`成功将 ${K.value.length} 个电子发票转换为PDF`,downloadUrl:"#"}},2e3)},X=()=>{0!==K.value.length&&setTimeout(()=>{L.value={message:`成功提取 ${K.value.length} 个电子发票的数据`,downloadUrl:"#"}},2e3)},ee=()=>{0!==K.value.length&&setTimeout(()=>{L.value={message:`成功归档 ${K.value.length} 个电子发票`,downloadUrl:"#"}},2e3)},le=()=>{if(!L.value?.downloadUrl)return;const e=document.createElement("a");e.href=L.value.downloadUrl,e.download="invoice-process-result.zip",e.click()};return(p,b)=>(t(),e(g,{title:"OFD/电子文档处理",description:"支持OFD与PDF/Word/图片互转、OFD文件拆分/合并/加密"},{default:l(()=>[o("div",f,[o("div",x,[b[6]||(b[6]=o("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"OFD格式转换",-1)),a(v,{accept:[".ofd",".pdf",".doc",".docx",".jpg",".jpeg",".png"],multiple:!1,onFilesSelected:N,onUploadComplete:W}),E.value?(t(),s("div",h,[o("div",null,[b[4]||(b[4]=o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"目标格式",-1)),r(o("select",{"onUpdate:modelValue":b[0]||(b[0]=e=>S.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[3]||(b[3]=[o("option",{value:"pdf"},"PDF",-1),o("option",{value:"docx"},"Word",-1),o("option",{value:"png"},"图片",-1),o("option",{value:"ofd"},"OFD",-1)])],512),[[u,S.value]])]),o("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:q}," 开始转换 ")])):d("",!0),V.value?(t(),s("div",y,[b[5]||(b[5]=o("h4",{class:"font-medium text-green-800"},"转换成功",-1)),o("p",w,"文件已转换为 "+n(S.value)+" 格式",1),o("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:z}," 下载转换结果 ")])):d("",!0)]),o("div",k,[b[12]||(b[12]=o("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"OFD文件处理",-1)),o("div",F,[o("div",null,[b[8]||(b[8]=o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"处理类型",-1)),r(o("select",{"onUpdate:modelValue":b[1]||(b[1]=e=>G.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[7]||(b[7]=[o("option",{value:"split"},"拆分OFD",-1),o("option",{value:"merge"},"合并OFD",-1),o("option",{value:"encrypt"},"加密OFD",-1),o("option",{value:"extract"},"提取内容",-1)])],512),[[u,G.value]])]),o("div",null,[b[9]||(b[9]=o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"OFD文件",-1)),a(v,{accept:[".ofd"],multiple:"merge"===G.value,onFilesSelected:A,onUploadComplete:B},null,8,["multiple"])]),"encrypt"===G.value?(t(),s("div",D,[b[10]||(b[10]=o("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密密码",-1)),r(o("input",{type:"password","onUpdate:modelValue":b[2]||(b[2]=e=>Y.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"输入加密密码"},null,512),[[i,Y.value]])])):d("",!0),o("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:H}," 开始处理 ")]),Z.value?(t(),s("div",O,[b[11]||(b[11]=o("h4",{class:"font-medium text-green-800"},"处理成功",-1)),o("p",U,n(Z.value.message),1),o("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:J}," 下载处理结果 ")])):d("",!0)]),o("div",j,[b[14]||(b[14]=o("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"电子发票批量处理",-1)),b[15]||(b[15]=o("p",{class:"text-sm text-gray-600 mb-4"},"支持批量上传OFD电子发票，进行统一处理",-1)),a(v,{accept:[".ofd"],multiple:!0,onFilesSelected:M,onUploadComplete:Q}),K.value.length>0?(t(),s("div",C,[o("div",null,[o("h4",_,"已选择 "+n(K.value.length)+" 个发票文件",1),o("div",$,[(t(!0),s(c,null,m(K.value,(e,l)=>(t(),s("div",{key:l,class:"text-sm text-gray-600"},n(e.name),1))),128))])]),o("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4"},[o("button",{class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:R}," 批量转PDF "),o("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:X}," 批量提取数据 "),o("button",{class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",onClick:ee}," 批量归档 ")])])):d("",!0),L.value?(t(),s("div",T,[b[13]||(b[13]=o("h4",{class:"font-medium text-green-800"},"处理成功",-1)),o("p",P,n(L.value.message),1),L.value.downloadUrl?(t(),s("button",{key:0,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:le}," 下载处理结果 ")):d("",!0)])):d("",!0)])])]),_:1}))}},[["__scopeId","data-v-9cdfbe8a"]]);export{E as default};
