import{_ as R}from"./D0U6RbFw.js";import{u as T,h as V,w as j,o as b,a as t,c as v,i as L,k as p,l as y,j as m,v as _,f as s,t as d,q as h,m as B,F as E,r as I}from"./DCjyjKAr.js";import"./DkZTtWde.js";import"./D9bAZPev.js";const M={class:"space-y-6"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},z={class:"space-y-4"},D={class:"flex justify-between"},F={class:"text-sm text-text-secondary"},N={class:"space-y-4"},P={class:"grid grid-cols-2 gap-4"},S={class:"space-y-2"},q={class:"flex items-center gap-2"},H={class:"flex items-center gap-2"},$={class:"flex items-center gap-2"},A=["disabled"],G={key:0,class:"space-y-4"},J={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},K={class:"p-4 bg-blue-50 rounded-lg"},Q={class:"text-2xl font-bold text-blue-700"},W={class:"p-4 bg-green-50 rounded-lg"},X={class:"text-2xl font-bold text-green-700"},Y={class:"p-4 bg-purple-50 rounded-lg"},Z={class:"text-2xl font-bold text-purple-700"},tt={class:"p-4 bg-orange-50 rounded-lg"},et={class:"text-2xl font-bold text-orange-700"},st={class:"space-y-2"},lt={class:"max-h-64 overflow-y-auto p-4 bg-gray-50 rounded-lg"},ot={class:"text-xs text-text-secondary w-12"},at={class:"font-mono text-sm bg-green-100 text-green-700 px-2 py-1 rounded"},ct={__name:"extract",setup(nt){const r=m(""),u=m(""),c=m("match"),f=m(!1),a=m(null),x=m({global:!1,caseInsensitive:!1,multiline:!1}),w=async()=>{if(!r.value||!u.value){alert("请输入文本和正则表达式");return}f.value=!0;try{await new Promise(i=>setTimeout(i,500));let n="";n.value.global&&(n+="g"),n.value.caseInsensitive&&(n+="i"),n.value.multiline&&(n+="m");const e=new RegExp(u.value,n),o=r.value.match(e);let l=[],g=0;o&&(c.value==="match"?l=o:c.value==="group"?(l=o.map(i=>i[1]||i[0]).filter(i=>i),g=o.filter(i=>i[1]).length):c.value==="all"&&(l=o)),a.value={valid:!0,matchCount:o?o.length:0,extractedCount:l.length,groups:g,extracted:l}}catch{a.value={valid:!1,matchCount:0,extractedCount:0,groups:0,extracted:[]}}finally{f.value=!1}},k=()=>{r.value="",a.value=null},C=async()=>{if(!a.value)return;const n=a.value.extracted.join(`
`);try{await navigator.clipboard.writeText(n),alert("已复制到剪贴板")}catch(e){console.error("Copy failed:",e),alert("复制失败，请手动复制")}},U=()=>{if(!a.value)return;const n=a.value.extracted.join(`
`),e=new Blob([n],{type:"text/plain;charset=utf-8"}),o=document.createElement("a");o.href=URL.createObjectURL(e),o.download="extracted_text.txt",o.click(),URL.revokeObjectURL(o.href)};return T({title:"正则提取 - Office Tools",meta:[{name:"description",content:"使用正则提取文本"}]}),(n,e)=>{const o=R;return b(),V(o,{title:"正则提取",description:"使用正则提取文本"},{default:j(()=>[t("div",M,[t("div",O,[t("div",z,[e[6]||(e[6]=t("h3",{class:"text-lg font-bold text-text-primary"},"输入文本",-1)),p(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=l=>y(r)?r.value=l:null),placeholder:"输入要提取的文本...",rows:"10",class:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 resize-none font-mono text-sm"},null,512),[[_,s(r)]]),t("div",D,[t("button",{onClick:k,class:"text-sm text-text-secondary hover:text-primary transition-colors"}," 清空 "),t("span",F,d(s(r).length)+" 字符",1)])]),t("div",N,[e[13]||(e[13]=t("h3",{class:"text-lg font-bold text-text-primary"},"正则表达式",-1)),p(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>y(u)?u.value=l:null),placeholder:"输入正则表达式，例如：(\\\\d{4})",rows:"3",class:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 resize-none font-mono text-sm bg-gray-50"},null,512),[[_,s(u)]]),t("div",P,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-text-primary mb-2"},"标志",-1)),t("div",S,[t("label",q,[p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s(x).global=l),type:"checkbox",class:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[h,s(x).global]]),e[7]||(e[7]=t("span",{class:"text-sm text-text-secondary"},"全局 (g)",-1))]),t("label",H,[p(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s(x).caseInsensitive=l),type:"checkbox",class:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[h,s(x).caseInsensitive]]),e[8]||(e[8]=t("span",{class:"text-sm text-text-secondary"},"忽略大小写 (i)",-1))]),t("label",$,[p(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s(x).multiline=l),type:"checkbox",class:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[h,s(x).multiline]]),e[9]||(e[9]=t("span",{class:"text-sm text-text-secondary"},"多行模式 (m)",-1))])])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-text-primary mb-2"},"提取模式",-1)),p(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>y(c)?c.value=l:null),class:"w-full px-3 py-2 border rounded-lg focus:outline-none"},[...e[11]||(e[11]=[t("option",{value:"match"},"匹配内容",-1),t("option",{value:"group"},"捕获组",-1),t("option",{value:"all"},"所有匹配",-1)])],512),[[B,s(c)]])])]),t("button",{onClick:w,disabled:s(f)||!s(r)||!s(u),class:"w-full py-3 bg-gradient-to-r from-primary to-primary-light text-white rounded-lg font-medium hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed"},d(s(f)?"提取中...":"开始提取"),9,A)])]),s(a)?(b(),v("div",G,[e[19]||(e[19]=t("h3",{class:"text-lg font-bold text-text-primary"},"提取结果",-1)),t("div",J,[t("div",K,[e[14]||(e[14]=t("p",{class:"text-sm text-blue-600 mb-1"},"匹配次数",-1)),t("p",Q,d(s(a).matchCount),1)]),t("div",W,[e[15]||(e[15]=t("p",{class:"text-sm text-green-600 mb-1"},"提取数量",-1)),t("p",X,d(s(a).extractedCount),1)]),t("div",Y,[e[16]||(e[16]=t("p",{class:"text-sm text-purple-600 mb-1"},"组数",-1)),t("p",Z,d(s(a).groups),1)]),t("div",tt,[e[17]||(e[17]=t("p",{class:"text-sm text-orange-600 mb-1"},"状态",-1)),t("p",et,d(s(a).valid?"成功":"失败"),1)])]),t("div",st,[e[18]||(e[18]=t("h4",{class:"font-bold text-text-primary mb-2"},"提取内容",-1)),t("div",lt,[(b(!0),v(E,null,I(s(a).extracted,(l,g)=>(b(),v("div",{key:g,class:"flex items-center gap-2 py-2 border-b border-gray-200 last:border-0"},[t("span",ot,"匹配"+d(g+1),1),t("span",at,d(l),1)]))),128))])]),t("div",{class:"flex gap-2"},[t("button",{onClick:C,class:"flex-1 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition-colors"}," 复制结果 "),t("button",{onClick:U,class:"flex-1 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 transition-colors"}," 下载文件 ")])])):L("",!0)])]),_:1})}}};export{ct as default};
