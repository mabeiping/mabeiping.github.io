import{j as R,w as T,o as n,a as t,b as I,c as r,F as _,p as W,t as u,l as c,q as i,y as j,s as b,d as D,B as J,r as d,x as A}from"./5KiIeb3O.js";import{_ as H}from"./D50zL9At.js";import{G as K}from"./9UHln5xC.js";import{s as Q}from"./CkncbWtC.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";import"./DlAUqK2U.js";const Z={class:"space-y-6"},ee={key:0,class:"bg-gray-50 p-4 rounded-lg"},te={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},le={class:"flex justify-center mb-3"},oe=["src"],se={class:"text-center"},ne={class:"font-medium truncate"},ae={class:"text-sm text-gray-500"},re=["onClick"],ie={key:1,class:"space-y-4"},ue={class:"bg-gray-50 p-4 rounded-lg"},de={class:"space-y-3"},me={key:0,class:"bg-gray-50 p-4 rounded-lg"},ve={class:"space-y-3"},pe={class:"grid grid-cols-2 gap-2"},ge={class:"text-right text-sm text-gray-500"},ce={class:"grid grid-cols-2 gap-2"},be={key:1,class:"bg-gray-50 p-4 rounded-lg"},fe={class:"space-y-3"},ye={key:0},xe={class:"flex justify-center"},ke=["src"],we={class:"text-right text-sm text-gray-500"},he={class:"grid grid-cols-2 gap-2"},Ue={class:"bg-gray-50 p-4 rounded-lg"},Ve={class:"space-y-3"},je={key:0},Ce={class:"text-right text-sm text-gray-500"},Be={class:"flex space-x-4"},Fe=["disabled"],Pe={key:0},ze={key:1,class:"flex items-center justify-center"},_e={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},We={class:"flex items-center justify-between mb-2"},Le={class:"text-blue-700"},Me={class:"w-full bg-gray-200 rounded-full h-2.5"},Se={class:"mt-2 text-sm text-blue-700"},Xe={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ye={class:"mt-2 text-green-700"},$e={class:"mt-3 space-y-2"},Ge=["href","download"],Oe={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},qe={class:"mt-2 text-red-700"},Ee={key:0,class:"mt-2 text-sm text-gray-600"},Ze={__name:"index",setup(Ne){const p=d({type:"text"}),s=d({text:"Watermark",size:30,opacity:30,color:"#000000",position:"bottom-right",marginX:20,marginY:20}),a=d({image:null,opacity:30,position:"bottom-right",marginX:20,marginY:20}),m=d({format:"same",quality:90}),y=d([]),f=A(()=>y.value),U=d(!1),V=d(!1),C=d(""),v=d(""),w=d(""),h=d(0),x=d(""),k=d([]),L=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 选择水印类型：文本水印或图片水印","3. 配置水印参数：根据选择的类型设置相应的参数",'4. 点击"开始添加水印"按钮进行处理',"5. 等待处理完成，下载添加水印后的图片"],F=o=>o.split(".").pop().toLowerCase(),M=o=>{if(o===0)return"0 B";const e=1024,l=["B","KB","MB","GB"],g=Math.floor(Math.log(o)/Math.log(e));return parseFloat((o/Math.pow(e,g)).toFixed(2))+" "+l[g]},S=o=>{const e=o.target.files[0];e&&(a.value.image=URL.createObjectURL(e))},X=o=>{y.value.splice(o,1),y.value.length===0&&z()},Y=o=>{y.value=o,v.value="",V.value=!1},$=o=>{v.value=o,w.value=P(o)},P=o=>o.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":o.includes("文件类型")?"请确保上传的文件格式受支持":o.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",G=()=>new Promise(o=>{let e=0;const l=Q(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),h.value=e,e<30?x.value="正在分析图片...":e<60?x.value="正在准备水印...":e<90?x.value="正在添加水印...":x.value="正在生成结果...",e===100&&(clearInterval(l),setTimeout(o,500))},500)}),O=async()=>{if(f.length===0){v.value="请选择文件";return}if(p.value.type==="text"&&!s.value.text){v.value="请输入水印文本";return}if(p.value.type==="image"&&!a.value.image){v.value="请上传水印图片";return}U.value=!0,v.value="",w.value="",V.value=!1,h.value=0,x.value="准备处理...",k.value=[];try{await G();let o={files:f.value,watermarkOptions:p.value,textWatermark:s.value,imageWatermark:a.value,outputOptions:m.value};console.log("处理参数:",o),C.value=`成功为 ${f.length} 个图片添加水印！`,V.value=!0,f.forEach((e,l)=>{const g=F(e.name),B=m.value.format==="same"?g:m.value.format,q=new Blob(["模拟添加水印后的图片内容"],{type:`image/${B}`}),E=URL.createObjectURL(q),N=`watermarked_${e.name.replace(/\.[^/.]+$/,`.${B}`)}`;k.value.push({url:E,filename:N})}),k.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=k.value[0].url,e.download=k.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(o){v.value=`处理失败：${o.message||"未知错误"}`,w.value=P(v.value)}finally{U.value=!1}},z=()=>{y.value=[],p.value={type:"text"},s.value={text:"Watermark",size:30,opacity:30,color:"#000000",position:"bottom-right",marginX:20,marginY:20},a.value={image:null,opacity:30,position:"bottom-right",marginX:20,marginY:20},m.value={format:"same",quality:90},v.value="",w.value="",V.value=!1,C.value="",h.value=0,x.value="",k.value=[]};return(o,e)=>(n(),R(H,{title:"图片水印添加",description:"为图片添加文字或图片水印，保护版权",tips:L},{default:T(()=>[t("div",Z,[I(K,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":100*1024*1024,modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),onFilesChanged:Y,onError:$},null,8,["modelValue"]),f.value.length>0?(n(),r("div",ee,[e[15]||(e[15]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",te,[(n(!0),r(_,null,W(f.value,(l,g)=>(n(),r("div",{key:g,class:"bg-white rounded border p-3"},[t("div",le,[t("img",{src:o.URL.createObjectURL(l),class:"max-h-32 object-contain",alt:"Preview"},null,8,oe)]),t("div",se,[t("div",ne,u(l.name),1),t("div",ae,u(F(l.name))+" • "+u(M(l.size)),1)]),t("button",{onClick:B=>X(g),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,re)]))),128))])])):c("",!0),f.value.length>0?(n(),r("div",ie,[t("div",ue,[e[18]||(e[18]=t("h3",{class:"text-lg font-semibold mb-3"},"水印类型",-1)),t("div",de,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印类型",-1)),i(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>p.value.type=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[16]||(e[16]=[t("option",{value:"text"},"文本水印",-1),t("option",{value:"image"},"图片水印",-1)])],512),[[j,p.value.type]])])])]),p.value.type==="text"?(n(),r("div",me,[e[27]||(e[27]=t("h3",{class:"text-lg font-semibold mb-3"},"文本水印设置",-1)),t("div",ve,[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印文本",-1)),i(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.text=l),type:"text",placeholder:"请输入水印文本",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[b,s.value.text]])]),t("div",pe,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"字体大小",-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.size=l),type:"number",min:"10",max:"200",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[b,s.value.size,void 0,{number:!0}]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"透明度",-1)),i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.opacity=l),type:"range",min:"0",max:"100",class:"w-full"},null,512),[[b,s.value.opacity,void 0,{number:!0}]]),t("div",ge,u(s.value.opacity)+"%",1)])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"字体颜色",-1)),i(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.value.color=l),type:"color",class:"w-full h-10 border border-gray-300 rounded-md"},null,512),[[b,s.value.color]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印位置",-1)),i(t("select",{"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.position=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[23]||(e[23]=[t("option",{value:"top-left"},"左上角",-1),t("option",{value:"top-right"},"右上角",-1),t("option",{value:"bottom-left"},"左下角",-1),t("option",{value:"bottom-right"},"右下角",-1),t("option",{value:"center"},"居中",-1)])],512),[[j,s.value.position]])]),t("div",ce,[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水平边距",-1)),i(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>s.value.marginX=l),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[b,s.value.marginX,void 0,{number:!0}]])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"垂直边距",-1)),i(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>s.value.marginY=l),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[b,s.value.marginY,void 0,{number:!0}]])])])])])):c("",!0),p.value.type==="image"?(n(),r("div",be,[e[35]||(e[35]=t("h3",{class:"text-lg font-semibold mb-3"},"图片水印设置",-1)),t("div",fe,[t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"上传水印图片",-1)),t("input",{type:"file",accept:".png, .jpg, .jpeg, .webp",onChange:S,class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,32)]),a.value.image?(n(),r("div",ye,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印预览",-1)),t("div",xe,[t("img",{src:a.value.image,class:"max-h-24 object-contain",alt:"Watermark Preview"},null,8,ke)])])):c("",!0),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"透明度",-1)),i(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.opacity=l),type:"range",min:"0",max:"100",class:"w-full"},null,512),[[b,a.value.opacity,void 0,{number:!0}]]),t("div",we,u(a.value.opacity)+"%",1)]),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印位置",-1)),i(t("select",{"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.position=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[31]||(e[31]=[t("option",{value:"top-left"},"左上角",-1),t("option",{value:"top-right"},"右上角",-1),t("option",{value:"bottom-left"},"左下角",-1),t("option",{value:"bottom-right"},"右下角",-1),t("option",{value:"center"},"居中",-1)])],512),[[j,a.value.position]])]),t("div",he,[t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水平边距",-1)),i(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>a.value.marginX=l),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[b,a.value.marginX,void 0,{number:!0}]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"垂直边距",-1)),i(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>a.value.marginY=l),type:"number",min:"0",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[b,a.value.marginY,void 0,{number:!0}]])])])])])):c("",!0),t("div",Ue,[e[39]||(e[39]=t("h3",{class:"text-lg font-semibold mb-3"},"输出设置",-1)),t("div",Ve,[t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),i(t("select",{"onUpdate:modelValue":e[13]||(e[13]=l=>m.value.format=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[36]||(e[36]=[t("option",{value:"same"},"保持原格式",-1),t("option",{value:"png"},"PNG",-1),t("option",{value:"jpg"},"JPG",-1),t("option",{value:"webp"},"WebP",-1)])],512),[[j,m.value.format]])]),m.value.format==="jpg"||m.value.format==="webp"?(n(),r("div",je,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出质量",-1)),i(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>m.value.quality=l),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[b,m.value.quality,void 0,{number:!0}]]),t("div",Ce,u(m.value.quality)+"%",1)])):c("",!0)])])])):c("",!0),t("div",Be,[t("button",{onClick:O,disabled:!f.value.length||U.value||p.value.type==="text"&&!s.value.text||p.value.type==="image"&&!a.value.image,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[U.value?(n(),r("span",ze,[e[40]||(e[40]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),D(" 处理中... "+u(h.value)+"% ",1)])):(n(),r("span",Pe,"开始添加水印"))],8,Fe),t("button",{onClick:z,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),U.value?(n(),r("div",_e,[t("div",We,[e[41]||(e[41]=t("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),t("span",Le,u(h.value)+"%",1)]),t("div",Me,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:J({width:h.value+"%"})},null,4)]),t("p",Se,u(x.value),1)])):c("",!0),V.value?(n(),r("div",Xe,[e[42]||(e[42]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),t("p",Ye,u(C.value),1),t("div",$e,[(n(!0),r(_,null,W(k.value,(l,g)=>(n(),r("a",{key:g,href:l.url,download:l.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载水印结果 "+u(g+1),9,Ge))),128))])])):c("",!0),v.value?(n(),r("div",Oe,[e[43]||(e[43]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),t("p",qe,u(v.value),1),w.value?(n(),r("p",Ee,"建议："+u(w.value),1)):c("",!0)])):c("",!0)])]),_:1}))}};export{Ze as default};
