import{j as e,w as l,o as a,a as s,b as t,c as o,F as n,p as r,t as u,l as i,q as c,v as d,C as v,d as p,B as m,r as x,x as h}from"./CU9sc1yl.js";import{_ as g}from"./KU0exf4c.js";import{G as b}from"./CwQEddwr.js";import{s as f}from"./Uj4zMvJp.js";import"./BaOdEBWl.js";import"./ByWfkjdR.js";import"./CIUYv0cq.js";import"./DKwMAC3i.js";import"./BCo6x5W8.js";const y={class:"space-y-6"},w={key:0,class:"bg-gray-50 p-4 rounded-lg"},k={class:"space-y-2"},C={class:"flex items-center"},j={class:"font-medium"},V={class:"text-sm text-gray-500"},M=["onClick"],B={key:1,class:"bg-gray-50 p-4 rounded-lg"},E={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},F=["value"],z={class:"font-medium"},H={class:"text-sm text-gray-500"},U={key:2,class:"space-y-4"},$={class:"space-y-2"},L={class:"flex items-center space-x-2"},S={class:"flex items-center space-x-2"},_={class:"flex items-center space-x-2"},O={class:"flex space-x-4"},J=["disabled"],N={key:0},A={key:1,class:"flex items-center justify-center"},G={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},R={class:"flex items-center justify-between mb-2"},T={class:"text-blue-700"},q={class:"w-full bg-gray-200 rounded-full h-2.5"},I={class:"mt-2 text-sm text-blue-700"},K={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},P={class:"mt-2 text-green-700"},Y={class:"mt-3 space-y-2"},Z=["href","download"],D={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Q={class:"mt-2 text-red-700"},W={key:0,class:"mt-2 text-sm text-gray-600"},X={__name:"index",setup(X){const ee=[{value:"xlsx",label:"Excel (.xlsx)",description:"适合复杂表格和公式",extensions:[".xlsx",".xls"]},{value:"csv",label:"CSV (.csv)",description:"逗号分隔值，通用格式",extensions:[".csv"]},{value:"json",label:"JSON (.json)",description:"适合数据交换和编程",extensions:[".json"]}],le=x(""),ae=x({includeHeaders:!0,preserveFormatting:!0,handleEmptyCells:!0}),se=x([]),te=h(()=>se.value),oe=x(!1),ne=x(!1),re=x(""),ue=x(""),ie=x(""),ce=x(0),de=x(""),ve=x([]),pe=x([]),me=["1. 上传文件：支持Excel、CSV和JSON格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含表头、保留格式、处理空单元格",'5. 点击"开始转换"按钮进行处理',"6. 等待转换完成，系统会自动下载转换后的文件","7. 查看转换结果，确保数据的完整性和准确性"],xe=e=>e.split(".").pop().toLowerCase(),he=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},ge=e=>{se.value=e,e.length>0?be():(pe.value=[],le.value=""),ue.value="",ne.value=!1},be=()=>{if(0===se.value.length)return void(pe.value=[]);const e=xe(se.value[0].name),l=[];ee.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))||l.push(a)}),pe.value=l,l.length>0?le.value=l[0].value:le.value=""},fe=e=>{ue.value=e,ie.value=ye(e)},ye=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",we=async()=>{if(0!==te.length)if(le.value){oe.value=!0,ue.value="",ie.value="",ne.value=!1,ce.value=0,de.value="准备转换...",ve.value=[];try{await new Promise(e=>{let l=0;const a=f(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),ce.value=l,de.value=l<30?"正在分析文件...":l<70?"正在转换文件...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});te.value,le.value,ae.value;const e=ee.find(e=>e.value===le.value);re.value=`成功将 ${te.length} 个文件转换为 ${e.label} 格式！`,ne.value=!0,te.forEach((e,l)=>{const a=new Blob(["模拟转换后的文件内容"],{type:"application/octet-stream"}),s=URL.createObjectURL(a),t=`converted_${e.name.replace(/\.[^/.]+$/,`.${le.value}`)}`;ve.value.push({url:s,filename:t})}),ve.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=ve.value[0].url,e.download=ve.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){ue.value=`转换失败：${e.message||"未知错误"}`,ie.value=ye(ue.value)}finally{oe.value=!1}}else ue.value="请选择目标格式";else ue.value="请选择文件"},ke=()=>{se.value=[],le.value="",ae.value={includeHeaders:!0,preserveFormatting:!0,handleEmptyCells:!0},ue.value="",ie.value="",ne.value=!1,re.value="",ce.value=0,de.value="",ve.value=[],pe.value=[]};return(x,h)=>(a(),e(g,{title:"Excel表格格式转换",description:"支持xls/xlsx/CSV/JSON等格式的互转",tips:me},{default:l(()=>[s("div",y,[t(b,{multiple:!0,accept:[".xls",".xlsx",".csv",".json"],"max-size":104857600,modelValue:se.value,"onUpdate:modelValue":h[0]||(h[0]=e=>se.value=e),onFilesChanged:ge,onError:fe},null,8,["modelValue"]),te.value.length>0?(a(),o("div",w,[h[7]||(h[7]=s("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),s("div",k,[(a(!0),o(n,null,r(te.value,(e,l)=>(a(),o("div",{key:l,class:"flex items-center justify-between p-2 bg-white rounded border"},[s("div",C,[h[5]||(h[5]=s("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),s("div",null,[s("div",j,u(e.name),1),s("div",V,u(xe(e.name))+" • "+u(he(e.size)),1)])]),s("button",{onClick:e=>(e=>{se.value.splice(e,1),0===se.value.length?ke():be()})(l),class:"text-red-500 hover:text-red-700"},[...h[6]||(h[6]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,M)]))),128))])])):i("",!0),te.value.length>0&&pe.value.length>0?(a(),o("div",B,[h[8]||(h[8]=s("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),s("div",E,[(a(!0),o(n,null,r(pe.value,e=>(a(),o("label",{key:e.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[c(s("input",{type:"radio","onUpdate:modelValue":h[1]||(h[1]=e=>le.value=e),value:e.value,class:"w-4 h-4 text-blue-600"},null,8,F),[[d,le.value]]),s("div",null,[s("div",z,u(e.label),1),s("div",H,u(e.description),1)])]))),128))])])):i("",!0),te.value.length>0?(a(),o("div",U,[s("div",null,[h[12]||(h[12]=s("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),s("div",$,[s("label",L,[c(s("input",{type:"checkbox","onUpdate:modelValue":h[2]||(h[2]=e=>ae.value.includeHeaders=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ae.value.includeHeaders]]),h[9]||(h[9]=s("span",null,"包含表头",-1))]),s("label",S,[c(s("input",{type:"checkbox","onUpdate:modelValue":h[3]||(h[3]=e=>ae.value.preserveFormatting=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ae.value.preserveFormatting]]),h[10]||(h[10]=s("span",null,"保留格式",-1))]),s("label",_,[c(s("input",{type:"checkbox","onUpdate:modelValue":h[4]||(h[4]=e=>ae.value.handleEmptyCells=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ae.value.handleEmptyCells]]),h[11]||(h[11]=s("span",null,"处理空单元格",-1))])])])])):i("",!0),s("div",O,[s("button",{onClick:we,disabled:!te.value.length||!le.value||oe.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[oe.value?(a(),o("span",A,[h[13]||(h[13]=s("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),p(" 处理中... "+u(ce.value)+"% ",1)])):(a(),o("span",N,"开始转换"))],8,J),s("button",{onClick:ke,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),oe.value?(a(),o("div",G,[s("div",R,[h[14]||(h[14]=s("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),s("span",T,u(ce.value)+"%",1)]),s("div",q,[s("div",{class:"bg-blue-600 h-2.5 rounded-full",style:m({width:ce.value+"%"})},null,4)]),s("p",I,u(de.value),1)])):i("",!0),ne.value?(a(),o("div",K,[h[15]||(h[15]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",P,u(re.value),1),s("div",Y,[(a(!0),o(n,null,r(ve.value,(e,l)=>(a(),o("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+u(l+1),9,Z))),128))])])):i("",!0),ue.value?(a(),o("div",D,[h[16]||(h[16]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",Q,u(ue.value),1),ie.value?(a(),o("p",W,"建议："+u(ie.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{X as default};
