import{j as q,w as W,o as n,a as s,b as J,c as a,F as z,p as E,t as i,l as p,q as b,v as F,C as S,s as Q,d as X,B as Y,r,x as j}from"./5KiIeb3O.js";import{_ as Z}from"./D50zL9At.js";import{G as ee}from"./9UHln5xC.js";import{s as se}from"./CkncbWtC.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";import"./DlAUqK2U.js";const te={class:"space-y-6"},le={key:0,class:"bg-gray-50 p-4 rounded-lg"},oe={class:"space-y-2"},ne={class:"flex items-center"},ae={class:"font-medium"},re={class:"text-sm text-gray-500"},ie=["onClick"],ue={key:1,class:"bg-gray-50 p-4 rounded-lg"},de={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},ce=["value"],ve={class:"font-medium"},pe={class:"text-sm text-gray-500"},me={key:2,class:"space-y-4"},xe={class:"space-y-2"},ge={class:"flex items-center space-x-2"},be={class:"flex items-center space-x-2"},fe={class:"flex items-center space-x-2"},he={class:"space-y-2"},ye={class:"flex items-center space-x-2"},ke={class:"flex items-center space-x-2"},we={key:0},_e={class:"flex space-x-4"},Ce=["disabled"],Fe={key:0},Ve={key:1,class:"flex items-center justify-center"},Be={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Me={class:"flex items-center justify-between mb-2"},ze={class:"text-blue-700"},Ee={class:"w-full bg-gray-200 rounded-full h-2.5"},je={class:"mt-2 text-sm text-blue-700"},Ie={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ue={class:"mt-2 text-green-700"},Pe={class:"mt-3 space-y-2"},Te=["href","download"],Se={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},$e={class:"mt-2 text-red-700"},Le={key:0,class:"mt-2 text-sm text-gray-600"},Je={__name:"convert",setup(Ae){const C={document:[{value:"docx",label:"Word (.docx)",description:"适合编辑文本内容",extensions:[".docx",".doc"]},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印",extensions:[".pdf"]},{value:"txt",label:"文本 (.txt)",description:"纯文本格式",extensions:[".txt"]},{value:"pages",label:"Pages (.pages)",description:"Apple Pages文档",extensions:[".pages"]}],spreadsheet:[{value:"xlsx",label:"Excel (.xlsx)",description:"适合处理表格数据",extensions:[".xlsx",".xls"]},{value:"csv",label:"CSV (.csv)",description:"逗号分隔值",extensions:[".csv"]},{value:"numbers",label:"Numbers (.numbers)",description:"Apple Numbers表格",extensions:[".numbers"]}],presentation:[{value:"pptx",label:"PPT (.pptx)",description:"适合演示文稿",extensions:[".pptx",".ppt"]},{value:"key",label:"Keynote (.key)",description:"Apple Keynote演示文稿",extensions:[".key"]}]},$=j(()=>{const l=[];return Object.values(C).forEach(e=>{e.forEach(t=>{l.push(...t.extensions)})}),l.join(",")}),u=r(""),m=r("normal"),k=r({includeImages:!0,optimizeImages:!1}),V=r(""),v=r([]),d=j(()=>v.value),w=r(!1),_=r(!1),B=r(""),c=r(""),f=r(""),h=r(0),y=r(""),x=r([]),g=r([]),L=j(()=>{if(d.length===0)return!1;const l=M(d[0].name);return["docx","pdf","txt","pages"].includes(l)}),A=["1. 上传文件：支持多种办公文件格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 选择转换模式：标准转换、保留布局或仅提取文本","5. 设置图片处理选项（可选）",'6. 点击"开始转换"按钮进行处理',"7. 等待转换完成，系统会自动下载转换后的文件","8. 查看转换结果，确保内容和格式的准确性"],M=l=>l.split(".").pop().toLowerCase(),N=l=>{if(l===0)return"0 B";const e=1024,t=["B","KB","MB","GB"],o=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,o)).toFixed(2))+" "+t[o]},D=l=>{v.value.splice(l,1),v.value.length===0?P():I()},R=l=>{v.value=l,l.length>0?I():(g.value=[],u.value=""),c.value="",_.value=!1},I=()=>{if(v.value.length===0){g.value=[];return}const l=M(v.value[0].name),e=[];["docx","doc","pdf","txt","pages"].includes(l)?C.document.forEach(t=>{t.extensions.some(o=>l===o.replace(".",""))||e.push(t)}):["xlsx","xls","csv","numbers"].includes(l)?C.spreadsheet.forEach(t=>{t.extensions.some(o=>l===o.replace(".",""))||e.push(t)}):["pptx","ppt","key"].includes(l)&&C.presentation.forEach(t=>{t.extensions.some(o=>l===o.replace(".",""))||e.push(t)}),g.value=e,e.length>0?u.value=e[0].value:u.value=""},G=l=>{c.value=l,f.value=U(l)},U=l=>l.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":l.includes("文件类型")?"请确保上传的文件格式受支持":l.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",H=()=>new Promise(l=>{let e=0;const t=se(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),h.value=e,e<30?y.value="正在分析文件...":e<70?y.value="正在转换文件...":y.value="正在生成结果...",e===100&&(clearInterval(t),setTimeout(l,500))},500)}),K=async()=>{if(d.length===0){c.value="请选择文件";return}if(!u.value){c.value="请选择目标格式";return}w.value=!0,c.value="",f.value="",_.value=!1,h.value=0,y.value="准备转换...",x.value=[];try{await H();const l=g.value.find(e=>e.value===u.value);B.value=`成功将 ${d.length} 个文件转换为 ${l.label} 格式！`,_.value=!0,d.forEach((e,t)=>{const o=new Blob(["模拟转换后的文件内容"],{type:"application/octet-stream"}),T=URL.createObjectURL(o),O=`converted_${e.name.replace(/\.[^/.]+$/,`.${u.value}`)}`;x.value.push({url:T,filename:O})}),x.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=x.value[0].url,e.download=x.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(l){c.value=`转换失败：${l.message||"未知错误"}`,f.value=U(c.value)}finally{w.value=!1}},P=()=>{v.value=[],u.value="",m.value="normal",k.value={includeImages:!0,optimizeImages:!1},V.value="",c.value="",f.value="",_.value=!1,B.value="",h.value=0,y.value="",x.value=[],g.value=[]};return(l,e)=>(n(),q(Z,{title:"办公文件格式转换",description:"支持多种办公文件格式的双向转换，包括文档、表格和演示文稿",tips:A},{default:W(()=>[s("div",te,[J(ee,{multiple:!0,accept:$.value,"max-size":100*1024*1024,modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),onFilesChanged:R,onError:G},null,8,["accept","modelValue"]),d.value.length>0?(n(),a("div",le,[e[10]||(e[10]=s("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),s("div",oe,[(n(!0),a(z,null,E(d.value,(t,o)=>(n(),a("div",{key:o,class:"flex items-center justify-between p-2 bg-white rounded border"},[s("div",ne,[e[8]||(e[8]=s("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),s("div",null,[s("div",ae,i(t.name),1),s("div",re,i(M(t.name))+" • "+i(N(t.size)),1)])]),s("button",{onClick:T=>D(o),class:"text-red-500 hover:text-red-700"},[...e[9]||(e[9]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ie)]))),128))])])):p("",!0),d.value.length>0&&g.value.length>0?(n(),a("div",ue,[e[11]||(e[11]=s("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),s("div",de,[(n(!0),a(z,null,E(g.value,t=>(n(),a("label",{key:t.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[b(s("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=o=>u.value=o),value:t.value,class:"w-4 h-4 text-blue-600"},null,8,ce),[[F,u.value]]),s("div",null,[s("div",ve,i(t.label),1),s("div",pe,i(t.description),1)])]))),128))])])):p("",!0),d.value.length>0?(n(),a("div",me,[s("div",null,[e[15]||(e[15]=s("h3",{class:"text-lg font-semibold mb-2"},"转换模式",-1)),s("div",xe,[s("label",ge,[b(s("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),value:"normal",class:"w-4 h-4 text-blue-600"},null,512),[[F,m.value]]),e[12]||(e[12]=s("span",null,"标准转换",-1))]),s("label",be,[b(s("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=t=>m.value=t),value:"layout",class:"w-4 h-4 text-blue-600"},null,512),[[F,m.value]]),e[13]||(e[13]=s("span",null,"保留布局",-1))]),s("label",fe,[b(s("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=t=>m.value=t),value:"text",class:"w-4 h-4 text-blue-600"},null,512),[[F,m.value]]),e[14]||(e[14]=s("span",null,"仅提取文本",-1))])])]),s("div",null,[e[18]||(e[18]=s("h3",{class:"text-lg font-semibold mb-2"},"图片处理",-1)),s("div",he,[s("label",ye,[b(s("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=t=>k.value.includeImages=t),class:"w-4 h-4 text-blue-600"},null,512),[[S,k.value.includeImages]]),e[16]||(e[16]=s("span",null,"包含图片",-1))]),s("label",ke,[b(s("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=t=>k.value.optimizeImages=t),class:"w-4 h-4 text-blue-600"},null,512),[[S,k.value.optimizeImages]]),e[17]||(e[17]=s("span",null,"优化图片大小",-1))])])]),L.value?(n(),a("div",we,[e[19]||(e[19]=s("h3",{class:"text-lg font-semibold mb-2"},"页面范围",-1)),b(s("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>V.value=t),type:"text",placeholder:"例如：1-5, 7, 9-12（留空表示全部）",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Q,V.value]]),e[20]||(e[20]=s("p",{class:"text-sm text-gray-500 mt-1"},"支持逗号分隔的页码和页码范围，如：1-5, 7, 9-12",-1))])):p("",!0)])):p("",!0),s("div",_e,[s("button",{onClick:K,disabled:!d.value.length||!u.value||w.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[w.value?(n(),a("span",Ve,[e[21]||(e[21]=s("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),X(" 处理中... "+i(h.value)+"% ",1)])):(n(),a("span",Fe,"开始转换"))],8,Ce),s("button",{onClick:P,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),w.value?(n(),a("div",Be,[s("div",Me,[e[22]||(e[22]=s("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),s("span",ze,i(h.value)+"%",1)]),s("div",Ee,[s("div",{class:"bg-blue-600 h-2.5 rounded-full",style:Y({width:h.value+"%"})},null,4)]),s("p",je,i(y.value),1)])):p("",!0),_.value?(n(),a("div",Ie,[e[23]||(e[23]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",Ue,i(B.value),1),s("div",Pe,[(n(!0),a(z,null,E(x.value,(t,o)=>(n(),a("a",{key:o,href:t.url,download:t.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+i(o+1),9,Te))),128))])])):p("",!0),c.value?(n(),a("div",Se,[e[24]||(e[24]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",$e,i(c.value),1),f.value?(n(),a("p",Le,"建议："+i(f.value),1)):p("",!0)])):p("",!0)])]),_:1}))}};export{Je as default};
