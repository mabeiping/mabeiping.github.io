const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CCxQXCRZ.js","./CONUlYrd.js","./entry.Df9dSrAs.css"])))=>i.map(i=>d[i]);
import{l as Ce,y as Se,e as $e,h as x,f as Fe,c as l,b as D,a as e,i as y,t as d,u as o,n as g,F,g as M,p as f,s as j,x as E,v as T,z as Me,B as Ve,d as q,j as U,k as G,A as L,o as a,C as je}from"./CONUlYrd.js";import{_ as Ee,a as Te,b as ze}from"./Bu46YPbD.js";import{c as Be,d as Ne,g as W,b as De}from"./D-FQcWls.js";import{u as Ue}from"./8Q1XjmlR.js";import"./Df9yIBho.js";const Le={class:"min-h-screen bg-background"},Oe={class:"flex pt-nav-height"},He={class:"flex-1 lg:ml-sidebar-left overflow-y-auto"},Ie={class:"max-w-full px-4 py-6"},Pe={class:"mb-6"},Re={class:"flex items-center justify-between mb-2"},Ae={class:"flex items-center gap-2"},Je={class:"text-2xl font-bold text-text-primary"},qe={class:"px-3 py-1 bg-primary/10 text-primary text-sm rounded-full"},Ge={class:"relative export-button-container"},We=["disabled"],Xe={key:0,class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},Ke={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ye={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 z-50 overflow-hidden"},Qe={class:"py-1"},Ze=["onClick","disabled"],et={class:"flex-1"},tt={class:"text-sm font-medium text-text-primary group-hover:text-primary transition-colors"},ot={class:"text-xs text-text-secondary"},st={class:"flex flex-col lg:flex-row gap-6"},nt={class:"w-full lg:w-1/3 space-y-4"},rt={class:"bg-white rounded-xl shadow-sm p-6"},lt={class:"space-y-4"},at={key:0,class:"text-red-500"},it=["onUpdate:modelValue","type","placeholder","onInput"],dt=["onUpdate:modelValue","onChange"],ct={value:""},ut=["value"],pt=["onUpdate:modelValue","onInput"],mt=["onUpdate:modelValue","placeholder","onInput"],xt=["onUpdate:modelValue","placeholder","onInput"],vt={key:5,class:"text-xs text-red-500"},yt={class:"bg-white rounded-xl shadow-sm p-6"},gt={class:"space-y-4"},ht={class:"space-y-1"},ft={class:"space-y-1"},bt={class:"space-y-1"},wt={class:"flex items-center gap-2"},_t={class:"text-sm text-text-secondary"},kt={class:"space-y-1"},Ct={class:"w-full lg:w-2/3"},St={class:"bg-white rounded-xl shadow-sm overflow-hidden"},$t={class:"flex items-center justify-between p-4 border-b border-gray-200"},Ft={class:"flex items-center gap-2"},Mt={class:"text-sm text-text-secondary w-16 text-center"},Vt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},jt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Et={class:"max-w-[800px] mx-auto bg-white border border-gray-200 p-8 shadow-sm"},Tt={key:0,class:"space-y-4"},zt={class:"text-2xl font-bold text-center mb-6"},Bt={class:"space-y-3"},Nt={key:0,class:"flex"},Dt={key:1,class:"flex"},Ut={key:2,class:"mt-4"},Lt={class:"mt-2 whitespace-pre-wrap"},Ot={key:1,class:"space-y-4"},Ht={class:"text-2xl font-bold text-center mb-6"},It={class:"w-full border-collapse border border-gray-300"},Pt={class:"border border-gray-300 px-4 py-2"},Rt={class:"border border-gray-300 px-4 py-2"},At={class:"border border-gray-300 px-4 py-2"},Jt={class:"border border-gray-300 px-4 py-2"},qt={key:2,class:"space-y-4"},Gt={class:"text-3xl font-bold text-center mb-8"},Wt={class:"space-y-6"},Xt={key:0,class:"text-center text-xl"},Kt={key:1,class:"whitespace-pre-wrap"},Yt={key:2,class:"text-right text-text-secondary"},Qt={key:3,class:"text-center text-text-secondary py-12"},Zt={class:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden"},eo={class:"bg-gradient-to-r from-primary to-primary-light p-6"},to={class:"mt-4 flex items-center justify-center gap-2"},oo={class:"px-3 py-1 bg-white/20 rounded-full text-sm text-white"},so={class:"p-6 space-y-4"},no={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24"},ro={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},lo={class:"pt-4 border-t border-gray-200"},ao={class:"space-y-2"},io=["href"],co={class:"flex-1"},uo={class:"text-sm font-medium text-text-primary group-hover:text-primary transition-colors"},po={class:"text-xs text-text-secondary"},fo={__name:"[id]",setup(mo){const X=Ce();Se();const _=U(()=>parseInt(X.params.id)),m=x(null),S=x([]),r=x({}),v=x({}),u=x({fontFamily:"SimSun",fontSize:"16",color:"#000000",lineHeight:"1.5"}),O=x({}),b=x(1),V=x(!1),w=x(!1),z=x(!1),k=x(!1),C=x(!1),H=x("docx"),I=[{value:"docx",name:"Word 文档",ext:"DOCX",desc:"Microsoft Word 格式",bgColor:"bg-blue-100",textColor:"text-blue-600"},{value:"doc",name:"Word 文档",ext:"DOC",desc:"旧版 Word 格式",bgColor:"bg-blue-100",textColor:"text-blue-600"},{value:"pdf",name:"PDF 文档",ext:"PDF",desc:"便携式文档格式",bgColor:"bg-red-100",textColor:"text-red-600"},{value:"png",name:"PNG 图片",ext:"PNG",desc:"高清图片格式",bgColor:"bg-green-100",textColor:"text-green-600"},{value:"jpg",name:"JPG 图片",ext:"JPG",desc:"压缩图片格式",bgColor:"bg-yellow-100",textColor:"text-yellow-600"}],K=De(),Y=U(()=>m.value?K.filter(n=>n.type===m.value.type&&n.id!==m.value.id).slice(0,3):[]),Q=()=>{m.value=Be(_.value),m.value&&(S.value=Ne(m.value.type)||[],r.value={},S.value.forEach(n=>{r.value[n.id]=""}))},$=n=>{const t=S.value.find(c=>c.id===n);t&&(t.required&&!r.value[n]?.trim()?v.value[n]="此项必填":t.type==="number"&&r.value[n]&&isNaN(r.value[n])?v.value[n]="请输入有效数字":delete v.value[n])},Z=()=>{let n=!0;return S.value.forEach(t=>{t.required&&($(t.id),v.value[t.id]&&(n=!1))}),n},ee=()=>{r.value={},S.value.forEach(n=>{r.value[n.id]=""}),v.value={}},te=()=>{sessionStorage.setItem(`templateStyle_${_.value}`,JSON.stringify(u.value))},oe=()=>{u.value={...O.value}},se=()=>{{const n=sessionStorage.getItem(`templateStyle_${_.value}`);if(n)try{u.value=JSON.parse(n)}catch(t){console.error("Failed to load style:",t)}}},ne=()=>{b.value<2&&(b.value=Math.min(2,b.value+.1))},re=()=>{b.value>.5&&(b.value=Math.max(.5,b.value-.1))},le=()=>{V.value=!V.value},ae=()=>{k.value=!k.value},P=async(n="docx")=>{if(Z()){H.value=n,k.value=!1,w.value=!0;try{const t=`${m.value?.name||"模板"}_${new Date().getTime()}`;n==="docx"||n==="doc"?await ie(t,n):n==="pdf"?await de(t):(n==="png"||n==="jpg")&&await ce(t,n),console.log("文件已下载:",t)}catch(t){console.error("Export failed:",t),alert("下载失败，请重试")}finally{w.value=!1}}},ie=async(n,t)=>{const{Document:c,Packer:p,Paragraph:h,TextRun:s,HeadingLevel:i,AlignmentType:B,BorderStyle:J}=await L(async()=>{const{Document:ge,Packer:he,Paragraph:fe,TextRun:be,HeadingLevel:we,AlignmentType:_e,BorderStyle:ke}=await import("./xLdiIeLa.js");return{Document:ge,Packer:he,Paragraph:fe,TextRun:be,HeadingLevel:we,AlignmentType:_e,BorderStyle:ke}},[],import.meta.url),N=new c({sections:[{properties:{},children:[new h({text:r.value.title||"文档标题",heading:i.HEADING_1,alignment:B.CENTER,spacing:{after:400}}),new h({children:[new s({text:`公司名称：${r.value.companyName||""}`,bold:!0})],spacing:{after:200}}),new h({children:[new s({text:`日期：${r.value.date||""}`,bold:!0})],spacing:{after:200}}),new h({text:"内容：",heading:i.HEADING_2,spacing:{before:400,after:200}}),new h({text:r.value.content||"",spacing:{after:400}})]}]}),ye=await p.toBlob(N);ue(ye,`${n}.${t}`)},de=async n=>{const{jsPDF:t}=await L(async()=>{const{jsPDF:J}=await import("./CCxQXCRZ.js").then(N=>N.j);return{jsPDF:J}},__vite__mapDeps([0,1,2]),import.meta.url),c=new t,p=r.value.title||"文档标题",h=r.value.companyName||"",s=r.value.date||"",i=r.value.content||"";c.setFontSize(20),c.text(p,105,20,{align:"center"}),c.setFontSize(12),c.text(`公司名称：${h}`,20,40),c.text(`日期：${s}`,20,50),c.setFontSize(14),c.text("内容：",20,70),c.setFontSize(12);const B=c.splitTextToSize(i,170,12);c.text(B,20,80),c.save(`${n}.pdf`)},ce=async(n,t)=>{const c=await L(()=>import("./DXEQVQnt.js"),[],import.meta.url),p=document.querySelector(".preview-content");if(!p)throw new Error("预览元素未找到");const s=(await c.default(p,{scale:2,useCORS:!0,logging:!1})).toDataURL(`image/${t}`,.95),i=document.createElement("a");i.href=s,i.download=`${n}.${t}`,document.body.appendChild(i),i.click(),document.body.removeChild(i)},ue=(n,t)=>{const c=URL.createObjectURL(n),p=document.createElement("a");p.href=c,p.download=t,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(c)},pe=()=>{z.value=!1,P()},R=()=>{z.value=!1,G("/templates")},me=()=>{C.value=!C.value;{let n=[];try{n=JSON.parse(localStorage.getItem("favoriteTemplates")||"[]")}catch(t){console.error("Failed to load favorites:",t)}C.value?n.includes(_.value)||n.push(_.value):n=n.filter(t=>t!==_.value),localStorage.setItem("favoriteTemplates",JSON.stringify(n))}},xe=()=>{try{const n=JSON.parse(localStorage.getItem("favoriteTemplates")||"[]");C.value=n.includes(_.value)}catch(n){console.error("Failed to check favorite:",n)}},ve=()=>{G("/templates")},A=n=>{!n.target.closest(".export-button-container")&&k.value&&(k.value=!1)};return $e(()=>{O.value={...u.value},Q(),se(),xe(),document.addEventListener("click",A)}),Fe(()=>{document.removeEventListener("click",A)}),Ue({title:U(()=>`${m.value?.name||"模板详情"} - Office Tools`),meta:[{name:"description",content:"填写信息并自定义格式，一键生成专业文档"}]}),(n,t)=>{const c=Ee,p=Te,h=ze;return a(),l("div",Le,[D(c),e("div",Oe,[D(p),e("main",He,[e("div",Ie,[e("div",Pe,[e("div",Re,[e("div",Ae,[e("button",{onClick:ve,class:"text-text-secondary hover:text-primary transition-colors"},[...t[4]||(t[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e("h1",Je,d(o(m)?.name||"模板详情"),1),e("span",qe,d(o(W)(o(m)?.type)),1)]),e("div",Ge,[e("button",{onClick:ae,disabled:o(w),class:g(["flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-200",o(w)?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-primary to-primary-light text-white hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]"])},[o(w)?(a(),l("svg",Xe,[...t[5]||(t[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(a(),l("svg",Ke,[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])])),e("span",null,d(o(w)?"下载中...":"下载"),1),o(w)?y("",!0):(a(),l("svg",{key:2,class:g(["w-4 h-4 transition-transform duration-200",{"rotate-180":o(k)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[7]||(t[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],10,We),o(k)?(a(),l("div",Ye,[e("div",Qe,[(a(),l(F,null,M(I,s=>e("button",{key:s.value,onClick:i=>P(s.value),disabled:o(w),class:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors flex items-center gap-3 group"},[e("span",{class:g(["w-8 h-8 rounded-lg flex items-center justify-center",s.bgColor])},[e("span",{class:g(["text-xs font-bold",s.textColor])},d(s.ext),3)],2),e("div",et,[e("p",tt,d(s.name),1),e("p",ot,d(s.desc),1)])],8,Ze)),64))])])):y("",!0)])]),t[8]||(t[8]=e("p",{class:"text-text-secondary text-sm"},"填写信息并自定义格式，一键生成专业文档",-1))]),e("div",st,[e("div",nt,[e("div",rt,[e("div",{class:"flex items-center justify-between mb-4"},[t[9]||(t[9]=e("h2",{class:"text-lg font-bold text-text-primary"},"填写信息",-1)),e("button",{onClick:ee,class:"text-sm text-text-secondary hover:text-primary transition-colors"}," 重置 ")]),e("div",lt,[(a(!0),l(F,null,M(o(S),s=>(a(),l("div",{key:s.id,class:"space-y-1"},[e("label",{class:g(["text-sm font-medium",s.required?"text-text-primary":"text-text-secondary"])},[q(d(s.label)+" ",1),s.required?(a(),l("span",at,"*")):y("",!0)],2),s.type==="text"?f((a(),l("input",{key:0,"onUpdate:modelValue":i=>o(r)[s.id]=i,type:s.inputType||"text",placeholder:s.placeholder,class:g(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(v)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:i=>$(s.id)},null,42,it)),[[je,o(r)[s.id]]]):s.type==="select"?f((a(),l("select",{key:1,"onUpdate:modelValue":i=>o(r)[s.id]=i,class:g(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(v)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onChange:i=>$(s.id)},[e("option",ct,d(s.placeholder),1),(a(!0),l(F,null,M(s.options,i=>(a(),l("option",{key:i,value:i},d(i),9,ut))),128))],42,dt)),[[j,o(r)[s.id]]]):s.type==="date"?f((a(),l("input",{key:2,"onUpdate:modelValue":i=>o(r)[s.id]=i,type:"date",class:g(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(v)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:i=>$(s.id)},null,42,pt)),[[T,o(r)[s.id]]]):s.type==="number"?f((a(),l("input",{key:3,"onUpdate:modelValue":i=>o(r)[s.id]=i,type:"number",placeholder:s.placeholder,class:g(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(v)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:i=>$(s.id)},null,42,mt)),[[T,o(r)[s.id],void 0,{number:!0}]]):s.type==="textarea"?f((a(),l("textarea",{key:4,"onUpdate:modelValue":i=>o(r)[s.id]=i,placeholder:s.placeholder,rows:"3",class:g(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(v)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:i=>$(s.id)},null,42,xt)),[[T,o(r)[s.id]]]):y("",!0),o(v)[s.id]?(a(),l("p",vt,d(o(v)[s.id]),1)):y("",!0)]))),128))])]),e("div",yt,[e("div",{class:"flex items-center justify-between mb-4"},[t[10]||(t[10]=e("h2",{class:"text-lg font-bold text-text-primary"},"格式设置",-1)),e("div",{class:"flex gap-2"},[e("button",{onClick:te,class:"text-sm text-text-secondary hover:text-primary transition-colors"}," 保存 "),e("button",{onClick:oe,class:"text-sm text-text-secondary hover:text-primary transition-colors"}," 恢复默认 ")])]),e("div",gt,[e("div",ht,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-text-secondary"},"字体",-1)),f(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o(u).fontFamily=s),class:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"},[...t[11]||(t[11]=[E('<option value="SimSun">宋体</option><option value="SimHei">黑体</option><option value="Microsoft YaHei">微软雅黑</option><option value="KaiTi">楷体</option><option value="FangSong">仿宋</option>',5)])],512),[[j,o(u).fontFamily]])]),e("div",ft,[t[14]||(t[14]=e("label",{class:"text-sm font-medium text-text-secondary"},"字号",-1)),f(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(u).fontSize=s),class:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"},[...t[13]||(t[13]=[E('<option value="12">12pt</option><option value="14">14pt</option><option value="16">16pt</option><option value="18">18pt</option><option value="20">20pt</option><option value="22">22pt</option><option value="24">24pt</option>',7)])],512),[[j,o(u).fontSize]])]),e("div",bt,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-text-secondary"},"文字颜色",-1)),e("div",wt,[f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o(u).color=s),type:"color",class:"w-10 h-10 border border-gray-200 rounded cursor-pointer"},null,512),[[T,o(u).color]]),e("span",_t,d(o(u).color),1)])]),e("div",kt,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-text-secondary"},"行距",-1)),f(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>o(u).lineHeight=s),class:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"},[...t[16]||(t[16]=[E('<option value="1">1.0</option><option value="1.15">1.15</option><option value="1.5">1.5</option><option value="1.75">1.75</option><option value="2">2.0</option>',5)])],512),[[j,o(u).lineHeight]])])])])]),e("div",Ct,[e("div",St,[e("div",$t,[t[23]||(t[23]=e("h2",{class:"text-lg font-bold text-text-primary"},"实时预览",-1)),e("div",Ft,[e("button",{onClick:re,class:"p-2 text-text-secondary hover:text-primary hover:bg-gray-100 rounded-lg transition-colors"},[...t[18]||(t[18]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])]),e("span",Mt,d(Math.round(o(b)*100))+"%",1),e("button",{onClick:ne,class:"p-2 text-text-secondary hover:text-primary hover:bg-gray-100 rounded-lg transition-colors"},[...t[19]||(t[19]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),t[22]||(t[22]=e("div",{class:"w-px h-6 bg-gray-200 mx-2"},null,-1)),e("button",{onClick:le,class:"p-2 text-text-secondary hover:text-primary hover:bg-gray-100 rounded-lg transition-colors"},[o(V)?(a(),l("svg",jt,[...t[21]||(t[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])):(a(),l("svg",Vt,[...t[20]||(t[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"},null,-1)])]))])])]),e("div",{ref:"previewContainer",class:g(["p-8 overflow-auto transition-all duration-300",o(V)?"fixed inset-0 z-50 bg-white":"min-h-[600px]"])},[e("div",{style:Me({transform:`scale(${o(b)})`,transformOrigin:"top center",fontFamily:o(u).fontFamily,fontSize:`${o(u).fontSize}pt`,color:o(u).color,lineHeight:o(u).lineHeight}),class:"transition-all duration-200 preview-content"},[e("div",Et,[o(m)?.type==="word"?(a(),l("div",Tt,[e("h1",zt,d(o(r).title||"文档标题"),1),e("div",Bt,[o(r).companyName?(a(),l("div",Nt,[t[24]||(t[24]=e("span",{class:"font-medium w-24"},"公司名称：",-1)),e("span",null,d(o(r).companyName),1)])):y("",!0),o(r).date?(a(),l("div",Dt,[t[25]||(t[25]=e("span",{class:"font-medium w-24"},"日期：",-1)),e("span",null,d(o(r).date),1)])):y("",!0),o(r).content?(a(),l("div",Ut,[t[26]||(t[26]=e("span",{class:"font-medium"},"内容：",-1)),e("p",Lt,d(o(r).content),1)])):y("",!0)])])):o(m)?.type==="excel"?(a(),l("div",Ot,[e("h1",Ht,d(o(r).title||"表格标题"),1),e("table",It,[t[27]||(t[27]=e("thead",null,[e("tr",{class:"bg-gray-50"},[e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"项目"),e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"数量"),e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"金额"),e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"备注")])],-1)),e("tbody",null,[(a(),l(F,null,M(5,s=>e("tr",{key:s},[e("td",Pt,d(o(r)[`item${s}`]||`项目 ${s}`),1),e("td",Rt,d(o(r)[`quantity${s}`]||"-"),1),e("td",At,d(o(r)[`amount${s}`]||"-"),1),e("td",Jt,d(o(r)[`note${s}`]||"-"),1)])),64))])])])):o(m)?.type==="ppt"?(a(),l("div",qt,[e("h1",Gt,d(o(r).title||"演示文稿标题"),1),e("div",Wt,[o(r).subtitle?(a(),l("div",Xt,d(o(r).subtitle),1)):y("",!0),o(r).content?(a(),l("div",Kt,d(o(r).content),1)):y("",!0),o(r).presenter?(a(),l("div",Yt," 演讲者："+d(o(r).presenter),1)):y("",!0)])])):(a(),l("div",Qt," 请填写左侧表单以生成预览 "))])],4)],2)])])])])]),D(h)]),o(z)?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:Ve(R,["self"])},[e("div",Zt,[e("div",eo,[t[28]||(t[28]=E('<div class="flex items-center justify-center w-16 h-16 bg-white/20 rounded-full mx-auto mb-4"><svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-xl font-bold text-white text-center">下载成功！</h3><p class="text-white/80 text-center mt-2">文件已生成，可前往下载文件夹查看</p>',3)),e("div",to,[e("span",oo,d(I.find(s=>s.value===o(H))?.ext||"DOCX"),1)])]),e("div",so,[e("button",{onClick:me,class:g(["w-full py-3 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2",o(C)?"bg-red-50 text-red-500 hover:bg-red-100":"bg-gray-100 text-text-primary hover:bg-gray-200"])},[o(C)?(a(),l("svg",no,[...t[29]||(t[29]=[e("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"},null,-1)])])):(a(),l("svg",ro,[...t[30]||(t[30]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"},null,-1)])])),q(" "+d(o(C)?"已收藏":"收藏模板"),1)],2),e("div",lo,[t[33]||(t[33]=e("h4",{class:"text-sm font-medium text-text-primary mb-3"},"同类模板推荐",-1)),e("div",ao,[(a(!0),l(F,null,M(o(Y),s=>(a(),l("a",{key:s.id,href:`/template/${s.id}`,class:"flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors group"},[t[31]||(t[31]=e("div",{class:"w-10 h-10 bg-gradient-to-br from-primary/10 to-primary/5 rounded-lg flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-primary",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h5v6h6v10H6z"})])],-1)),e("div",co,[e("p",uo,d(s.name),1),e("p",po,d(o(W)(s.type)),1)]),t[32]||(t[32]=e("svg",{class:"w-5 h-5 text-text-secondary group-hover:text-primary group-hover:translate-x-1 transition-all",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))],8,io))),128))])]),e("div",{class:"flex gap-3 pt-4"},[e("button",{onClick:pe,class:"flex-1 py-3 rounded-lg font-medium bg-primary text-white hover:bg-primary/90 transition-colors"}," 再次下载 "),e("button",{onClick:R,class:"flex-1 py-3 rounded-lg font-medium bg-gray-100 text-text-primary hover:bg-gray-200 transition-colors"}," 返回列表 ")])])])])):y("",!0)])}}};export{fo as default};
