import{j as h,w as R,o as i,a as s,b as z,c as u,q as f,y as g,s as b,l as c,B as C,t as p,d as y,r as v}from"./5KiIeb3O.js";import{_ as F}from"./D50zL9At.js";import{G as V}from"./9UHln5xC.js";import{_ as L}from"./DlAUqK2U.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";const S={class:"archive-compress"},B={class:"upload-section"},P={key:0,class:"options-section"},T={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},D={class:"form-group"},E={class:"form-group"},I={class:"form-group"},A={class:"form-group"},G={key:1,class:"process-section"},M=["disabled"],Z={key:0},j={key:1},q={key:2,class:"progress-section"},O={class:"progress-bar"},$={class:"text-sm text-gray-500 mt-1"},H={key:3,class:"result-section"},J={class:"result-info"},K={class:"result-item"},Q={class:"value"},W={class:"result-item"},X={class:"value"},Y={class:"result-item"},ss={class:"value"},es={class:"result-item"},os={class:"value"},ls={class:"result-item"},ts={class:"value"},as={key:4,class:"error-section"},is={class:"error-message"},ns={__name:"index",setup(rs){const n=v([]),m=v(!1),_=v(0),w=v(""),l=v(null),r=v(""),o=v({format:"zip",compressionLevel:"normal",fileName:"compressed",password:""}),x=t=>{n.value=[...n.value,...t],r.value="",l.value=null},k=()=>{n.value=[],r.value="",l.value=null},N=async()=>{if(n.value.length===0){r.value="请先上传文件";return}m.value=!0,_.value=0,w.value="准备压缩...",r.value="",l.value=null;try{const t=new FormData;n.value.forEach(d=>{t.append("files",d)}),t.append("format",o.value.format),t.append("compressionLevel",o.value.compressionLevel),t.append("fileName",o.value.fileName),t.append("password",o.value.password);const e=await fetch("/api/archive/compress",{method:"POST",body:t});if(!e.ok)throw new Error("API请求失败");const a=await e.json();if(a.success){const d=a.data[0];l.value={fileName:d.fileName,format:o.value.format.toUpperCase(),fileCount:d.fileCount,compressedSize:d.compressedSize,compressionRatio:d.compressionRatio,downloadUrl:d.downloadUrl}}else throw new Error(a.message||"压缩失败")}catch(t){r.value=t.message||"压缩失败，请重试"}finally{m.value=!1}},U=()=>{l.value?.downloadUrl&&window.open(l.value.downloadUrl,"_blank")};return(t,e)=>(i(),h(F,{title:"文件压缩",description:"将文件或文件夹压缩为各种格式的压缩包"},{default:R(()=>[s("div",S,[s("div",B,[e[4]||(e[4]=s("h3",null,"上传文件",-1)),z(V,{accept:["*"],multiple:!0,onFileUploaded:x,onFileRemoved:k}),e[5]||(e[5]=s("p",{class:"text-sm text-gray-500 mt-2"},"支持多个文件，单个文件大小不超过50MB",-1))]),n.value.length>0?(i(),u("div",P,[e[12]||(e[12]=s("h3",null,"压缩选项",-1)),s("div",T,[s("div",D,[e[7]||(e[7]=s("label",{for:"format"},"压缩格式",-1)),f(s("select",{id:"format","onUpdate:modelValue":e[0]||(e[0]=a=>o.value.format=a),class:"form-select"},[...e[6]||(e[6]=[s("option",{value:"zip"},"ZIP",-1),s("option",{value:"rar"},"RAR",-1),s("option",{value:"7z"},"7Z",-1),s("option",{value:"tar"},"TAR",-1),s("option",{value:"gz"},"GZIP",-1)])],512),[[g,o.value.format]])]),s("div",E,[e[9]||(e[9]=s("label",{for:"compressionLevel"},"压缩级别",-1)),f(s("select",{id:"compressionLevel","onUpdate:modelValue":e[1]||(e[1]=a=>o.value.compressionLevel=a),class:"form-select"},[...e[8]||(e[8]=[s("option",{value:"store"},"存储 (无压缩)",-1),s("option",{value:"fast"},"快速压缩",-1),s("option",{value:"normal"},"标准压缩",-1),s("option",{value:"high"},"高压缩",-1),s("option",{value:"ultra"},"极限压缩",-1)])],512),[[g,o.value.compressionLevel]])]),s("div",I,[e[10]||(e[10]=s("label",{for:"fileName"},"压缩包名称",-1)),f(s("input",{id:"fileName",type:"text","onUpdate:modelValue":e[2]||(e[2]=a=>o.value.fileName=a),class:"form-input",placeholder:"默认为 compressed"},null,512),[[b,o.value.fileName]])]),s("div",A,[e[11]||(e[11]=s("label",{for:"password"},"密码保护",-1)),f(s("input",{id:"password",type:"password","onUpdate:modelValue":e[3]||(e[3]=a=>o.value.password=a),class:"form-input",placeholder:"可选"},null,512),[[b,o.value.password]])])])])):c("",!0),n.value.length>0?(i(),u("div",G,[s("button",{class:"btn btn-primary",onClick:N,disabled:m.value},[m.value?(i(),u("span",j,"压缩中...")):(i(),u("span",Z,"开始压缩"))],8,M)])):c("",!0),m.value?(i(),u("div",q,[s("div",O,[s("div",{class:"progress-fill",style:C({width:_.value+"%"})},null,4)]),s("p",$,p(w.value),1)])):c("",!0),l.value?(i(),u("div",H,[e[19]||(e[19]=s("h3",null,"压缩结果",-1)),s("div",J,[s("div",K,[e[13]||(e[13]=s("span",{class:"label"},"压缩包名称:",-1)),s("span",Q,p(l.value.fileName),1)]),s("div",W,[e[14]||(e[14]=s("span",{class:"label"},"压缩格式:",-1)),s("span",X,p(l.value.format),1)]),s("div",Y,[e[15]||(e[15]=s("span",{class:"label"},"文件数量:",-1)),s("span",ss,p(l.value.fileCount),1)]),s("div",es,[e[16]||(e[16]=s("span",{class:"label"},"压缩大小:",-1)),s("span",os,p(l.value.compressedSize),1)]),s("div",ls,[e[17]||(e[17]=s("span",{class:"label"},"压缩率:",-1)),s("span",ts,p(l.value.compressionRatio),1)]),s("button",{class:"btn btn-secondary mt-4",onClick:U},[...e[18]||(e[18]=[s("i",{class:"fas fa-download mr-2"},null,-1),y("下载压缩包 ",-1)])])])])):c("",!0),r.value?(i(),u("div",as,[s("div",is,[e[20]||(e[20]=s("i",{class:"fas fa-exclamation-circle text-red-500 mr-2"},null,-1)),y(" "+p(r.value),1)])])):c("",!0)])]),_:1}))}},ws=L(ns,[["__scopeId","data-v-259924bc"]]);export{ws as default};
