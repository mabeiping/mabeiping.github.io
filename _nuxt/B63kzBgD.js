import{_ as e,w as l,m as a,p as t,q as s,n as o,F as r,u,x as n,D as d,z as i,I as c,a7 as m,J as p,a8 as v,v as y,K as b,k as g,l as x}from"./DFWWPSrV.js";import{_ as f}from"./C1jkWaCi.js";import{G as w}from"./BGFgIxDv.js";import{s as k}from"./6sfX8FW2.js";import"./CdYbPlRr.js";import"./nEzmyvu1.js";import"./BM3HdAYC.js";import"./DUMejLMI.js";const h={class:"space-y-6"},M={key:0,class:"bg-gray-50 p-4 rounded-lg"},z={class:"space-y-2"},C={class:"flex items-center"},F={class:"font-medium"},V={class:"text-sm text-gray-500"},T=["onClick"],U={key:1,class:"bg-gray-50 p-4 rounded-lg"},D={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},j=["value"],Y={class:"font-medium"},B={class:"text-sm text-gray-500"},P={key:2,class:"space-y-4"},O={key:0,class:"bg-white p-4 rounded-lg border"},E={class:"space-y-3"},A={key:0},S={key:1,class:"bg-white p-4 rounded-lg border"},H={class:"space-y-3"},K={key:0},L={key:2,class:"bg-white p-4 rounded-lg border"},R={class:"space-y-3"},_={class:"space-y-2"},N={class:"flex items-center space-x-2"},$={class:"flex items-center space-x-2"},G={class:"flex items-center space-x-2"},I={class:"flex items-center space-x-2"},q={key:0},J={key:3,class:"bg-white p-4 rounded-lg border"},Q={class:"space-y-3"},W={key:0},X={class:"mt-2 space-y-2"},Z={class:"grid grid-cols-2 gap-2"},ee={class:"text-xs text-gray-500"},le={class:"text-xs text-gray-500"},ae={key:1},te={class:"mt-2"},se={class:"flex space-x-4"},oe=["disabled"],re={key:0},ue={key:1,class:"flex items-center justify-center"},ne={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},de={class:"flex items-center justify-between mb-2"},ie={class:"text-blue-700"},ce={class:"w-full bg-gray-200 rounded-full h-2.5"},me={class:"mt-2 text-sm text-blue-700"},pe={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},ve={class:"mt-2 text-green-700"},ye={class:"mt-3 space-y-2"},be=["href","download"],ge={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},xe={class:"mt-2 text-red-700"},fe={key:0,class:"mt-2 text-sm text-gray-600"},we={__name:"index",setup(we){const ke=[{value:"removeDuplicates",label:"重复数据清洗",description:"移除表格中的重复数据"},{value:"batchCalculation",label:"公式批量计算",description:"对表格数据进行批量公式计算"},{value:"standardizeFormat",label:"表格格式标准化",description:"标准化表格格式和数据类型"},{value:"watermarkEncrypt",label:"批量加水印/加密",description:"为表格添加水印或进行加密"}],he=g(""),Me=g({duplicateKey:"allColumns",specificColumns:"",keepOption:"first"}),ze=g({calculationType:"sum",customFormula:"",applyRange:""}),Ce=g({standardizeHeaders:!0,standardizeDataTypes:!0,standardizeDateFormats:!0,standardizeNumberFormats:!0,dateFormat:"yyyy-MM-dd"}),Fe=g({operationType:"watermark",watermarkText:"机密文件",watermarkOpacity:30,watermarkFontSize:24,encryptPassword:"",confirmPassword:""}),Ve=g([]),Te=x(()=>Ve.value),Ue=g(!1),De=g(!1),je=g(""),Ye=g(""),Be=g(""),Pe=g(0),Oe=g(""),Ee=g([]),Ae=["1. 上传文件：支持Excel和CSV格式，可批量上传","2. 选择处理功能：重复数据清洗、公式批量计算、表格格式标准化或批量加水印/加密","3. 根据选择的功能，设置相应的处理选项",'4. 点击"开始处理"按钮进行处理',"5. 等待处理完成，系统会自动下载处理后的文件","6. 查看处理结果，确保数据的完整性和准确性"],Se=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},He=e=>{Ve.value=e,Ye.value="",De.value=!1},Ke=e=>{Ye.value=e,Be.value=Le(e)},Le=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Re=async()=>{if(0!==Te.length)if(he.value){if("watermarkEncrypt"===he.value&&"encrypt"===Fe.value.operationType){if(!Fe.value.encryptPassword)return void(Ye.value="请输入加密密码");if(Fe.value.encryptPassword!==Fe.value.confirmPassword)return void(Ye.value="两次输入的密码不一致")}Ue.value=!0,Ye.value="",Be.value="",De.value=!1,Pe.value=0,Oe.value="准备处理...",Ee.value=[];try{await new Promise(e=>{let l=0;const a=k(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),Pe.value=l,Oe.value=l<30?"正在分析文件...":l<70?"正在处理文件...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});let e={files:Te.value,feature:he.value};"removeDuplicates"===he.value?e.options=Me.value:"batchCalculation"===he.value?e.options=ze.value:"standardizeFormat"===he.value?e.options=Ce.value:"watermarkEncrypt"===he.value&&(e.options=Fe.value);const l=ke.find(e=>e.value===he.value);je.value=`成功对 ${Te.length} 个文件执行 ${l.label} 操作！`,De.value=!0,Te.forEach((e,l)=>{const a=new Blob(["模拟处理后的文件内容"],{type:"application/octet-stream"}),t=URL.createObjectURL(a),s=`processed_${e.name}`;Ee.value.push({url:t,filename:s})}),Ee.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=Ee.value[0].url,e.download=Ee.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){Ye.value=`处理失败：${e.message||"未知错误"}`,Be.value=Le(Ye.value)}finally{Ue.value=!1}}else Ye.value="请选择处理功能";else Ye.value="请选择文件"},_e=()=>{Ve.value=[],he.value="",Me.value={duplicateKey:"allColumns",specificColumns:"",keepOption:"first"},ze.value={calculationType:"sum",customFormula:"",applyRange:""},Ce.value={standardizeHeaders:!0,standardizeDataTypes:!0,standardizeDateFormats:!0,standardizeNumberFormats:!0,dateFormat:"yyyy-MM-dd"},Fe.value={operationType:"watermark",watermarkText:"机密文件",watermarkOpacity:30,watermarkFontSize:24,encryptPassword:"",confirmPassword:""},Ye.value="",Be.value="",De.value=!1,je.value="",Pe.value=0,Oe.value="",Ee.value=[]};return(g,x)=>(a(),e(f,{title:"Excel表格数据处理",description:"支持表格重复数据清洗去重、公式批量计算、表格格式标准化、批量加水印/加密",tips:Ae},{default:l(()=>[t("div",h,[s(w,{multiple:!0,accept:[".xls",".xlsx",".csv"],"max-size":104857600,modelValue:Ve.value,"onUpdate:modelValue":x[0]||(x[0]=e=>Ve.value=e),onFilesChanged:He,onError:Ke},null,8,["modelValue"]),Te.value.length>0?(a(),o("div",M,[x[21]||(x[21]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",z,[(a(!0),o(r,null,u(Te.value,(e,l)=>{return a(),o("div",{key:l,class:"flex items-center justify-between p-2 bg-white rounded border"},[t("div",C,[x[19]||(x[19]=t("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("div",null,[t("div",F,n(e.name),1),t("div",V,n((s=e.name,s.split(".").pop().toLowerCase()))+" • "+n(Se(e.size)),1)])]),t("button",{onClick:e=>(e=>{Ve.value.splice(e,1),0===Ve.value.length&&_e()})(l),class:"text-red-500 hover:text-red-700"},[...x[20]||(x[20]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,T)]);var s}),128))])])):d("",!0),Te.value.length>0?(a(),o("div",U,[x[22]||(x[22]=t("h3",{class:"text-lg font-semibold mb-4"},"处理功能",-1)),t("div",D,[(a(),o(r,null,u(ke,e=>t("label",{key:e.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[i(t("input",{type:"radio","onUpdate:modelValue":x[1]||(x[1]=e=>he.value=e),value:e.value,class:"w-4 h-4 text-blue-600"},null,8,j),[[c,he.value]]),t("div",null,[t("div",Y,n(e.label),1),t("div",B,n(e.description),1)])])),64))])])):d("",!0),Te.value.length>0&&he.value?(a(),o("div",P,["removeDuplicates"===he.value?(a(),o("div",O,[x[28]||(x[28]=t("h3",{class:"text-lg font-semibold mb-3"},"重复数据清洗选项",-1)),t("div",E,[t("div",null,[x[24]||(x[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"去重依据",-1)),i(t("select",{"onUpdate:modelValue":x[2]||(x[2]=e=>Me.value.duplicateKey=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[23]||(x[23]=[t("option",{value:"allColumns"},"所有列",-1),t("option",{value:"specificColumns"},"指定列",-1)])],512),[[m,Me.value.duplicateKey]])]),"specificColumns"===Me.value.duplicateKey?(a(),o("div",A,[x[25]||(x[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"指定列（用逗号分隔）",-1)),i(t("input",{"onUpdate:modelValue":x[3]||(x[3]=e=>Me.value.specificColumns=e),type:"text",placeholder:"例如：A,B,C 或 姓名,年龄,性别",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[p,Me.value.specificColumns]])])):d("",!0),t("div",null,[x[27]||(x[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"保留方式",-1)),i(t("select",{"onUpdate:modelValue":x[4]||(x[4]=e=>Me.value.keepOption=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[26]||(x[26]=[t("option",{value:"first"},"保留第一个",-1),t("option",{value:"last"},"保留最后一个",-1)])],512),[[m,Me.value.keepOption]])])])])):d("",!0),"batchCalculation"===he.value?(a(),o("div",S,[x[33]||(x[33]=t("h3",{class:"text-lg font-semibold mb-3"},"公式批量计算选项",-1)),t("div",H,[t("div",null,[x[30]||(x[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"计算类型",-1)),i(t("select",{"onUpdate:modelValue":x[5]||(x[5]=e=>ze.value.calculationType=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[29]||(x[29]=[t("option",{value:"sum"},"求和",-1),t("option",{value:"average"},"平均值",-1),t("option",{value:"max"},"最大值",-1),t("option",{value:"min"},"最小值",-1),t("option",{value:"count"},"计数",-1),t("option",{value:"custom"},"自定义公式",-1)])],512),[[m,ze.value.calculationType]])]),"custom"===ze.value.calculationType?(a(),o("div",K,[x[31]||(x[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"自定义公式",-1)),i(t("input",{"onUpdate:modelValue":x[6]||(x[6]=e=>ze.value.customFormula=e),type:"text",placeholder:"例如：=A1+B1 或 =SUM(A1:A10)",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[p,ze.value.customFormula]])])):d("",!0),t("div",null,[x[32]||(x[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"应用范围",-1)),i(t("input",{"onUpdate:modelValue":x[7]||(x[7]=e=>ze.value.applyRange=e),type:"text",placeholder:"例如：A1:A100 或 所有行",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[p,ze.value.applyRange]])])])])):d("",!0),"standardizeFormat"===he.value?(a(),o("div",L,[x[41]||(x[41]=t("h3",{class:"text-lg font-semibold mb-3"},"表格格式标准化选项",-1)),t("div",R,[t("div",null,[x[38]||(x[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"标准化项目",-1)),t("div",_,[t("label",N,[i(t("input",{type:"checkbox","onUpdate:modelValue":x[8]||(x[8]=e=>Ce.value.standardizeHeaders=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,Ce.value.standardizeHeaders]]),x[34]||(x[34]=t("span",null,"标准化表头",-1))]),t("label",$,[i(t("input",{type:"checkbox","onUpdate:modelValue":x[9]||(x[9]=e=>Ce.value.standardizeDataTypes=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,Ce.value.standardizeDataTypes]]),x[35]||(x[35]=t("span",null,"标准化数据类型",-1))]),t("label",G,[i(t("input",{type:"checkbox","onUpdate:modelValue":x[10]||(x[10]=e=>Ce.value.standardizeDateFormats=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,Ce.value.standardizeDateFormats]]),x[36]||(x[36]=t("span",null,"标准化日期格式",-1))]),t("label",I,[i(t("input",{type:"checkbox","onUpdate:modelValue":x[11]||(x[11]=e=>Ce.value.standardizeNumberFormats=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,Ce.value.standardizeNumberFormats]]),x[37]||(x[37]=t("span",null,"标准化数字格式",-1))])])]),Ce.value.standardizeDateFormats?(a(),o("div",q,[x[40]||(x[40]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"日期格式",-1)),i(t("select",{"onUpdate:modelValue":x[12]||(x[12]=e=>Ce.value.dateFormat=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[39]||(x[39]=[t("option",{value:"yyyy-MM-dd"},"YYYY-MM-DD",-1),t("option",{value:"yyyy/MM/dd"},"YYYY/MM/DD",-1),t("option",{value:"MM/dd/yyyy"},"MM/DD/YYYY",-1),t("option",{value:"dd/MM/yyyy"},"DD/MM/YYYY",-1)])],512),[[m,Ce.value.dateFormat]])])):d("",!0)])])):d("",!0),"watermarkEncrypt"===he.value?(a(),o("div",J,[x[50]||(x[50]=t("h3",{class:"text-lg font-semibold mb-3"},"批量加水印/加密选项",-1)),t("div",Q,[t("div",null,[x[43]||(x[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"操作类型",-1)),i(t("select",{"onUpdate:modelValue":x[13]||(x[13]=e=>Fe.value.operationType=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[42]||(x[42]=[t("option",{value:"watermark"},"加水印",-1),t("option",{value:"encrypt"},"加密",-1)])],512),[[m,Fe.value.operationType]])]),"watermark"===Fe.value.operationType?(a(),o("div",W,[x[47]||(x[47]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印内容",-1)),i(t("input",{"onUpdate:modelValue":x[14]||(x[14]=e=>Fe.value.watermarkText=e),type:"text",placeholder:"例如：机密文件 或 内部使用",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[p,Fe.value.watermarkText]]),t("div",X,[x[46]||(x[46]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印样式",-1)),t("div",Z,[t("div",null,[x[44]||(x[44]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"透明度",-1)),i(t("input",{"onUpdate:modelValue":x[15]||(x[15]=e=>Fe.value.watermarkOpacity=e),type:"range",min:"0",max:"100",class:"w-full"},null,512),[[p,Fe.value.watermarkOpacity,void 0,{number:!0}]]),t("span",ee,n(Fe.value.watermarkOpacity)+"%",1)]),t("div",null,[x[45]||(x[45]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"字体大小",-1)),i(t("input",{"onUpdate:modelValue":x[16]||(x[16]=e=>Fe.value.watermarkFontSize=e),type:"range",min:"12",max:"72",class:"w-full"},null,512),[[p,Fe.value.watermarkFontSize,void 0,{number:!0}]]),t("span",le,n(Fe.value.watermarkFontSize)+"px",1)])])])])):d("",!0),"encrypt"===Fe.value.operationType?(a(),o("div",ae,[x[49]||(x[49]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密密码",-1)),i(t("input",{"onUpdate:modelValue":x[17]||(x[17]=e=>Fe.value.encryptPassword=e),type:"password",placeholder:"请输入加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[p,Fe.value.encryptPassword]]),t("div",te,[x[48]||(x[48]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"确认密码",-1)),i(t("input",{"onUpdate:modelValue":x[18]||(x[18]=e=>Fe.value.confirmPassword=e),type:"password",placeholder:"请确认加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[p,Fe.value.confirmPassword]])])])):d("",!0)])])):d("",!0)])):d("",!0),t("div",se,[t("button",{onClick:Re,disabled:!Te.value.length||!he.value||Ue.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[Ue.value?(a(),o("span",ue,[x[51]||(x[51]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" 处理中... "+n(Pe.value)+"% ",1)])):(a(),o("span",re,"开始处理"))],8,oe),t("button",{onClick:_e,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),Ue.value?(a(),o("div",ne,[t("div",de,[x[52]||(x[52]=t("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),t("span",ie,n(Pe.value)+"%",1)]),t("div",ce,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:b({width:Pe.value+"%"})},null,4)]),t("p",me,n(Oe.value),1)])):d("",!0),De.value?(a(),o("div",pe,[x[53]||(x[53]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),t("p",ve,n(je.value),1),t("div",ye,[(a(!0),o(r,null,u(Ee.value,(e,l)=>(a(),o("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载处理结果 "+n(l+1),9,be))),128))])])):d("",!0),Ye.value?(a(),o("div",ge,[x[54]||(x[54]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),t("p",xe,n(Ye.value),1),Be.value?(a(),o("p",fe,"建议："+n(Be.value),1)):d("",!0)])):d("",!0)])]),_:1}))}};export{we as default};
