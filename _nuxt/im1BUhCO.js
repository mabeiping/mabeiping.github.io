import{j as B,w as R,o as s,a as e,b as f,c as n,q as x,y as F,l as u,t as v,s as j,F as G,p as M,r}from"./5KiIeb3O.js";import{_ as W}from"./D50zL9At.js";import{G as y}from"./9UHln5xC.js";import{_ as q}from"./DlAUqK2U.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";const z={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},A={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},L={key:0,class:"mt-4 space-y-4"},H={key:1,class:"mt-4 p-4 bg-green-50 rounded-md"},J={class:"mt-2"},K={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Q={class:"space-y-4"},X={key:0},Y={key:0,class:"mt-4 p-4 bg-green-50 rounded-md"},Z={class:"mt-2"},ee={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},te={key:0,class:"mt-4 space-y-4"},oe={class:"font-medium text-gray-900 mb-2"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-2"},se={key:1,class:"mt-4 p-4 bg-green-50 rounded-md"},ne={class:"mt-2"},re={__name:"index",setup(ae){const c=r(null),g=r("pdf"),m=r(null),w=o=>{c.value=o[0]},k=o=>{c.value=o},D=()=>{c.value&&setTimeout(()=>{m.value={fileName:c.value.name.replace(/\.[^/.]+$/,"")+"."+g.value,url:"#"}},1500)},C=()=>{if(!m.value)return;const o=document.createElement("a");o.href=m.value.url,o.download=m.value.fileName,o.click()},i=r("split"),b=r([]),h=r(""),p=r(null),_=o=>{b.value=o},O=o=>{b.value=o},U=()=>{b.value.length!==0&&setTimeout(()=>{let o="";switch(i.value){case"split":o="OFD文件已成功拆分";break;case"merge":o=`${b.value.length}个OFD文件已成功合并`;break;case"encrypt":o="OFD文件已成功加密";break;case"extract":o="OFD文件内容已成功提取";break}p.value={message:o,url:"#"}},1500)},P=()=>{if(!p.value)return;const o=document.createElement("a");o.href=p.value.url,o.download="processed-ofd"+(i.value==="split"?"-parts":"")+".ofd",o.click()},l=r([]),a=r(null),S=o=>{l.value=o},T=o=>{l.value=o},I=()=>{l.value.length!==0&&setTimeout(()=>{a.value={message:`成功将 ${l.value.length} 个电子发票转换为PDF`,downloadUrl:"#"}},2e3)},V=()=>{l.value.length!==0&&setTimeout(()=>{a.value={message:`成功提取 ${l.value.length} 个电子发票的数据`,downloadUrl:"#"}},2e3)},$=()=>{l.value.length!==0&&setTimeout(()=>{a.value={message:`成功归档 ${l.value.length} 个电子发票`,downloadUrl:"#"}},2e3)},E=()=>{if(!a.value?.downloadUrl)return;const o=document.createElement("a");o.href=a.value.downloadUrl,o.download="invoice-process-result.zip",o.click()};return(o,t)=>(s(),B(W,{title:"OFD/电子文档处理",description:"支持OFD与PDF/Word/图片互转、OFD文件拆分/合并/加密"},{default:R(()=>[e("div",z,[e("div",A,[t[6]||(t[6]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"OFD格式转换",-1)),f(y,{accept:[".ofd",".pdf",".doc",".docx",".jpg",".jpeg",".png"],multiple:!1,onFilesSelected:w,onUploadComplete:k}),c.value?(s(),n("div",L,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"目标格式",-1)),x(e("select",{"onUpdate:modelValue":t[0]||(t[0]=d=>g.value=d),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[3]||(t[3]=[e("option",{value:"pdf"},"PDF",-1),e("option",{value:"docx"},"Word",-1),e("option",{value:"png"},"图片",-1),e("option",{value:"ofd"},"OFD",-1)])],512),[[F,g.value]])]),e("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:D}," 开始转换 ")])):u("",!0),m.value?(s(),n("div",H,[t[5]||(t[5]=e("h4",{class:"font-medium text-green-800"},"转换成功",-1)),e("p",J,"文件已转换为 "+v(g.value)+" 格式",1),e("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:C}," 下载转换结果 ")])):u("",!0)]),e("div",K,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"OFD文件处理",-1)),e("div",Q,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"处理类型",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=d=>i.value=d),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[7]||(t[7]=[e("option",{value:"split"},"拆分OFD",-1),e("option",{value:"merge"},"合并OFD",-1),e("option",{value:"encrypt"},"加密OFD",-1),e("option",{value:"extract"},"提取内容",-1)])],512),[[F,i.value]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"OFD文件",-1)),f(y,{accept:[".ofd"],multiple:i.value==="merge",onFilesSelected:_,onUploadComplete:O},null,8,["multiple"])]),i.value==="encrypt"?(s(),n("div",X,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密密码",-1)),x(e("input",{type:"password","onUpdate:modelValue":t[2]||(t[2]=d=>h.value=d),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"输入加密密码"},null,512),[[j,h.value]])])):u("",!0),e("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:U}," 开始处理 ")]),p.value?(s(),n("div",Y,[t[11]||(t[11]=e("h4",{class:"font-medium text-green-800"},"处理成功",-1)),e("p",Z,v(p.value.message),1),e("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:P}," 下载处理结果 ")])):u("",!0)]),e("div",ee,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"电子发票批量处理",-1)),t[15]||(t[15]=e("p",{class:"text-sm text-gray-600 mb-4"},"支持批量上传OFD电子发票，进行统一处理",-1)),f(y,{accept:[".ofd"],multiple:!0,onFilesSelected:S,onUploadComplete:T}),l.value.length>0?(s(),n("div",te,[e("div",null,[e("h4",oe,"已选择 "+v(l.value.length)+" 个发票文件",1),e("div",le,[(s(!0),n(G,null,M(l.value,(d,N)=>(s(),n("div",{key:N,class:"text-sm text-gray-600"},v(d.name),1))),128))])]),e("div",{class:"grid grid-cols-1 md:grid-cols-3 gap-4"},[e("button",{class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:I}," 批量转PDF "),e("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:V}," 批量提取数据 "),e("button",{class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",onClick:$}," 批量归档 ")])])):u("",!0),a.value?(s(),n("div",se,[t[13]||(t[13]=e("h4",{class:"font-medium text-green-800"},"处理成功",-1)),e("p",ne,v(a.value.message),1),a.value.downloadUrl?(s(),n("button",{key:0,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:E}," 下载处理结果 ")):u("",!0)])):u("",!0)])])]),_:1}))}},be=q(re,[["__scopeId","data-v-9cdfbe8a"]]);export{be as default};
