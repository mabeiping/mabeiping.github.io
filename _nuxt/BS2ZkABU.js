import{j as e,w as a,o as s,a as l,b as o,c as t,q as r,y as i,s as n,l as u,B as p,t as c,d as v,r as d}from"./BGpdZ-s9.js";import{_ as m}from"./B4wm4ekp.js";import{G as f}from"./BtAA_ILT.js";import{_ as w}from"./BCo6x5W8.js";import"./DILYegs3.js";import"./D_BBTi0O.js";import"./9Oz-M6e1.js";import"./DKLvglw8.js";const b={class:"archive-compress"},g={class:"upload-section"},h={key:0,class:"options-section"},y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},k={class:"form-group"},j={class:"form-group"},N={class:"form-group"},U={class:"form-group"},x={key:1,class:"process-section"},_=["disabled"],z={key:0},L={key:1},R={key:2,class:"progress-section"},C={class:"progress-bar"},I={class:"text-sm text-gray-500 mt-1"},P={key:3,class:"result-section"},S={class:"result-info"},V={class:"result-item"},Z={class:"value"},A={class:"result-item"},E={class:"value"},F={class:"result-item"},B={class:"value"},G={class:"result-item"},T={class:"value"},q={class:"result-item"},D={class:"value"},M={key:4,class:"error-section"},O={class:"error-message"},Y=w({__name:"index",setup(w){const Y=d([]),$=d(!1),H=d(0),J=d(""),K=d(null),Q=d(""),W=d({format:"zip",compressionLevel:"normal",fileName:"compressed",password:""}),X=e=>{Y.value=[...Y.value,...e],Q.value="",K.value=null},ee=()=>{Y.value=[],Q.value="",K.value=null},ae=async()=>{if(0!==Y.value.length){$.value=!0,H.value=0,J.value="准备压缩...",Q.value="",K.value=null;try{const e=new FormData;Y.value.forEach(a=>{e.append("files",a)}),e.append("format",W.value.format),e.append("compressionLevel",W.value.compressionLevel),e.append("fileName",W.value.fileName),e.append("password",W.value.password);const a=await fetch("/api/archive/compress",{method:"POST",body:e});if(!a.ok)throw new Error("API请求失败");const s=await a.json();if(!s.success)throw new Error(s.message||"压缩失败");{const e=s.data[0];K.value={fileName:e.fileName,format:W.value.format.toUpperCase(),fileCount:e.fileCount,compressedSize:e.compressedSize,compressionRatio:e.compressionRatio,downloadUrl:e.downloadUrl}}}catch(e){Q.value=e.message||"压缩失败，请重试"}finally{$.value=!1}}else Q.value="请先上传文件"},se=()=>{K.value?.downloadUrl&&window.open(K.value.downloadUrl,"_blank")};return(d,w)=>(s(),e(m,{title:"文件压缩",description:"将文件或文件夹压缩为各种格式的压缩包"},{default:a(()=>[l("div",b,[l("div",g,[w[4]||(w[4]=l("h3",null,"上传文件",-1)),o(f,{accept:["*"],multiple:!0,onFileUploaded:X,onFileRemoved:ee}),w[5]||(w[5]=l("p",{class:"text-sm text-gray-500 mt-2"},"支持多个文件，单个文件大小不超过50MB",-1))]),Y.value.length>0?(s(),t("div",h,[w[12]||(w[12]=l("h3",null,"压缩选项",-1)),l("div",y,[l("div",k,[w[7]||(w[7]=l("label",{for:"format"},"压缩格式",-1)),r(l("select",{id:"format","onUpdate:modelValue":w[0]||(w[0]=e=>W.value.format=e),class:"form-select"},[...w[6]||(w[6]=[l("option",{value:"zip"},"ZIP",-1),l("option",{value:"rar"},"RAR",-1),l("option",{value:"7z"},"7Z",-1),l("option",{value:"tar"},"TAR",-1),l("option",{value:"gz"},"GZIP",-1)])],512),[[i,W.value.format]])]),l("div",j,[w[9]||(w[9]=l("label",{for:"compressionLevel"},"压缩级别",-1)),r(l("select",{id:"compressionLevel","onUpdate:modelValue":w[1]||(w[1]=e=>W.value.compressionLevel=e),class:"form-select"},[...w[8]||(w[8]=[l("option",{value:"store"},"存储 (无压缩)",-1),l("option",{value:"fast"},"快速压缩",-1),l("option",{value:"normal"},"标准压缩",-1),l("option",{value:"high"},"高压缩",-1),l("option",{value:"ultra"},"极限压缩",-1)])],512),[[i,W.value.compressionLevel]])]),l("div",N,[w[10]||(w[10]=l("label",{for:"fileName"},"压缩包名称",-1)),r(l("input",{id:"fileName",type:"text","onUpdate:modelValue":w[2]||(w[2]=e=>W.value.fileName=e),class:"form-input",placeholder:"默认为 compressed"},null,512),[[n,W.value.fileName]])]),l("div",U,[w[11]||(w[11]=l("label",{for:"password"},"密码保护",-1)),r(l("input",{id:"password",type:"password","onUpdate:modelValue":w[3]||(w[3]=e=>W.value.password=e),class:"form-input",placeholder:"可选"},null,512),[[n,W.value.password]])])])])):u("",!0),Y.value.length>0?(s(),t("div",x,[l("button",{class:"btn btn-primary",onClick:ae,disabled:$.value},[$.value?(s(),t("span",L,"压缩中...")):(s(),t("span",z,"开始压缩"))],8,_)])):u("",!0),$.value?(s(),t("div",R,[l("div",C,[l("div",{class:"progress-fill",style:p({width:H.value+"%"})},null,4)]),l("p",I,c(J.value),1)])):u("",!0),K.value?(s(),t("div",P,[w[19]||(w[19]=l("h3",null,"压缩结果",-1)),l("div",S,[l("div",V,[w[13]||(w[13]=l("span",{class:"label"},"压缩包名称:",-1)),l("span",Z,c(K.value.fileName),1)]),l("div",A,[w[14]||(w[14]=l("span",{class:"label"},"压缩格式:",-1)),l("span",E,c(K.value.format),1)]),l("div",F,[w[15]||(w[15]=l("span",{class:"label"},"文件数量:",-1)),l("span",B,c(K.value.fileCount),1)]),l("div",G,[w[16]||(w[16]=l("span",{class:"label"},"压缩大小:",-1)),l("span",T,c(K.value.compressedSize),1)]),l("div",q,[w[17]||(w[17]=l("span",{class:"label"},"压缩率:",-1)),l("span",D,c(K.value.compressionRatio),1)]),l("button",{class:"btn btn-secondary mt-4",onClick:se},[...w[18]||(w[18]=[l("i",{class:"fas fa-download mr-2"},null,-1),v("下载压缩包 ",-1)])])])])):u("",!0),Q.value?(s(),t("div",M,[l("div",O,[w[20]||(w[20]=l("i",{class:"fas fa-exclamation-circle text-red-500 mr-2"},null,-1)),v(" "+c(Q.value),1)])])):u("",!0)])]),_:1}))}},[["__scopeId","data-v-259924bc"]]);export{Y as default};
