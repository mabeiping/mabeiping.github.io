import{h as I,w as L,o as u,a as t,c as m,i as w,j as v,z as R,k as d,q as n,v as T,m as F,t as c,d as E,F as h,r as k,p as N}from"./DGDBYtXz.js";import{_ as H}from"./CnVvrBe4.js";import"./B9icYigy.js";import"./H-TvWAPN.js";const O={class:"space-y-6"},q={class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors"},A={class:"space-y-4"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},K={class:"space-y-3"},$={class:"flex items-center gap-2"},J=["disabled"],P={class:"flex items-center gap-2"},Q=["disabled"],X={class:"flex items-center gap-2"},Y=["disabled"],Z=["disabled"],ee={class:"space-y-3"},te={class:"flex items-center gap-2"},se=["disabled"],le={class:"flex items-center gap-2"},oe=["disabled"],ae={class:"flex items-center gap-2"},re=["disabled"],de=["disabled"],ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={class:"space-y-3"},ue={class:"flex items-center gap-2"},ce=["disabled"],pe={class:"flex items-center gap-2"},me=["disabled"],xe={class:"flex items-center gap-2"},ve=["disabled"],be={class:"space-y-3"},ye={class:"flex items-center gap-2"},ge=["disabled"],fe={class:"flex items-center gap-2"},we=["disabled"],he=["disabled"],ke={key:0,class:"space-y-4"},Ce={class:"p-4 bg-gray-50 rounded-lg"},_e={class:"text-sm text-text-primary"},Re={class:"text-sm text-text-secondary"},Ee={key:1,class:"space-y-4"},ze={class:"p-4 bg-green-50 rounded-lg"},Ve={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},Ue={class:"text-2xl font-bold text-primary"},De={class:"text-2xl font-bold text-primary"},Se={class:"text-2xl font-bold text-green-500"},je={class:"text-2xl font-bold text-green-500"},Me={class:"bg-gray-50 rounded-lg p-4 max-h-[400px] overflow-y-auto"},Be={class:"w-full text-sm"},We={class:"border-b border-gray-200"},He={__name:"data-cleaning-tool",setup(Ie){const C=v(null),o=v(null),b=v(!1),r=v(null),y=v(""),_=v("success"),l=v({removeEmptyRows:!0,removeEmptyColumns:!0,fillEmptyWith:!1,fillValue:"",trimWhitespace:!0,removeDuplicates:!0,standardizeCase:!1,caseType:"lower",removeSpecialChars:!1,standardizeDates:!1,standardizeNumbers:!1,removeHeaderRow:!1,addRowIndex:!1}),z=()=>{C.value.click()},V=a=>{const e=a.target.files[0];e&&(o.value=e)},U=a=>{const e=a.dataTransfer.files[0];e&&(o.value=e)},D=()=>{o.value=null,r.value=null},S=()=>{if(!o.value){g("请先选择文件","error");return}b.value=!0,setTimeout(()=>{const a=j();r.value=a,b.value=!1,g("数据清洗完成","success")},1500)},j=()=>{const a=["ID","姓名","邮箱","电话","地址","日期"],e=[["1","张三","zhangsan@example.com","13800138000","北京市朝阳区","2024-01-01"],["2","李四","lisi@example.com","13800138001","上海市浦东新区","2024-01-02"],["3","王五","wangwu@example.com","13800138002","广州市天河区","2024-01-03"],["4","赵六","zhaoliu@example.com","13800138003","深圳市南山区","2024-01-04"],["5","钱七","qianqi@example.com","13800138004","杭州市西湖区","2024-01-05"]];return{headers:l.value.addRowIndex?["行号",...a]:a,preview:l.value.addRowIndex?e.map((s,i)=>[String(i+1),...s]):e,rows:100,columns:a.length,removedRows:5,removedColumns:1}},M=()=>{const a=r.value.headers.join(","),e=r.value.preview.map(f=>f.join(",")),s=[a,...e].join(`
`),i=new Blob([s],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(i),p=document.createElement("a");p.href=x,p.download="cleaned_data.csv",p.click(),URL.revokeObjectURL(x),g("CSV文件已下载","success")},B=()=>{const a=r.value.headers.join("	"),e=r.value.preview.map(f=>f.join("	")),s=[a,...e].join(`
`),i=new Blob(["\uFEFF"+s],{type:"application/vnd.ms-excel"}),x=URL.createObjectURL(i),p=document.createElement("a");p.href=x,p.download="cleaned_data.xls",p.click(),URL.revokeObjectURL(x),g("Excel文件已下载","success")},W=a=>{if(a===0)return"0 Bytes";const e=1024,s=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(a)/Math.log(e));return Math.round(a/Math.pow(e,i)*100)/100+" "+s[i]},g=(a,e)=>{y.value=a,_.value=e,setTimeout(()=>{y.value=""},3e3)};return(a,e)=>(u(),I(H,{title:"数据清洗工具",description:"清洗和标准化Excel数据"},{default:L(()=>[t("div",O,[t("div",q,[t("input",{ref_key:"fileInput",ref:C,type:"file",accept:".xlsx,.xls,.csv",onChange:V,class:"hidden"},null,544),t("div",{onClick:z,onDragover:e[0]||(e[0]=R(()=>{},["prevent"])),onDrop:R(U,["prevent"]),class:"cursor-pointer"},[...e[14]||(e[14]=[t("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),t("p",{class:"text-text-primary mb-2"},"点击或拖拽Excel/CSV文件到此处",-1),t("p",{class:"text-sm text-text-secondary"},"支持 .xlsx, .xls, .csv 格式",-1)])],32)]),t("div",A,[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-text-primary"},"清洗选项",-1)),t("div",G,[t("div",K,[e[18]||(e[18]=t("h4",{class:"font-medium text-text-primary"},"空值处理",-1)),t("div",$,[d(t("input",{id:"removeEmptyRows","onUpdate:modelValue":e[1]||(e[1]=s=>l.value.removeEmptyRows=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,J),[[n,l.value.removeEmptyRows]]),e[15]||(e[15]=t("label",{for:"removeEmptyRows",class:"text-sm text-text-secondary"},"删除空行",-1))]),t("div",P,[d(t("input",{id:"removeEmptyColumns","onUpdate:modelValue":e[2]||(e[2]=s=>l.value.removeEmptyColumns=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,Q),[[n,l.value.removeEmptyColumns]]),e[16]||(e[16]=t("label",{for:"removeEmptyColumns",class:"text-sm text-text-secondary"},"删除空列",-1))]),t("div",X,[d(t("input",{id:"fillEmptyWith","onUpdate:modelValue":e[3]||(e[3]=s=>l.value.fillEmptyWith=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,Y),[[n,l.value.fillEmptyWith]]),e[17]||(e[17]=t("label",{for:"fillEmptyWith",class:"text-sm text-text-secondary"},"填充空值为:",-1)),d(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l.value.fillValue=s),type:"text",placeholder:"默认值",class:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-primary focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!o.value||!l.value.fillEmptyWith},null,8,Z),[[T,l.value.fillValue]])])]),t("div",ee,[e[23]||(e[23]=t("h4",{class:"font-medium text-text-primary"},"文本处理",-1)),t("div",te,[d(t("input",{id:"trimWhitespace","onUpdate:modelValue":e[5]||(e[5]=s=>l.value.trimWhitespace=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,se),[[n,l.value.trimWhitespace]]),e[19]||(e[19]=t("label",{for:"trimWhitespace",class:"text-sm text-text-secondary"},"去除首尾空格",-1))]),t("div",le,[d(t("input",{id:"removeDuplicates","onUpdate:modelValue":e[6]||(e[6]=s=>l.value.removeDuplicates=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,oe),[[n,l.value.removeDuplicates]]),e[20]||(e[20]=t("label",{for:"removeDuplicates",class:"text-sm text-text-secondary"},"删除重复行",-1))]),t("div",ae,[d(t("input",{id:"standardizeCase","onUpdate:modelValue":e[7]||(e[7]=s=>l.value.standardizeCase=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,re),[[n,l.value.standardizeCase]]),e[22]||(e[22]=t("label",{for:"standardizeCase",class:"text-sm text-text-secondary"},"统一大小写:",-1)),d(t("select",{"onUpdate:modelValue":e[8]||(e[8]=s=>l.value.caseType=s),class:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-primary focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!o.value||!l.value.standardizeCase},[...e[21]||(e[21]=[t("option",{value:"lower"},"小写",-1),t("option",{value:"upper"},"大写",-1),t("option",{value:"title"},"首字母大写",-1)])],8,de),[[F,l.value.caseType]])])])]),t("div",ie,[t("div",ne,[e[27]||(e[27]=t("h4",{class:"font-medium text-text-primary"},"数据格式",-1)),t("div",ue,[d(t("input",{id:"removeSpecialChars","onUpdate:modelValue":e[9]||(e[9]=s=>l.value.removeSpecialChars=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,ce),[[n,l.value.removeSpecialChars]]),e[24]||(e[24]=t("label",{for:"removeSpecialChars",class:"text-sm text-text-secondary"},"去除特殊字符",-1))]),t("div",pe,[d(t("input",{id:"standardizeDates","onUpdate:modelValue":e[10]||(e[10]=s=>l.value.standardizeDates=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,me),[[n,l.value.standardizeDates]]),e[25]||(e[25]=t("label",{for:"standardizeDates",class:"text-sm text-text-secondary"},"标准化日期格式",-1))]),t("div",xe,[d(t("input",{id:"standardizeNumbers","onUpdate:modelValue":e[11]||(e[11]=s=>l.value.standardizeNumbers=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,ve),[[n,l.value.standardizeNumbers]]),e[26]||(e[26]=t("label",{for:"standardizeNumbers",class:"text-sm text-text-secondary"},"标准化数字格式",-1))])]),t("div",be,[e[30]||(e[30]=t("h4",{class:"font-medium text-text-primary"},"高级选项",-1)),t("div",ye,[d(t("input",{id:"removeHeaderRow","onUpdate:modelValue":e[12]||(e[12]=s=>l.value.removeHeaderRow=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,ge),[[n,l.value.removeHeaderRow]]),e[28]||(e[28]=t("label",{for:"removeHeaderRow",class:"text-sm text-text-secondary"},"删除标题行",-1))]),t("div",fe,[d(t("input",{id:"addRowIndex","onUpdate:modelValue":e[13]||(e[13]=s=>l.value.addRowIndex=s),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.value},null,8,we),[[n,l.value.addRowIndex]]),e[29]||(e[29]=t("label",{for:"addRowIndex",class:"text-sm text-text-secondary"},"添加行号列",-1))])])]),t("button",{onClick:S,disabled:b.value||!o.value,class:"w-full py-3 px-4 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"},c(b.value?"处理中...":o.value?"清洗数据":"请先选择Excel/CSV文件"),9,he)]),o.value?(u(),m("div",ke,[t("div",{class:"flex items-center justify-between"},[e[32]||(e[32]=t("h3",{class:"text-lg font-semibold text-text-primary"},"文件信息",-1)),t("button",{onClick:D,class:"px-3 py-1.5 bg-red-500 text-white text-sm rounded-lg hover:bg-red-600 transition-colors"}," 清除文件 ")]),t("div",Ce,[t("p",_e,[e[33]||(e[33]=t("strong",null,"文件名:",-1)),E(" "+c(o.value.name),1)]),t("p",Re,[e[34]||(e[34]=t("strong",null,"大小:",-1)),E(" "+c(W(o.value.size)),1)])])])):w("",!0),r.value?(u(),m("div",Ee,[t("div",{class:"flex items-center justify-between"},[e[35]||(e[35]=t("h3",{class:"text-lg font-semibold text-text-primary"},"清洗结果",-1)),t("div",{class:"flex gap-2"},[t("button",{onClick:M,class:"px-3 py-1.5 bg-green-500 text-white text-sm rounded-lg hover:bg-green-600 transition-colors"}," 下载CSV "),t("button",{onClick:B,class:"px-3 py-1.5 bg-blue-500 text-white text-sm rounded-lg hover:bg-blue-600 transition-colors"}," 下载Excel ")])]),t("div",ze,[t("div",Ve,[t("div",null,[t("p",Ue,c(r.value.rows),1),e[36]||(e[36]=t("p",{class:"text-sm text-text-secondary"},"总行数",-1))]),t("div",null,[t("p",De,c(r.value.columns),1),e[37]||(e[37]=t("p",{class:"text-sm text-text-secondary"},"总列数",-1))]),t("div",null,[t("p",Se,c(r.value.removedRows),1),e[38]||(e[38]=t("p",{class:"text-sm text-text-secondary"},"删除行数",-1))]),t("div",null,[t("p",je,c(r.value.removedColumns),1),e[39]||(e[39]=t("p",{class:"text-sm text-text-secondary"},"删除列数",-1))])])]),t("div",Me,[t("table",Be,[t("thead",null,[t("tr",We,[(u(!0),m(h,null,k(r.value.headers,(s,i)=>(u(),m("th",{key:i,class:"px-2 py-2 text-left font-medium text-text-primary"},c(s),1))),128))])]),t("tbody",null,[(u(!0),m(h,null,k(r.value.preview,(s,i)=>(u(),m("tr",{key:i,class:"border-b border-gray-100"},[(u(!0),m(h,null,k(s,(x,p)=>(u(),m("td",{key:p,class:"px-2 py-2 text-text-secondary"},c(x),1))),128))]))),128))])])])])):w("",!0),y.value?(u(),m("div",{key:2,class:N(["fixed top-4 right-4 px-4 py-2 rounded-lg shadow-lg z-50",_.value==="success"?"bg-green-500 text-white":"bg-red-500 text-white"])},c(y.value),3)):w("",!0)])]),_:1}))}};export{He as default};
