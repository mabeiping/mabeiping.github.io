import{c,a as e,t as u,f as g,F as M,r as B,j as f,y,s as V,x as O,m as R,l as a,o as v,q as U,v as $}from"./-R7zUpUx.js";import{s as A}from"./CI8PMl9t.js";import{_ as E}from"./DlAUqK2U.js";const j={class:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md"},N={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center"},P=["accept"],D={key:0,class:"mt-4 p-3 bg-gray-50 rounded"},L={class:"font-medium"},q={class:"text-gray-500 ml-2"},G={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},K=["value"],T={class:"group"},H={class:"mt-3 p-4 border rounded-lg"},J={class:"space-y-3"},Q={class:"flex items-center"},W={class:"flex items-center"},X={class:"flex items-center"},Y=["disabled"],Z={key:0,class:"mt-6"},ee={class:"w-full bg-gray-200 rounded-full h-2.5"},le={class:"text-center mt-2 text-gray-600"},te={key:1,class:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg"},se={class:"text-green-600 mb-4"},oe=["href"],ne={key:2,class:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg"},ae={class:"text-red-600"},re={__name:"index",setup(ue){const x=a(null),o=a(null),i=a("ics"),p=a(!1),d=a(0),m=a(null),n=a(null),r=a({includeAllFields:!0,optimizeForOutlook:!1,includeRecurrence:!0}),_=R(()=>".ics,.csv,.xls,.xlsx"),h=[{value:"ics",label:"ICS",description:"通用日历格式"},{value:"csv",label:"CSV",description:"逗号分隔值格式"},{value:"xlsx",label:"Excel",description:"Microsoft Excel格式"}],k=s=>{const l=s.target.files[0];l&&(o.value=l,n.value=null)},F=()=>{o.value=null,x.value.value=""},w=s=>{if(s===0)return"0 Bytes";const l=1024,t=["Bytes","KB","MB","GB"],b=Math.floor(Math.log(s)/Math.log(l));return parseFloat((s/Math.pow(l,b)).toFixed(2))+" "+t[b]},C=s=>{const l=h.find(t=>t.value===s);return l?l.label:s},z=()=>new Promise(s=>{const l=A(()=>{d.value+=5,d.value>=100&&(clearInterval(l),setTimeout(s,500))},200)}),S=async()=>{if(!o.value){n.value="请选择要转换的文件";return}p.value=!0,d.value=0,n.value=null;try{await z(),m.value={downloadUrl:"#",fileName:o.value.name.replace(/\.[^/.]+$/,`.${i.value}`),fileSize:o.value.size}}catch{n.value="转换失败，请重试"}finally{p.value=!1}},I=()=>{o.value=null,x.value.value="",i.value="ics",m.value=null,d.value=0,n.value=null,r.value={includeAllFields:!0,optimizeForOutlook:!1,includeRecurrence:!0}};return(s,l)=>(v(),c("div",j,[l[13]||(l[13]=e("h1",{class:"text-2xl font-bold mb-6 text-center"},"日历格式转换",-1)),l[14]||(l[14]=e("div",{class:"mb-8"},[e("p",{class:"text-gray-600 mb-4"},"支持ICS与其他日历格式互转，操作简单快捷")],-1)),e("form",{onSubmit:V(S,["prevent"]),class:"space-y-6"},[e("div",N,[e("input",{type:"file",ref_key:"fileInput",ref:x,class:"hidden",accept:_.value,onChange:k},null,40,P),e("button",{type:"button",onClick:l[0]||(l[0]=t=>s.$refs.fileInput.click()),class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300"}," 选择文件 "),l[6]||(l[6]=e("p",{class:"text-gray-500 mt-2"},"支持 ICS、CSV、Excel 等格式",-1)),o.value?(v(),c("div",D,[e("span",L,u(o.value.name),1),e("span",q,"("+u(w(o.value.size))+")",1),e("button",{type:"button",onClick:F,class:"ml-2 text-red-500 hover:text-red-700"}," 移除 ")])):g("",!0)]),e("div",null,[l[7]||(l[7]=e("label",{class:"block text-gray-700 font-medium mb-2"},"转换为",-1)),e("div",G,[(v(),c(M,null,B(h,t=>e("label",{key:t.value,class:U(["flex items-center p-3 border rounded-lg cursor-pointer hover:border-blue-500 transition duration-200",{"border-blue-500 bg-blue-50":i.value===t.value}])},[f(e("input",{type:"radio",value:t.value,"onUpdate:modelValue":l[1]||(l[1]=b=>i.value=b),class:"mr-2"},null,8,K),[[$,i.value]]),e("span",null,u(t.label),1)],2)),64))])]),e("div",null,[e("details",T,[l[11]||(l[11]=e("summary",{class:"cursor-pointer list-none flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("span",{class:"font-medium"},"高级选项"),e("span",{class:"transition-transform duration-300 group-open:rotate-180"},"▼")],-1)),e("div",H,[e("div",J,[e("label",Q,[f(e("input",{type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=t=>r.value.includeAllFields=t),class:"mr-2"},null,512),[[y,r.value.includeAllFields]]),l[8]||(l[8]=e("span",null,"包含所有字段",-1))]),e("label",W,[f(e("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=t=>r.value.optimizeForOutlook=t),class:"mr-2"},null,512),[[y,r.value.optimizeForOutlook]]),l[9]||(l[9]=e("span",null,"优化为Outlook使用",-1))]),e("label",X,[f(e("input",{type:"checkbox","onUpdate:modelValue":l[4]||(l[4]=t=>r.value.includeRecurrence=t),class:"mr-2"},null,512),[[y,r.value.includeRecurrence]]),l[10]||(l[10]=e("span",null,"包含重复事件",-1))])])])])]),e("button",{type:"submit",disabled:!o.value||p.value,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},u(p.value?"转换中...":"开始转换"),9,Y)],32),p.value?(v(),c("div",Z,[e("div",ee,[e("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:O({width:d.value+"%"})},null,4)]),e("p",le,u(d.value)+"%",1)])):g("",!0),m.value?(v(),c("div",te,[l[12]||(l[12]=e("h3",{class:"font-semibold text-green-700 mb-2"},"转换成功",-1)),e("p",se,"文件已成功转换为 "+u(C(i.value))+" 格式",1),e("a",{href:m.value.downloadUrl,class:"inline-block bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300",download:""}," 下载文件 ",8,oe),e("button",{onClick:I,class:"ml-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-lg transition duration-300"}," 再次转换 ")])):g("",!0),n.value?(v(),c("div",ne,[e("p",ae,u(n.value),1),e("button",{onClick:l[5]||(l[5]=t=>n.value=null),class:"mt-2 text-red-600 hover:text-red-800 text-sm"}," 关闭 ")])):g("",!0)]))}},ve=E(re,[["__scopeId","data-v-1d32b1c0"]]);export{ve as default};
