const e={SecretId:"your-secret-id",SecretKey:"your-secret-key",Region:"your-region"},t={pdfSplit:"pdf-split-function",pdfMerge:"pdf-merge-function",pdfEdit:"pdf-edit-function",pdfWatermark:"pdf-watermark-function"},a={pdfSplit:"your-pdf-split-endpoint",pdfMerge:"your-pdf-merge-endpoint",pdfEdit:"your-pdf-edit-endpoint",pdfWatermark:"your-pdf-watermark-endpoint"},r={baseUrl:"http://localhost:8002",endpoints:{pdfSplit:"/api/pdf/split",pdfMerge:"/api/pdf/merge",pdfEdit:"/api/pdf/edit",pdfWatermark:"/api/pdf/watermark",formatConvert:"/api/format-convert",queueStatus:"/api/queue-status"}};const i=new class{constructor(){this.scfConfig=e,this.functionNames=t,this.scfHttpEndpoints=a}validateParams(e,t){const a={pdfSplit:{required:["file","splitMode"],conditional:{splitMode:{range:["pageRange"]}}},pdfMerge:{required:["files"]},pdfEdit:{required:["file","editFeature"],conditional:{editFeature:{text:["textContent","fontSize"],page:["pageOperation"]}}},pdfWatermark:{required:["file","watermarkType","watermarkPosition","watermarkOpacity"],conditional:{watermarkType:{text:["watermarkText","fontSize"],image:["watermarkImage"]}}},pdfExtract:{required:["file","extractFeature"],conditional:{extractFeature:{image:["imageFormat"],table:["tableFormat"]}}},formatConvert:{required:["files","source_format","target_format"],conditional:{target_format:{jpg:["quality"],jpeg:["quality"],webp:["quality"]}}},queueStatus:{required:[]}}[e];if(!a)throw new Error(`No validation rules for function: ${e}`);for(const r of a.required)if(!t[r])throw new Error(`Missing required parameter: ${r}`);if(a.conditional)for(const[r,i]of Object.entries(a.conditional)){const e=t[r];if(e&&i[e])for(const a of i[e])if(!t[a])throw new Error(`Missing required parameter: ${a} (required when ${r} is ${e})`)}if(t.file&&!(t.file instanceof File))throw new Error("Invalid file parameter: must be a File object");if(t.files&&(!Array.isArray(t.files)||!t.files.every(e=>e instanceof File)))throw new Error("Invalid files parameter: must be an array of File objects");if(t.watermarkImage&&!(t.watermarkImage instanceof File))throw new Error("Invalid watermarkImage parameter: must be a File object");return{valid:!0}}normalizeParams(e,t){const a={...t};return a.fontSize&&(a.fontSize=Number(a.fontSize)),a.watermarkOpacity&&(a.watermarkOpacity=Number(a.watermarkOpacity)),a}async invokeLocalBackend(e,t){try{const a=(e=>{const t=r.endpoints[e];if(!t)throw new Error(`No local endpoint configured for: ${e}`);return`${r.baseUrl}${t}`})(e);if(t.files||t.file){const r=new FormData;if(t.files&&Array.isArray(t.files)&&t.files.length>0&&t.files.forEach(e=>{r.append("files",e)}),t.file&&r.append("file",t.file),t.watermarkImage&&r.append("watermarkImage",t.watermarkImage),t.source_format&&r.append("source_format",t.source_format),t.target_format&&r.append("target_format",t.target_format),t.process_mode&&r.append("process_mode",t.process_mode),t.quality&&r.append("quality",t.quality),t.pageRange){const e=t.pageRange.replace(/[,ï¼Œ\s]+/g,",");r.append("page_range",e)}t.splitMode&&r.append("splitMode",t.splitMode),t.watermarkType&&r.append("watermarkType",t.watermarkType),t.watermarkText&&r.append("watermarkText",t.watermarkText),t.watermarkPosition&&r.append("watermarkPosition",t.watermarkPosition),t.watermarkOpacity&&r.append("watermarkOpacity",t.watermarkOpacity),t.fontSize&&r.append("fontSize",t.fontSize),t.editFeature&&r.append("editFeature",t.editFeature),t.textContent&&r.append("textContent",t.textContent),t.pageOperation&&r.append("pageOperation",t.pageOperation),t.imageFile&&r.append("imageFile",t.imageFile),t.imagePosition&&r.append("imagePosition",t.imagePosition),t.metadataTitle&&r.append("metadataTitle",t.metadataTitle),t.metadataAuthor&&r.append("metadataAuthor",t.metadataAuthor),t.metadataSubject&&r.append("metadataSubject",t.metadataSubject),t.metadataKeywords&&r.append("metadataKeywords",t.metadataKeywords),t.extractFeature&&r.append("extractFeature",t.extractFeature),t.imageFormat&&r.append("imageFormat",t.imageFormat),t.tableFormat&&r.append("tableFormat",t.tableFormat),t.extractOptions&&r.append("extractOptions",JSON.stringify(t.extractOptions));const i=await fetch(a,{method:"POST",body:r});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);if("formatConvert"===e){return await i.json()}return await i.blob()}{const e=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}}catch(a){throw a}}async invokeBackend(e,t){try{this.validateParams(e,t);const a=this.normalizeParams(e,t);return await this.invokeLocalBackend(e,a)}catch(a){throw a}}async pdfSplit(e){return this.invokeBackend("pdfSplit",e)}async pdfMerge(e){return this.invokeBackend("pdfMerge",e)}async pdfEdit(e){return this.invokeBackend("pdfEdit",e)}async pdfWatermark(e){return this.invokeBackend("pdfWatermark",e)}async pdfExtract(e){return this.invokeBackend("pdfExtract",e)}async formatConvert(e){return this.invokeBackend("formatConvert",e)}async queueStatus(){return this.invokeBackend("queueStatus",{})}};export{i as default};
