import{j as e,w as l,o as t,a,b as o,c as s,F as u,p as n,t as i,l as r,q as d,s as c,y as m,C as p,d as v,B as b,r as g,x}from"./DH083wp6.js";import{_ as y}from"./CAtw_IK7.js";import{G as f}from"./rVeU8pxj.js";import{s as h}from"./C7-50Fh1.js";import"./DfP8px5f.js";import"./DySTNCTN.js";import"./Cn6QgdFK.js";import"./COX2iPvM.js";import"./BCo6x5W8.js";const k={class:"space-y-6"},w={key:0,class:"bg-gray-50 p-4 rounded-lg"},U={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},j={class:"flex justify-center mb-3"},z=["src"],V={class:"text-center"},B={class:"font-medium truncate"},C={class:"text-sm text-gray-500"},M=["onClick"],R={key:1,class:"space-y-4"},S={class:"bg-gray-50 p-4 rounded-lg"},q={class:"space-y-3"},L={class:"text-right text-sm text-gray-500"},W={class:"flex items-center space-x-2"},_={class:"flex items-center space-x-2"},H={class:"bg-gray-50 p-4 rounded-lg"},P={class:"space-y-3"},$={key:0,class:"grid grid-cols-2 gap-2"},D={key:1},F={key:0,class:"mt-2 flex items-center space-x-2"},G={class:"bg-gray-50 p-4 rounded-lg"},E={class:"space-y-3"},K={class:"flex items-center space-x-2"},O={key:0,class:"space-y-2"},T={class:"text-right text-sm text-gray-500"},A={class:"text-right text-sm text-gray-500"},I={class:"flex space-x-4"},J=["disabled"],N={key:0},Y={key:1,class:"flex items-center justify-center"},Z={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Q={class:"flex items-center justify-between mb-2"},X={class:"text-blue-700"},ee={class:"w-full bg-gray-200 rounded-full h-2.5"},le={class:"mt-2 text-sm text-blue-700"},te={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},ae={class:"mt-2 text-green-700"},oe={class:"mt-3 space-y-2"},se=["href","download"],ue={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ne={class:"mt-2 text-red-700"},ie={key:0,class:"mt-2 text-sm text-gray-600"},re={__name:"index",setup(re){const de=g({quality:70,targetSize:1,targetSizeUnit:"MB",keepDimensions:!0}),ce=g({mode:"none",width:0,height:0,aspectRatio:"1:1",customWidth:1,customHeight:1}),me=g({enabled:!1,text:"Watermark",position:"bottom-right",opacity:30,size:20}),pe=g([]),ve=x(()=>pe.value),be=g(!1),ge=g(!1),xe=g(""),ye=g(""),fe=g(""),he=g(0),ke=g(""),we=g([]),Ue=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 设置压缩参数：调整压缩质量和目标文件大小","3. 配置裁剪选项：选择裁剪模式和尺寸","4. 添加水印（可选）：设置水印文字、位置和透明度",'5. 点击"开始处理"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保图片质量和大小符合要求"],je=e=>e.split(".").pop().toLowerCase(),ze=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},Ve=e=>{pe.value=e,ye.value="",ge.value=!1},Be=e=>{ye.value=e,fe.value=Ce(e)},Ce=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Me=async()=>{if(0!==ve.length){be.value=!0,ye.value="",fe.value="",ge.value=!1,he.value=0,ke.value="准备处理...",we.value=[];try{await new Promise(e=>{let l=0;const t=h(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),he.value=l,ke.value=l<30?"正在分析图片...":l<60?"正在压缩图片...":l<90?"正在应用裁剪和水印...":"正在生成结果...",100===l&&(clearInterval(t),setTimeout(e,500))},500)});ve.value,de.value,ce.value,me.value;xe.value=`成功处理 ${ve.length} 个图片！`,ge.value=!0,ve.forEach((e,l)=>{const t=je(e.name),a=new Blob(["模拟处理后的图片内容"],{type:`image/${t}`}),o=URL.createObjectURL(a),s=`compressed_${e.name}`;we.value.push({url:o,filename:s})}),we.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=we.value[0].url,e.download=we.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){ye.value=`处理失败：${e.message||"未知错误"}`,fe.value=Ce(ye.value)}finally{be.value=!1}}else ye.value="请选择文件"},Re=()=>{pe.value=[],de.value={quality:70,targetSize:1,targetSizeUnit:"MB",keepDimensions:!0},ce.value={mode:"none",width:0,height:0,aspectRatio:"1:1",customWidth:1,customHeight:1},me.value={enabled:!1,text:"Watermark",position:"bottom-right",opacity:30,size:20},ye.value="",fe.value="",ge.value=!1,xe.value="",he.value=0,ke.value="",we.value=[]};return(g,x)=>(t(),e(y,{title:"图片压缩处理",description:"支持图片高清压缩裁剪加水印",tips:Ue},{default:l(()=>[a("div",k,[o(f,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":104857600,modelValue:pe.value,"onUpdate:modelValue":x[0]||(x[0]=e=>pe.value=e),onFilesChanged:Ve,onError:Be},null,8,["modelValue"]),ve.value.length>0?(t(),s("div",w,[x[16]||(x[16]=a("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),a("div",U,[(t(!0),s(u,null,n(ve.value,(e,l)=>(t(),s("div",{key:l,class:"bg-white rounded border p-3"},[a("div",j,[a("img",{src:g.URL.createObjectURL(e),class:"max-h-32 object-contain",alt:"Preview"},null,8,z)]),a("div",V,[a("div",B,i(e.name),1),a("div",C,i(je(e.name))+" • "+i(ze(e.size)),1)]),a("button",{onClick:e=>(e=>{pe.value.splice(e,1),0===pe.value.length&&Re()})(l),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,M)]))),128))])])):r("",!0),ve.value.length>0?(t(),s("div",R,[a("div",S,[x[21]||(x[21]=a("h3",{class:"text-lg font-semibold mb-3"},"压缩设置",-1)),a("div",q,[a("div",null,[x[17]||(x[17]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"压缩质量",-1)),d(a("input",{"onUpdate:modelValue":x[1]||(x[1]=e=>de.value.quality=e),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[c,de.value.quality,void 0,{number:!0}]]),a("div",L,i(de.value.quality)+"%",1)]),a("div",null,[x[19]||(x[19]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"目标文件大小",-1)),a("div",W,[d(a("input",{"onUpdate:modelValue":x[2]||(x[2]=e=>de.value.targetSize=e),type:"number",min:"0.1",step:"0.1",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,de.value.targetSize,void 0,{number:!0}]]),d(a("select",{"onUpdate:modelValue":x[3]||(x[3]=e=>de.value.targetSizeUnit=e),class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[18]||(x[18]=[a("option",{value:"KB"},"KB",-1),a("option",{value:"MB"},"MB",-1)])],512),[[m,de.value.targetSizeUnit]])])]),a("div",null,[a("label",_,[d(a("input",{type:"checkbox","onUpdate:modelValue":x[4]||(x[4]=e=>de.value.keepDimensions=e),class:"w-4 h-4 text-blue-600"},null,512),[[p,de.value.keepDimensions]]),x[20]||(x[20]=a("span",null,"保持原始尺寸",-1))])])])]),a("div",H,[x[27]||(x[27]=a("h3",{class:"text-lg font-semibold mb-3"},"裁剪设置",-1)),a("div",P,[a("div",null,[x[23]||(x[23]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"裁剪模式",-1)),d(a("select",{"onUpdate:modelValue":x[5]||(x[5]=e=>ce.value.mode=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[22]||(x[22]=[a("option",{value:"none"},"不裁剪",-1),a("option",{value:"custom"},"自定义尺寸",-1),a("option",{value:"aspect"},"按比例裁剪",-1),a("option",{value:"square"},"裁剪为正方形",-1)])],512),[[m,ce.value.mode]])]),"custom"===ce.value.mode?(t(),s("div",$,[d(a("input",{"onUpdate:modelValue":x[6]||(x[6]=e=>ce.value.width=e),type:"number",placeholder:"宽度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.width,void 0,{number:!0}]]),d(a("input",{"onUpdate:modelValue":x[7]||(x[7]=e=>ce.value.height=e),type:"number",placeholder:"高度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.height,void 0,{number:!0}]])])):r("",!0),"aspect"===ce.value.mode?(t(),s("div",D,[x[26]||(x[26]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"宽高比",-1)),d(a("select",{"onUpdate:modelValue":x[8]||(x[8]=e=>ce.value.aspectRatio=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[24]||(x[24]=[a("option",{value:"1:1"},"1:1",-1),a("option",{value:"4:3"},"4:3",-1),a("option",{value:"16:9"},"16:9",-1),a("option",{value:"3:2"},"3:2",-1),a("option",{value:"custom"},"自定义",-1)])],512),[[m,ce.value.aspectRatio]]),"custom"===ce.value.aspectRatio?(t(),s("div",F,[d(a("input",{"onUpdate:modelValue":x[9]||(x[9]=e=>ce.value.customWidth=e),type:"number",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.customWidth,void 0,{number:!0}]]),x[25]||(x[25]=a("span",null,":",-1)),d(a("input",{"onUpdate:modelValue":x[10]||(x[10]=e=>ce.value.customHeight=e),type:"number",class:"flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,ce.value.customHeight,void 0,{number:!0}]])])):r("",!0)])):r("",!0)])]),a("div",G,[x[34]||(x[34]=a("h3",{class:"text-lg font-semibold mb-3"},"水印设置",-1)),a("div",E,[a("div",null,[a("label",K,[d(a("input",{type:"checkbox","onUpdate:modelValue":x[11]||(x[11]=e=>me.value.enabled=e),class:"w-4 h-4 text-blue-600"},null,512),[[p,me.value.enabled]]),x[28]||(x[28]=a("span",null,"添加水印",-1))])]),me.value.enabled?(t(),s("div",O,[a("div",null,[x[29]||(x[29]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印文字",-1)),d(a("input",{"onUpdate:modelValue":x[12]||(x[12]=e=>me.value.text=e),type:"text",placeholder:"请输入水印文字",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,me.value.text]])]),a("div",null,[x[31]||(x[31]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印位置",-1)),d(a("select",{"onUpdate:modelValue":x[13]||(x[13]=e=>me.value.position=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[30]||(x[30]=[a("option",{value:"top-left"},"左上角",-1),a("option",{value:"top-right"},"右上角",-1),a("option",{value:"bottom-left"},"左下角",-1),a("option",{value:"bottom-right"},"右下角",-1),a("option",{value:"center"},"居中",-1)])],512),[[m,me.value.position]])]),a("div",null,[x[32]||(x[32]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印透明度",-1)),d(a("input",{"onUpdate:modelValue":x[14]||(x[14]=e=>me.value.opacity=e),type:"range",min:"0",max:"100",class:"w-full"},null,512),[[c,me.value.opacity,void 0,{number:!0}]]),a("div",T,i(me.value.opacity)+"%",1)]),a("div",null,[x[33]||(x[33]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印大小",-1)),d(a("input",{"onUpdate:modelValue":x[15]||(x[15]=e=>me.value.size=e),type:"range",min:"10",max:"50",class:"w-full"},null,512),[[c,me.value.size,void 0,{number:!0}]]),a("div",A,i(me.value.size)+"px",1)])])):r("",!0)])])])):r("",!0),a("div",I,[a("button",{onClick:Me,disabled:!ve.value.length||be.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[be.value?(t(),s("span",Y,[x[35]||(x[35]=a("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),v(" 处理中... "+i(he.value)+"% ",1)])):(t(),s("span",N,"开始处理"))],8,J),a("button",{onClick:Re,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),be.value?(t(),s("div",Z,[a("div",Q,[x[36]||(x[36]=a("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),a("span",X,i(he.value)+"%",1)]),a("div",ee,[a("div",{class:"bg-blue-600 h-2.5 rounded-full",style:b({width:he.value+"%"})},null,4)]),a("p",le,i(ke.value),1)])):r("",!0),ge.value?(t(),s("div",te,[x[37]||(x[37]=a("div",{class:"flex items-center"},[a("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),a("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),a("p",ae,i(xe.value),1),a("div",oe,[(t(!0),s(u,null,n(we.value,(e,l)=>(t(),s("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载处理结果 "+i(l+1),9,se))),128))])])):r("",!0),ye.value?(t(),s("div",ue,[x[38]||(x[38]=a("div",{class:"flex items-center"},[a("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),a("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),a("p",ne,i(ye.value),1),fe.value?(t(),s("p",ie,"建议："+i(fe.value),1)):r("",!0)])):r("",!0)])]),_:1}))}};export{re as default};
