import{i as X,w as I,o,a as e,b as J,c as n,F as C,r as B,t as r,f as b,j as f,v as R,y as M,p as U,d as K,x as W,l as i,m as Y}from"./-R7zUpUx.js";import{_ as q}from"./1SagYtif.js";import{G as Q}from"./zseaTYbb.js";import{s as Z}from"./CI8PMl9t.js";import"./C_FLJhYl.js";import"./Cu7bTl1K.js";import"./DlAUqK2U.js";const ee={class:"space-y-6"},le={key:0,class:"bg-gray-50 p-4 rounded-lg"},te={class:"space-y-2"},se={class:"flex items-center"},oe={class:"font-medium"},ne={class:"text-sm text-gray-500"},ae=["onClick"],ie={key:1,class:"bg-gray-50 p-4 rounded-lg"},re={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},ue=["value"],de={class:"font-medium"},ve={class:"text-sm text-gray-500"},ce={key:2,class:"space-y-4"},me={class:"space-y-2"},pe={class:"flex items-center space-x-2"},be={class:"flex items-center space-x-2"},ge={class:"flex items-center space-x-2"},fe={key:0,class:"bg-white p-4 rounded-lg border"},xe={class:"space-y-2"},he={class:"flex items-center space-x-2"},ye={class:"flex space-x-4"},ke=["disabled"],we={key:0},_e={key:1,class:"flex items-center justify-center"},Me={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Fe={class:"flex items-center justify-between mb-2"},Ce={class:"text-blue-700"},Be={class:"w-full bg-gray-200 rounded-full h-2.5"},ze={class:"mt-2 text-sm text-blue-700"},Ve={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Le={class:"mt-2 text-green-700"},Se={class:"mt-3 space-y-2"},Te=["href","download"],je={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ue={class:"mt-2 text-red-700"},De={key:0,class:"mt-2 text-sm text-gray-600"},Xe={__name:"index",setup(Ee){const z=[{value:"stl",label:"STL (.stl)",description:"立体光刻格式",extensions:[".stl"]},{value:"obj",label:"OBJ (.obj)",description:"Wavefront对象格式",extensions:[".obj"]},{value:"fbx",label:"FBX (.fbx)",description:"Autodesk FBX格式",extensions:[".fbx"]},{value:"gltf",label:"glTF (.gltf)",description:"GL传输格式",extensions:[".gltf"]},{value:"glb",label:"GLB (.glb)",description:"二进制glTF格式",extensions:[".glb"]},{value:"dae",label:"DAE (.dae)",description:"数字资产交换格式",extensions:[".dae"]},{value:"3ds",label:"3DS (.3ds)",description:"3D Studio格式",extensions:[".3ds"]},{value:"ply",label:"PLY (.ply)",description:"多边形文件格式",extensions:[".ply"]}],u=i(""),v=i({includeMaterials:!0,includeTextures:!0,optimizeModel:!1}),p=i({simplificationLevel:"none",meshCombining:"none",normalizeScale:!1}),c=i([]),m=Y(()=>c.value),w=i(!1),_=i(!1),F=i(""),d=i(""),x=i(""),h=i(0),y=i(""),g=i([]),k=i([]),D=["1. 上传文件：支持STL、OBJ、FBX等多种3D模型格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含材质、纹理，是否优化模型等",'5. 点击"开始转换"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保模型格式正确"],V=s=>s.split(".").pop().toLowerCase(),E=s=>{if(s===0)return"0 B";const l=1024,t=["B","KB","MB","GB"],a=Math.floor(Math.log(s)/Math.log(l));return parseFloat((s/Math.pow(l,a)).toFixed(2))+" "+t[a]},$=s=>{c.value.splice(s,1),c.value.length===0?T():L()},O=s=>{c.value=s,s.length>0?L():(k.value=[],u.value=""),d.value="",_.value=!1},L=()=>{if(c.value.length===0){k.value=[];return}const s=V(c.value[0].name),l=[];z.forEach(t=>{t.extensions.some(a=>s===a.replace(".",""))||l.push(t)}),k.value=l,l.length>0?u.value=l[0].value:u.value=""},H=s=>{d.value=s,x.value=S(s)},S=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",P=()=>new Promise(s=>{let l=0;const t=Z(()=>{l+=Math.floor(Math.random()*10)+5,l>100&&(l=100),h.value=l,l<30?y.value="正在分析3D模型...":l<70?y.value="正在转换格式...":y.value="正在生成结果...",l===100&&(clearInterval(t),setTimeout(s,500))},500)}),A=async()=>{if(m.length===0){d.value="请选择文件";return}if(!u.value){d.value="请选择目标格式";return}w.value=!0,d.value="",x.value="",_.value=!1,h.value=0,y.value="准备转换...",g.value=[];try{await P();const s={files:m.value,targetFormat:u.value,options:v.value,optimizeOptions:p.value};console.log("转换参数:",s);const l=z.find(t=>t.value===u.value);F.value=`成功将 ${m.length} 个文件转换为 ${l.label} 格式！`,_.value=!0,m.forEach((t,a)=>{const j=new Blob(["模拟转换后的3D模型内容"],{type:"application/octet-stream"}),G=URL.createObjectURL(j),N=`converted_${t.name.replace(/\.[^/.]+$/,`.${u.value}`)}`;g.value.push({url:G,filename:N})}),g.value.length>0&&setTimeout(()=>{const t=document.createElement("a");t.href=g.value[0].url,t.download=g.value[0].filename,document.body.appendChild(t),t.click(),document.body.removeChild(t)},1e3)}catch(s){d.value=`转换失败：${s.message||"未知错误"}`,x.value=S(d.value)}finally{w.value=!1}},T=()=>{c.value=[],u.value="",v.value={includeMaterials:!0,includeTextures:!0,optimizeModel:!1},p.value={simplificationLevel:"none",meshCombining:"none",normalizeScale:!1},d.value="",x.value="",_.value=!1,F.value="",h.value=0,y.value="",g.value=[],k.value=[]};return(s,l)=>(o(),X(q,{title:"3D模型转换",description:"STL/OBJ/FBX等3D模型格式互转",tips:D},{default:I(()=>[e("div",ee,[J(Q,{multiple:!0,accept:[".stl",".obj",".fbx",".gltf",".glb",".dae",".3ds",".ply"],"max-size":500*1024*1024,modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=t=>c.value=t),onFilesChanged:O,onError:H},null,8,["modelValue"]),m.value.length>0?(o(),n("div",le,[l[10]||(l[10]=e("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),e("div",te,[(o(!0),n(C,null,B(m.value,(t,a)=>(o(),n("div",{key:a,class:"flex items-center justify-between p-2 bg-white rounded border"},[e("div",se,[l[8]||(l[8]=e("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1)),e("div",null,[e("div",oe,r(t.name),1),e("div",ne,r(V(t.name))+" • "+r(E(t.size)),1)])]),e("button",{onClick:j=>$(a),class:"text-red-500 hover:text-red-700"},[...l[9]||(l[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ae)]))),128))])])):b("",!0),m.value.length>0&&k.value.length>0?(o(),n("div",ie,[l[11]||(l[11]=e("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),e("div",re,[(o(!0),n(C,null,B(k.value,t=>(o(),n("label",{key:t.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[f(e("input",{type:"radio","onUpdate:modelValue":l[1]||(l[1]=a=>u.value=a),value:t.value,class:"w-4 h-4 text-blue-600"},null,8,ue),[[R,u.value]]),e("div",null,[e("div",de,r(t.label),1),e("div",ve,r(t.description),1)])]))),128))])])):b("",!0),m.value.length>0?(o(),n("div",ce,[e("div",null,[l[15]||(l[15]=e("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),e("div",me,[e("label",pe,[f(e("input",{type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=t=>v.value.includeMaterials=t),class:"w-4 h-4 text-blue-600"},null,512),[[M,v.value.includeMaterials]]),l[12]||(l[12]=e("span",null,"包含材质",-1))]),e("label",be,[f(e("input",{type:"checkbox","onUpdate:modelValue":l[3]||(l[3]=t=>v.value.includeTextures=t),class:"w-4 h-4 text-blue-600"},null,512),[[M,v.value.includeTextures]]),l[13]||(l[13]=e("span",null,"包含纹理",-1))]),e("label",ge,[f(e("input",{type:"checkbox","onUpdate:modelValue":l[4]||(l[4]=t=>v.value.optimizeModel=t),class:"w-4 h-4 text-blue-600"},null,512),[[M,v.value.optimizeModel]]),l[14]||(l[14]=e("span",null,"优化模型",-1))])])]),v.value.optimizeModel?(o(),n("div",fe,[l[21]||(l[21]=e("h3",{class:"text-lg font-semibold mb-3"},"模型优化选项",-1)),e("div",xe,[e("div",null,[l[17]||(l[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"简化级别",-1)),f(e("select",{"onUpdate:modelValue":l[5]||(l[5]=t=>p.value.simplificationLevel=t),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...l[16]||(l[16]=[e("option",{value:"none"},"不简化",-1),e("option",{value:"low"},"低级别简化",-1),e("option",{value:"medium"},"中级别简化",-1),e("option",{value:"high"},"高级别简化",-1)])],512),[[U,p.value.simplificationLevel]])]),e("div",null,[l[19]||(l[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"网格合并",-1)),f(e("select",{"onUpdate:modelValue":l[6]||(l[6]=t=>p.value.meshCombining=t),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...l[18]||(l[18]=[e("option",{value:"none"},"不合并",-1),e("option",{value:"byMaterial"},"按材质合并",-1),e("option",{value:"all"},"全部合并",-1)])],512),[[U,p.value.meshCombining]])]),e("div",null,[e("label",he,[f(e("input",{type:"checkbox","onUpdate:modelValue":l[7]||(l[7]=t=>p.value.normalizeScale=t),class:"w-4 h-4 text-blue-600"},null,512),[[M,p.value.normalizeScale]]),l[20]||(l[20]=e("span",null,"归一化缩放",-1))])])])])):b("",!0)])):b("",!0),e("div",ye,[e("button",{onClick:A,disabled:!m.value.length||!u.value||w.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[w.value?(o(),n("span",_e,[l[22]||(l[22]=e("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),K(" 处理中... "+r(h.value)+"% ",1)])):(o(),n("span",we,"开始转换"))],8,ke),e("button",{onClick:T,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),w.value?(o(),n("div",Me,[e("div",Fe,[l[23]||(l[23]=e("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),e("span",Ce,r(h.value)+"%",1)]),e("div",Be,[e("div",{class:"bg-blue-600 h-2.5 rounded-full",style:W({width:h.value+"%"})},null,4)]),e("p",ze,r(y.value),1)])):b("",!0),_.value?(o(),n("div",Ve,[l[24]||(l[24]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),e("p",Le,r(F.value),1),e("div",Se,[(o(!0),n(C,null,B(g.value,(t,a)=>(o(),n("a",{key:a,href:t.url,download:t.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+r(a+1),9,Te))),128))])])):b("",!0),d.value?(o(),n("div",je,[l[25]||(l[25]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),e("p",Ue,r(d.value),1),x.value?(o(),n("p",De,"建议："+r(x.value),1)):b("",!0)])):b("",!0)])]),_:1}))}};export{Xe as default};
