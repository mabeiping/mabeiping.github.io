import{j as e,w as l,o as a,a as s,b as t,c as n,F as o,p as u,t as r,l as i,q as d,v as c,C as v,s as p,d as m,B as x,r as g,x as b}from"./BGpdZ-s9.js";import{_ as h}from"./B4wm4ekp.js";import{G as f}from"./BtAA_ILT.js";import{s as y}from"./C2gVa5gV.js";import"./DILYegs3.js";import"./D_BBTi0O.js";import"./9Oz-M6e1.js";import"./DKLvglw8.js";import"./BCo6x5W8.js";const w={class:"space-y-6"},k={key:0,class:"bg-gray-50 p-4 rounded-lg"},j={class:"space-y-2"},C={class:"flex items-center"},V={class:"font-medium"},z={class:"text-sm text-gray-500"},I=["onClick"],M={key:1,class:"bg-gray-50 p-4 rounded-lg"},B={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},_=["value"],U={class:"font-medium"},E={class:"text-sm text-gray-500"},F={key:2,class:"space-y-4"},P={class:"space-y-2"},A={class:"flex items-center space-x-2"},L={class:"flex items-center space-x-2"},$={class:"flex items-center space-x-2"},S={class:"space-y-2"},D={class:"flex items-center space-x-2"},H={class:"flex items-center space-x-2"},K={key:0},T={class:"flex space-x-4"},q=["disabled"],G={key:0},N={key:1,class:"flex items-center justify-center"},O={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},W={class:"flex items-center justify-between mb-2"},Y={class:"text-blue-700"},Z={class:"w-full bg-gray-200 rounded-full h-2.5"},J={class:"mt-2 text-sm text-blue-700"},Q={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},R={class:"mt-2 text-green-700"},X={class:"mt-3 space-y-2"},ee=["href","download"],le={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ae={class:"mt-2 text-red-700"},se={key:0,class:"mt-2 text-sm text-gray-600"},te={__name:"convert",setup(te){const ne={document:[{value:"docx",label:"Word (.docx)",description:"适合编辑文本内容",extensions:[".docx",".doc"]},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印",extensions:[".pdf"]},{value:"txt",label:"文本 (.txt)",description:"纯文本格式",extensions:[".txt"]},{value:"pages",label:"Pages (.pages)",description:"Apple Pages文档",extensions:[".pages"]}],spreadsheet:[{value:"xlsx",label:"Excel (.xlsx)",description:"适合处理表格数据",extensions:[".xlsx",".xls"]},{value:"csv",label:"CSV (.csv)",description:"逗号分隔值",extensions:[".csv"]},{value:"numbers",label:"Numbers (.numbers)",description:"Apple Numbers表格",extensions:[".numbers"]}],presentation:[{value:"pptx",label:"PPT (.pptx)",description:"适合演示文稿",extensions:[".pptx",".ppt"]},{value:"key",label:"Keynote (.key)",description:"Apple Keynote演示文稿",extensions:[".key"]}]},oe=g(""),ue=g("normal"),re=g({includeImages:!0,optimizeImages:!1}),ie=g(""),de=g([]),ce=b(()=>de.value),ve=g(!1),pe=g(!1),me=g(""),xe=g(""),ge=g(""),be=g(0),he=g(""),fe=g([]),ye=g([]),we=b(()=>{if(0===ce.length)return!1;const e=je(ce[0].name);return["docx","pdf","txt","pages"].includes(e)}),ke=["1. 上传文件：支持多种办公文件格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 选择转换模式：标准转换、保留布局或仅提取文本","5. 设置图片处理选项（可选）",'6. 点击"开始转换"按钮进行处理',"7. 等待转换完成，系统会自动下载转换后的文件","8. 查看转换结果，确保内容和格式的准确性"],je=e=>e.split(".").pop().toLowerCase(),Ce=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},Ve=e=>{de.value=e,e.length>0?ze():(ye.value=[],oe.value=""),xe.value="",pe.value=!1},ze=()=>{if(0===de.value.length)return void(ye.value=[]);const e=je(de.value[0].name),l=[];["docx","doc","pdf","txt","pages"].includes(e)?ne.document.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))||l.push(a)}):["xlsx","xls","csv","numbers"].includes(e)?ne.spreadsheet.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))||l.push(a)}):["pptx","ppt","key"].includes(e)&&ne.presentation.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))||l.push(a)}),ye.value=l,l.length>0?oe.value=l[0].value:oe.value=""},Ie=e=>{xe.value=e,ge.value=Me(e)},Me=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Be=async()=>{if(0!==ce.length)if(oe.value){ve.value=!0,xe.value="",ge.value="",pe.value=!1,be.value=0,he.value="准备转换...",fe.value=[];try{const l=new FormData;ce.value.forEach(e=>{l.append("files",e)});const a=je(ce.value[0].name);l.append("source_format",a),l.append("target_format",oe.value),l.append("process_mode",ue.value),l.append("quality","80"),l.append("page_range",ie.value),l.append("include_images",re.value.includeImages.toString()),l.append("optimize_images",re.value.optimizeImages.toString());let s=y(()=>{be.value+=Math.floor(10*Math.random())+5,be.value>100&&(be.value=100),be.value<30?he.value="正在上传文件...":be.value<70?he.value="正在转换文件...":he.value="正在生成结果...",100===be.value&&clearInterval(s)},500);try{const e=await fetch("http://localhost:8000/api/format-convert",{method:"POST",body:l});clearInterval(s),be.value=100,he.value="完成";const a=await e.json();if(a.success){const e=ye.value.find(e=>e.value===oe.value);me.value=a.message||`成功将 ${ce.value.length} 个文件转换为 ${e.label} 格式！`,pe.value=!0,fe.value=a.downloadLinks||[],fe.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=fe.value[0].url,e.download=fe.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}else xe.value=a.message||"转换失败",ge.value=a.suggestion||"请检查文件是否损坏，或尝试使用其他文件"}catch(e){xe.value=`转换失败：${e.message||"未知错误"}`,ge.value=Me(xe.value)}finally{s&&clearInterval(s),be.value=100,he.value="完成"}}catch(l){xe.value=`转换失败：${l.message||"未知错误"}`,ge.value=Me(xe.value)}finally{ve.value=!1}}else xe.value="请选择目标格式";else xe.value="请选择文件"},_e=()=>{de.value=[],oe.value="",ue.value="normal",re.value={includeImages:!0,optimizeImages:!1},ie.value="",xe.value="",ge.value="",pe.value=!1,me.value="",be.value=0,he.value="",fe.value=[],ye.value=[]};return(g,b)=>(a(),e(h,{title:"PDF格式转换",description:"支持多种办公文件格式的双向转换，包括文档、表格和演示文稿",tips:ke},{default:l(()=>[s("div",w,[t(f,{multiple:!0,accept:".pdf","max-size":52428800,modelValue:de.value,"onUpdate:modelValue":b[0]||(b[0]=e=>de.value=e),onFilesChanged:Ve,onError:Ie},null,8,["modelValue"]),ce.value.length>0?(a(),n("div",k,[b[10]||(b[10]=s("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),s("div",j,[(a(!0),n(o,null,u(ce.value,(e,l)=>(a(),n("div",{key:l,class:"flex items-center justify-between p-2 bg-white rounded border"},[s("div",C,[b[8]||(b[8]=s("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),s("div",null,[s("div",V,r(e.name),1),s("div",z,r(je(e.name))+" • "+r(Ce(e.size)),1)])]),s("button",{onClick:e=>(e=>{de.value.splice(e,1),0===de.value.length?_e():ze()})(l),class:"text-red-500 hover:text-red-700"},[...b[9]||(b[9]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,I)]))),128))])])):i("",!0),ce.value.length>0&&ye.value.length>0?(a(),n("div",M,[b[11]||(b[11]=s("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),s("div",B,[(a(!0),n(o,null,u(ye.value,e=>(a(),n("label",{key:e.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[d(s("input",{type:"radio","onUpdate:modelValue":b[1]||(b[1]=e=>oe.value=e),value:e.value,class:"w-4 h-4 text-blue-600"},null,8,_),[[c,oe.value]]),s("div",null,[s("div",U,r(e.label),1),s("div",E,r(e.description),1)])]))),128))])])):i("",!0),ce.value.length>0?(a(),n("div",F,[s("div",null,[b[15]||(b[15]=s("h3",{class:"text-lg font-semibold mb-2"},"转换模式",-1)),s("div",P,[s("label",A,[d(s("input",{type:"radio","onUpdate:modelValue":b[2]||(b[2]=e=>ue.value=e),value:"normal",class:"w-4 h-4 text-blue-600"},null,512),[[c,ue.value]]),b[12]||(b[12]=s("span",null,"标准转换",-1))]),s("label",L,[d(s("input",{type:"radio","onUpdate:modelValue":b[3]||(b[3]=e=>ue.value=e),value:"layout",class:"w-4 h-4 text-blue-600"},null,512),[[c,ue.value]]),b[13]||(b[13]=s("span",null,"保留布局",-1))]),s("label",$,[d(s("input",{type:"radio","onUpdate:modelValue":b[4]||(b[4]=e=>ue.value=e),value:"text",class:"w-4 h-4 text-blue-600"},null,512),[[c,ue.value]]),b[14]||(b[14]=s("span",null,"仅提取文本",-1))])])]),s("div",null,[b[18]||(b[18]=s("h3",{class:"text-lg font-semibold mb-2"},"图片处理",-1)),s("div",S,[s("label",D,[d(s("input",{type:"checkbox","onUpdate:modelValue":b[5]||(b[5]=e=>re.value.includeImages=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,re.value.includeImages]]),b[16]||(b[16]=s("span",null,"包含图片",-1))]),s("label",H,[d(s("input",{type:"checkbox","onUpdate:modelValue":b[6]||(b[6]=e=>re.value.optimizeImages=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,re.value.optimizeImages]]),b[17]||(b[17]=s("span",null,"优化图片大小",-1))])])]),we.value?(a(),n("div",K,[b[19]||(b[19]=s("h3",{class:"text-lg font-semibold mb-2"},"页面范围",-1)),d(s("input",{"onUpdate:modelValue":b[7]||(b[7]=e=>ie.value=e),type:"text",placeholder:"例如：1-5, 7, 9-12（留空表示全部）",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[p,ie.value]]),b[20]||(b[20]=s("p",{class:"text-sm text-gray-500 mt-1"},"支持逗号分隔的页码和页码范围，如：1-5, 7, 9-12",-1))])):i("",!0)])):i("",!0),s("div",T,[s("button",{onClick:Be,disabled:!ce.value.length||!oe.value||ve.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[ve.value?(a(),n("span",N,[b[21]||(b[21]=s("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),m(" 处理中... "+r(be.value)+"% ",1)])):(a(),n("span",G,"开始转换"))],8,q),s("button",{onClick:_e,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),ve.value?(a(),n("div",O,[s("div",W,[b[22]||(b[22]=s("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),s("span",Y,r(be.value)+"%",1)]),s("div",Z,[s("div",{class:"bg-blue-600 h-2.5 rounded-full",style:x({width:be.value+"%"})},null,4)]),s("p",J,r(he.value),1)])):i("",!0),pe.value?(a(),n("div",Q,[b[23]||(b[23]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",R,r(me.value),1),s("div",X,[(a(!0),n(o,null,u(fe.value,(e,l)=>(a(),n("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+r(l+1),9,ee))),128))])])):i("",!0),xe.value?(a(),n("div",le,[b[24]||(b[24]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",ae,r(xe.value),1),ge.value?(a(),n("p",se,"建议："+r(ge.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{te as default};
