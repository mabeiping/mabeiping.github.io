import{$ as a,w as e,m as s,p as l,q as t,n as i,z as r,K as c,a8 as o,D as n,L as u,x as d,F as v,u as p,E as f,v as m,k as x}from"./DwDdtX2U.js";import{_ as h}from"./CFdA-A2g.js";import{G as b}from"./CiXH2Qpk.js";import{_ as w}from"./Dq87FbFi.js";import"./C3WxCecE.js";import"./B7n04RKk.js";import"./DgXBCkKa.js";const y={class:"archive-extract"},g={class:"upload-section"},k={key:0,class:"options-section"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},z={class:"form-group"},j={class:"form-group"},C={class:"form-group col-span-1 md:col-span-2"},_={class:"flex items-center space-x-2"},F={key:1,class:"process-section"},R=["disabled"],S={key:0},U={key:1},A={key:2,class:"progress-section"},E={class:"progress-bar"},I={class:"text-sm text-gray-500 mt-1"},N={key:3,class:"result-section"},V={class:"result-info"},D={class:"result-item"},T={class:"value"},Z={class:"result-item"},$={class:"value"},q={class:"result-item"},B={class:"value"},G={class:"result-item"},K={class:"value"},L={class:"file-list-section"},M={class:"file-list"},O={class:"file-icon"},H={class:"file-info"},J={class:"file-name"},Q={class:"file-size"},W={class:"file-actions"},X=["onClick"],Y={key:4,class:"error-section"},aa={class:"error-message"},ea=w({__name:"index",setup(w){const ea=x(null),sa=x(!1),la=x(0),ta=x(""),ia=x(null),ra=x(""),ca=x({password:"",extractPath:"",overwrite:!1}),oa=a=>{ea.value=a,ra.value="",ia.value=null},na=()=>{ea.value=null,ra.value="",ia.value=null},ua=async()=>{if(ea.value){sa.value=!0,la.value=0,ta.value="准备解压...",ra.value="",ia.value=null;try{const a=new FormData;a.append("files",ea.value),a.append("password",ca.value.password),a.append("extractPath",ca.value.extractPath),a.append("overwrite",ca.value.overwrite);const e=await fetch("/api/archive/extract",{method:"POST",body:a});if(!e.ok)throw new Error("API请求失败");const s=await e.json();if(!s.success)throw new Error(s.message||"解压失败");{const a=s.data[0];ia.value={archiveName:a.archiveName,extractPath:a.extractPath,fileCount:a.fileCount,extractedSize:a.extractedSize,files:a.files}}}catch(a){ra.value=a.message||"解压失败，请重试"}finally{sa.value=!1}}else ra.value="请先上传压缩包"},da=()=>{alert("开始下载全部文件")},va=a=>{const e={pdf:"fa-file-pdf",image:"fa-file-image",csv:"fa-file-csv",text:"fa-file-alt",default:"fa-file"};return e[a]||e.default};return(x,w)=>(s(),a(h,{title:"文件解压",description:"解压各种格式的压缩包文件"},{default:e(()=>[l("div",y,[l("div",g,[w[3]||(w[3]=l("h3",null,"上传压缩包",-1)),t(b,{accept:".zip,.rar,.7z,.tar,.gz,.bz2,.xz,.iso",multiple:!1,onFileUploaded:oa,onFileRemoved:na}),w[4]||(w[4]=l("p",{class:"text-sm text-gray-500 mt-2"},"支持ZIP、RAR、7Z、TAR等多种压缩格式，单个文件大小不超过100MB",-1))]),ea.value?(s(),i("div",k,[w[8]||(w[8]=l("h3",null,"解压选项",-1)),l("div",P,[l("div",z,[w[5]||(w[5]=l("label",{for:"password"},"解压密码",-1)),r(l("input",{id:"password",type:"password","onUpdate:modelValue":w[0]||(w[0]=a=>ca.value.password=a),class:"form-input",placeholder:"如果压缩包有密码，请输入"},null,512),[[c,ca.value.password]])]),l("div",j,[w[6]||(w[6]=l("label",{for:"extractPath"},"解压路径",-1)),r(l("input",{id:"extractPath",type:"text","onUpdate:modelValue":w[1]||(w[1]=a=>ca.value.extractPath=a),class:"form-input",placeholder:"默认为当前目录"},null,512),[[c,ca.value.extractPath]])]),l("div",C,[l("label",_,[r(l("input",{type:"checkbox","onUpdate:modelValue":w[2]||(w[2]=a=>ca.value.overwrite=a),class:"form-checkbox"},null,512),[[o,ca.value.overwrite]]),w[7]||(w[7]=l("span",null,"覆盖已存在的文件",-1))])])])])):n("",!0),ea.value?(s(),i("div",F,[l("button",{class:"btn btn-primary",onClick:ua,disabled:sa.value},[sa.value?(s(),i("span",U,"解压中...")):(s(),i("span",S,"开始解压"))],8,R)])):n("",!0),sa.value?(s(),i("div",A,[l("div",E,[l("div",{class:"progress-fill",style:u({width:la.value+"%"})},null,4)]),l("p",I,d(ta.value),1)])):n("",!0),ia.value?(s(),i("div",N,[w[16]||(w[16]=l("h3",null,"解压结果",-1)),l("div",V,[l("div",D,[w[9]||(w[9]=l("span",{class:"label"},"压缩包名称:",-1)),l("span",T,d(ia.value.archiveName),1)]),l("div",Z,[w[10]||(w[10]=l("span",{class:"label"},"解压路径:",-1)),l("span",$,d(ia.value.extractPath),1)]),l("div",q,[w[11]||(w[11]=l("span",{class:"label"},"文件数量:",-1)),l("span",B,d(ia.value.fileCount),1)]),l("div",G,[w[12]||(w[12]=l("span",{class:"label"},"解压大小:",-1)),l("span",K,d(ia.value.extractedSize),1)]),l("div",L,[w[14]||(w[14]=l("h4",null,"解压文件列表",-1)),l("div",M,[(s(!0),i(v,null,p(ia.value.files,(a,e)=>(s(),i("div",{key:e,class:"file-item"},[l("div",O,[l("i",{class:f(["fas",va(a.type)])},null,2)]),l("div",H,[l("div",J,d(a.name),1),l("div",Q,d(a.size),1)]),l("div",W,[l("button",{class:"btn btn-sm btn-secondary",onClick:e=>{return s=a.path,void alert(`开始下载文件: ${s}`);var s}},[...w[13]||(w[13]=[l("i",{class:"fas fa-download"},null,-1)])],8,X)])]))),128))])]),l("button",{class:"btn btn-secondary mt-4",onClick:da},[...w[15]||(w[15]=[l("i",{class:"fas fa-download mr-2"},null,-1),m("下载全部文件 ",-1)])])])])):n("",!0),ra.value?(s(),i("div",Y,[l("div",aa,[w[17]||(w[17]=l("i",{class:"fas fa-exclamation-circle text-red-500 mr-2"},null,-1)),m(" "+d(ra.value),1)])])):n("",!0)])]),_:1}))}},[["__scopeId","data-v-d14ed3a7"]]);export{ea as default};
