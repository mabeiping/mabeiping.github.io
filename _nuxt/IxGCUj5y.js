import{j as G,w as I,o,a as t,b as J,c as a,F as C,p as F,t as r,l as g,q as _,v as R,C as V,d as D,B as q,r as i,x as K}from"./5KiIeb3O.js";import{_ as Q}from"./D50zL9At.js";import{G as W}from"./9UHln5xC.js";import{s as X}from"./CkncbWtC.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";import"./DlAUqK2U.js";const Y={class:"space-y-6"},Z={key:0,class:"bg-gray-50 p-4 rounded-lg"},ee={class:"space-y-2"},te={class:"flex items-center"},se={class:"font-medium"},le={class:"text-sm text-gray-500"},oe=["onClick"],ae={key:1,class:"bg-gray-50 p-4 rounded-lg"},ne={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},re=["value"],ie={class:"font-medium"},ue={class:"text-sm text-gray-500"},de={key:2,class:"space-y-4"},ce={class:"space-y-2"},ve={class:"flex items-center space-x-2"},me={class:"flex items-center space-x-2"},pe={class:"flex items-center space-x-2"},ge={class:"flex space-x-4"},xe=["disabled"],he={key:0},be={key:1,class:"flex items-center justify-center"},fe={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},ye={class:"flex items-center justify-between mb-2"},ke={class:"text-blue-700"},_e={class:"w-full bg-gray-200 rounded-full h-2.5"},we={class:"mt-2 text-sm text-blue-700"},Ce={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Fe={class:"mt-2 text-green-700"},Ve={class:"mt-3 space-y-2"},Be=["href","download"],Ee={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},je={class:"mt-2 text-red-700"},Me={key:0,class:"mt-2 text-sm text-gray-600"},Ae={__name:"index",setup(Se){const B=[{value:"xlsx",label:"Excel (.xlsx)",description:"适合复杂表格和公式",extensions:[".xlsx",".xls"]},{value:"csv",label:"CSV (.csv)",description:"逗号分隔值，通用格式",extensions:[".csv"]},{value:"json",label:"JSON (.json)",description:"适合数据交换和编程",extensions:[".json"]}],u=i(""),m=i({includeHeaders:!0,preserveFormatting:!0,handleEmptyCells:!0}),c=i([]),v=K(()=>c.value),y=i(!1),k=i(!1),w=i(""),d=i(""),x=i(""),h=i(0),b=i(""),p=i([]),f=i([]),U=["1. 上传文件：支持Excel、CSV和JSON格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含表头、保留格式、处理空单元格",'5. 点击"开始转换"按钮进行处理',"6. 等待转换完成，系统会自动下载转换后的文件","7. 查看转换结果，确保数据的完整性和准确性"],E=l=>l.split(".").pop().toLowerCase(),$=l=>{if(l===0)return"0 B";const e=1024,s=["B","KB","MB","GB"],n=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,n)).toFixed(2))+" "+s[n]},H=l=>{c.value.splice(l,1),c.value.length===0?S():j()},L=l=>{c.value=l,l.length>0?j():(f.value=[],u.value=""),d.value="",k.value=!1},j=()=>{if(c.value.length===0){f.value=[];return}const l=E(c.value[0].name),e=[];B.forEach(s=>{s.extensions.some(n=>l===n.replace(".",""))||e.push(s)}),f.value=e,e.length>0?u.value=e[0].value:u.value=""},N=l=>{d.value=l,x.value=M(l)},M=l=>l.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":l.includes("文件类型")?"请确保上传的文件格式受支持":l.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",O=()=>new Promise(l=>{let e=0;const s=X(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),h.value=e,e<30?b.value="正在分析文件...":e<70?b.value="正在转换文件...":b.value="正在生成结果...",e===100&&(clearInterval(s),setTimeout(l,500))},500)}),P=async()=>{if(v.length===0){d.value="请选择文件";return}if(!u.value){d.value="请选择目标格式";return}y.value=!0,d.value="",x.value="",k.value=!1,h.value=0,b.value="准备转换...",p.value=[];try{await O();const l={files:v.value,targetFormat:u.value,options:m.value};console.log("转换参数:",l);const e=B.find(s=>s.value===u.value);w.value=`成功将 ${v.length} 个文件转换为 ${e.label} 格式！`,k.value=!0,v.forEach((s,n)=>{const z=new Blob(["模拟转换后的文件内容"],{type:"application/octet-stream"}),T=URL.createObjectURL(z),A=`converted_${s.name.replace(/\.[^/.]+$/,`.${u.value}`)}`;p.value.push({url:T,filename:A})}),p.value.length>0&&setTimeout(()=>{const s=document.createElement("a");s.href=p.value[0].url,s.download=p.value[0].filename,document.body.appendChild(s),s.click(),document.body.removeChild(s)},1e3)}catch(l){d.value=`转换失败：${l.message||"未知错误"}`,x.value=M(d.value)}finally{y.value=!1}},S=()=>{c.value=[],u.value="",m.value={includeHeaders:!0,preserveFormatting:!0,handleEmptyCells:!0},d.value="",x.value="",k.value=!1,w.value="",h.value=0,b.value="",p.value=[],f.value=[]};return(l,e)=>(o(),G(Q,{title:"Excel表格格式转换",description:"支持xls/xlsx/CSV/JSON等格式的互转",tips:U},{default:I(()=>[t("div",Y,[J(W,{multiple:!0,accept:[".xls",".xlsx",".csv",".json"],"max-size":100*1024*1024,modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),onFilesChanged:L,onError:N},null,8,["modelValue"]),v.value.length>0?(o(),a("div",Z,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",ee,[(o(!0),a(C,null,F(v.value,(s,n)=>(o(),a("div",{key:n,class:"flex items-center justify-between p-2 bg-white rounded border"},[t("div",te,[e[5]||(e[5]=t("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("div",null,[t("div",se,r(s.name),1),t("div",le,r(E(s.name))+" • "+r($(s.size)),1)])]),t("button",{onClick:z=>H(n),class:"text-red-500 hover:text-red-700"},[...e[6]||(e[6]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,oe)]))),128))])])):g("",!0),v.value.length>0&&f.value.length>0?(o(),a("div",ae,[e[8]||(e[8]=t("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),t("div",ne,[(o(!0),a(C,null,F(f.value,s=>(o(),a("label",{key:s.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[_(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),value:s.value,class:"w-4 h-4 text-blue-600"},null,8,re),[[R,u.value]]),t("div",null,[t("div",ie,r(s.label),1),t("div",ue,r(s.description),1)])]))),128))])])):g("",!0),v.value.length>0?(o(),a("div",de,[t("div",null,[e[12]||(e[12]=t("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),t("div",ce,[t("label",ve,[_(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>m.value.includeHeaders=s),class:"w-4 h-4 text-blue-600"},null,512),[[V,m.value.includeHeaders]]),e[9]||(e[9]=t("span",null,"包含表头",-1))]),t("label",me,[_(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=s=>m.value.preserveFormatting=s),class:"w-4 h-4 text-blue-600"},null,512),[[V,m.value.preserveFormatting]]),e[10]||(e[10]=t("span",null,"保留格式",-1))]),t("label",pe,[_(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=s=>m.value.handleEmptyCells=s),class:"w-4 h-4 text-blue-600"},null,512),[[V,m.value.handleEmptyCells]]),e[11]||(e[11]=t("span",null,"处理空单元格",-1))])])])])):g("",!0),t("div",ge,[t("button",{onClick:P,disabled:!v.value.length||!u.value||y.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[y.value?(o(),a("span",be,[e[13]||(e[13]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),D(" 处理中... "+r(h.value)+"% ",1)])):(o(),a("span",he,"开始转换"))],8,xe),t("button",{onClick:S,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),y.value?(o(),a("div",fe,[t("div",ye,[e[14]||(e[14]=t("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),t("span",ke,r(h.value)+"%",1)]),t("div",_e,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:q({width:h.value+"%"})},null,4)]),t("p",we,r(b.value),1)])):g("",!0),k.value?(o(),a("div",Ce,[e[15]||(e[15]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),t("p",Fe,r(w.value),1),t("div",Ve,[(o(!0),a(C,null,F(p.value,(s,n)=>(o(),a("a",{key:n,href:s.url,download:s.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+r(n+1),9,Be))),128))])])):g("",!0),d.value?(o(),a("div",Ee,[e[16]||(e[16]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),t("p",je,r(d.value),1),x.value?(o(),a("p",Me,"建议："+r(x.value),1)):g("",!0)])):g("",!0)])]),_:1}))}};export{Ae as default};
