import{h as $,w as I,o as a,a as e,c as i,i as g,j as n,y as F,k as x,m as M,q as C,t as d,F as B,r as P,p as N}from"./vIjrQGDC.js";import{_ as A}from"./CQUG57wd.js";import"./CA1_4N2w.js";import"./CQENOYst.js";const H={class:"space-y-6"},R={class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors"},S={class:"space-y-4"},W={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},q=["disabled"],O=["disabled"],G={class:"flex items-center gap-2"},K=["disabled"],J={class:"flex items-center gap-2"},Q=["disabled"],X=["disabled"],Y={key:0,class:"space-y-4"},Z={class:"text-lg font-semibold text-text-primary"},ee={class:"space-y-2"},te={class:"flex items-center gap-3"},se={class:"text-sm font-medium text-text-primary"},oe={class:"text-xs text-text-secondary"},le=["onClick"],re={key:1,class:"space-y-4"},ne={class:"space-y-2"},ae={class:"flex items-center gap-3"},ie={class:"text-sm font-medium text-text-primary"},de={class:"text-xs text-text-secondary"},ue=["onClick"],ge={__name:"format-convert",setup(ce){const b=n(null),l=n([]),u=n([]),c=n("docx"),y=n("high"),f=n(!0),h=n(!0),p=n(!1),v=n(""),w=n("success"),z=()=>{b.value.click()},L=s=>{const t=Array.from(s.target.files);l.value=[...l.value,...t]},D=s=>{const o=Array.from(s.dataTransfer.files).filter(r=>r.type==="application/pdf");if(o.length===0){m("请选择PDF文件","error");return}l.value=[...l.value,...o]},V=s=>{l.value.splice(s,1)},U=()=>{if(l.value.length===0){m("请先选择文件","error");return}p.value=!0,setTimeout(()=>{u.value=l.value.map(s=>{const t=c.value;return{name:s.name.replace(".pdf",`.${t}`),size:Math.round(s.size*.8),originalFile:s}}),p.value=!1,m("转换完成！","success")},2e3)},k=s=>{const t=new Blob(["Converted content"],{type:"text/plain"}),o=URL.createObjectURL(t),r=document.createElement("a");r.href=o,r.download=s.name,r.click(),URL.revokeObjectURL(o),m(`已下载 ${s.name}`,"success")},j=()=>{u.value.forEach(s=>{k(s)})},E=s=>({docx:"Word 文档",doc:"Word 文档",xlsx:"Excel 表格",xls:"Excel 表格",pptx:"PowerPoint 演示文稿",ppt:"PowerPoint 演示文稿",txt:"纯文本",rtf:"富文本格式",html:"HTML 网页"})[s]||s,_=s=>{if(s===0)return"0 Bytes";const t=1024,o=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(t));return Math.round(s/Math.pow(t,r)*100)/100+" "+o[r]},m=(s,t)=>{v.value=s,w.value=t,setTimeout(()=>{v.value=""},3e3)};return(s,t)=>(a(),$(A,{title:"PDF格式转换",description:"将PDF文件转换为其他格式"},{default:I(()=>[e("div",H,[e("div",R,[e("input",{ref_key:"fileInput",ref:b,type:"file",accept:".pdf",multiple:"",onChange:L,class:"hidden"},null,544),e("div",{onClick:z,onDragover:t[0]||(t[0]=F(()=>{},["prevent"])),onDrop:F(D,["prevent"]),class:"cursor-pointer"},[...t[5]||(t[5]=[e("svg",{class:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),e("p",{class:"text-text-primary mb-2"},"点击或拖拽PDF文件到此处",-1),e("p",{class:"text-sm text-text-secondary"},"支持多个文件上传",-1)])],32)]),e("div",S,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-text-primary"},"转换设置",-1)),e("div",W,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-text-secondary mb-2"},"输出格式",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>c.value=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:l.value.length===0},[...t[6]||(t[6]=[e("option",{value:"docx"},"Word 文档 (.docx)",-1),e("option",{value:"doc"},"Word 文档 (.doc)",-1),e("option",{value:"xlsx"},"Excel 表格 (.xlsx)",-1),e("option",{value:"xls"},"Excel 表格 (.xls)",-1),e("option",{value:"pptx"},"PowerPoint 演示文稿 (.pptx)",-1),e("option",{value:"ppt"},"PowerPoint 演示文稿 (.ppt)",-1),e("option",{value:"txt"},"纯文本 (.txt)",-1),e("option",{value:"rtf"},"富文本格式 (.rtf)",-1),e("option",{value:"html"},"HTML 网页 (.html)",-1)])],8,q),[[M,c.value]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-text-secondary mb-2"},"转换质量",-1)),x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>y.value=o),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:l.value.length===0},[...t[8]||(t[8]=[e("option",{value:"high"},"高质量 (推荐)",-1),e("option",{value:"medium"},"中等质量",-1),e("option",{value:"low"},"低质量 (文件更小)",-1)])],8,O),[[M,y.value]])])]),e("div",G,[x(e("input",{id:"preserveFormatting","onUpdate:modelValue":t[3]||(t[3]=o=>f.value=o),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:l.value.length===0},null,8,K),[[C,f.value]]),t[10]||(t[10]=e("label",{for:"preserveFormatting",class:"text-sm text-text-secondary"},"保留原始格式",-1))]),e("div",J,[x(e("input",{id:"includeImages","onUpdate:modelValue":t[4]||(t[4]=o=>h.value=o),type:"checkbox",class:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",disabled:l.value.length===0},null,8,Q),[[C,h.value]]),t[11]||(t[11]=e("label",{for:"includeImages",class:"text-sm text-text-secondary"},"包含图片",-1))]),e("button",{onClick:U,disabled:p.value||l.value.length===0,class:"w-full py-3 px-4 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed"},d(p.value?"转换中...":l.value.length===0?"请先选择PDF文件":`转换为 ${E(c.value)}`),9,X)]),l.value.length>0?(a(),i("div",Y,[e("h3",Z,"已选择的文件 ("+d(l.value.length)+")",1),e("div",ee,[(a(!0),i(B,null,P(l.value,(o,r)=>(a(),i("div",{key:r,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",te,[t[13]||(t[13]=e("svg",{class:"w-8 h-8 text-red-500",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h6v6h6v10H6z"})],-1)),e("div",null,[e("p",se,d(o.name),1),e("p",oe,d(_(o.size)),1)])]),e("button",{onClick:T=>V(r),class:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors"},[...t[14]||(t[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,le)]))),128))])])):g("",!0),u.value.length>0?(a(),i("div",re,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold text-text-primary"},"转换结果",-1)),e("div",ne,[(a(!0),i(B,null,P(u.value,(o,r)=>(a(),i("div",{key:r,class:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200"},[e("div",ae,[t[15]||(t[15]=e("svg",{class:"w-8 h-8 text-green-500",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})],-1)),e("div",null,[e("p",ie,d(o.name),1),e("p",de,d(_(o.size)),1)])]),e("button",{onClick:T=>k(o),class:"px-4 py-2 bg-green-500 text-white text-sm rounded-lg hover:bg-green-600 transition-colors"}," 下载 ",8,ue)]))),128))]),e("button",{onClick:j,class:"w-full py-3 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"}," 下载全部文件 ")])):g("",!0),v.value?(a(),i("div",{key:2,class:N(["fixed top-4 right-4 px-4 py-2 rounded-lg shadow-lg z-50",w.value==="success"?"bg-green-500 text-white":"bg-red-500 text-white"])},d(v.value),3)):g("",!0)])]),_:1}))}};export{ge as default};
