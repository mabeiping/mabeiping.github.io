import{i as $,w as G,o,a as t,b as I,c as a,F as D,r as U,t as d,f as i,j as n,v as q,p as C,k as g,y as V,d as J,x as Q,l as m,m as W}from"./-R7zUpUx.js";import{_ as X}from"./1SagYtif.js";import{G as Z}from"./zseaTYbb.js";import{s as ee}from"./CI8PMl9t.js";import"./C_FLJhYl.js";import"./Cu7bTl1K.js";import"./DlAUqK2U.js";const te={class:"space-y-6"},le={key:0,class:"bg-gray-50 p-4 rounded-lg"},se={class:"space-y-2"},oe={class:"flex items-center"},ae={class:"font-medium"},re={class:"text-sm text-gray-500"},ne=["onClick"],ue={key:1,class:"bg-gray-50 p-4 rounded-lg"},ie={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},de=["value"],me={class:"font-medium"},pe={class:"text-sm text-gray-500"},ve={key:2,class:"space-y-4"},ce={key:0,class:"bg-white p-4 rounded-lg border"},be={class:"space-y-3"},ye={key:0},fe={key:1,class:"bg-white p-4 rounded-lg border"},ge={class:"space-y-3"},xe={key:0},ke={key:2,class:"bg-white p-4 rounded-lg border"},we={class:"space-y-3"},Fe={class:"space-y-2"},he={class:"flex items-center space-x-2"},ze={class:"flex items-center space-x-2"},Me={class:"flex items-center space-x-2"},Ce={class:"flex items-center space-x-2"},Ve={key:0},Te={key:3,class:"bg-white p-4 rounded-lg border"},De={class:"space-y-3"},Ue={key:0},Be={class:"mt-2 space-y-2"},Pe={class:"grid grid-cols-2 gap-2"},Ye={class:"text-xs text-gray-500"},Se={class:"text-xs text-gray-500"},Oe={key:1},Ee={class:"mt-2"},je={class:"flex space-x-4"},Ae=["disabled"],Ne={key:0},He={key:1,class:"flex items-center justify-center"},Le={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Re={class:"flex items-center justify-between mb-2"},_e={class:"text-blue-700"},Ke={class:"w-full bg-gray-200 rounded-full h-2.5"},$e={class:"mt-2 text-sm text-blue-700"},Ge={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ie={class:"mt-2 text-green-700"},qe={class:"mt-3 space-y-2"},Je=["href","download"],Qe={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},We={class:"mt-2 text-red-700"},Xe={key:0,class:"mt-2 text-sm text-gray-600"},nt={__name:"index",setup(Ze){const B=[{value:"removeDuplicates",label:"重复数据清洗",description:"移除表格中的重复数据"},{value:"batchCalculation",label:"公式批量计算",description:"对表格数据进行批量公式计算"},{value:"standardizeFormat",label:"表格格式标准化",description:"标准化表格格式和数据类型"},{value:"watermarkEncrypt",label:"批量加水印/加密",description:"为表格添加水印或进行加密"}],u=m(""),b=m({duplicateKey:"allColumns",specificColumns:"",keepOption:"first"}),y=m({calculationType:"sum",customFormula:"",applyRange:""}),p=m({standardizeHeaders:!0,standardizeDataTypes:!0,standardizeDateFormats:!0,standardizeNumberFormats:!0,dateFormat:"yyyy-MM-dd"}),r=m({operationType:"watermark",watermarkText:"机密文件",watermarkOpacity:30,watermarkFontSize:24,encryptPassword:"",confirmPassword:""}),x=m([]),f=W(()=>x.value),z=m(!1),M=m(!1),T=m(""),v=m(""),w=m(""),F=m(0),h=m(""),k=m([]),O=["1. 上传文件：支持Excel和CSV格式，可批量上传","2. 选择处理功能：重复数据清洗、公式批量计算、表格格式标准化或批量加水印/加密","3. 根据选择的功能，设置相应的处理选项",'4. 点击"开始处理"按钮进行处理',"5. 等待处理完成，系统会自动下载处理后的文件","6. 查看处理结果，确保数据的完整性和准确性"],E=s=>s.split(".").pop().toLowerCase(),j=s=>{if(s===0)return"0 B";const e=1024,l=["B","KB","MB","GB"],c=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,c)).toFixed(2))+" "+l[c]},A=s=>{x.value.splice(s,1),x.value.length===0&&Y()},N=s=>{x.value=s,v.value="",M.value=!1},H=s=>{v.value=s,w.value=P(s)},P=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",L=()=>new Promise(s=>{let e=0;const l=ee(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),F.value=e,e<30?h.value="正在分析文件...":e<70?h.value="正在处理文件...":h.value="正在生成结果...",e===100&&(clearInterval(l),setTimeout(s,500))},500)}),R=async()=>{if(f.length===0){v.value="请选择文件";return}if(!u.value){v.value="请选择处理功能";return}if(u.value==="watermarkEncrypt"&&r.value.operationType==="encrypt"){if(!r.value.encryptPassword){v.value="请输入加密密码";return}if(r.value.encryptPassword!==r.value.confirmPassword){v.value="两次输入的密码不一致";return}}z.value=!0,v.value="",w.value="",M.value=!1,F.value=0,h.value="准备处理...",k.value=[];try{await L();let s={files:f.value,feature:u.value};u.value==="removeDuplicates"?s.options=b.value:u.value==="batchCalculation"?s.options=y.value:u.value==="standardizeFormat"?s.options=p.value:u.value==="watermarkEncrypt"&&(s.options=r.value),console.log("处理参数:",s);const e=B.find(l=>l.value===u.value);T.value=`成功对 ${f.length} 个文件执行 ${e.label} 操作！`,M.value=!0,f.forEach((l,c)=>{const S=new Blob(["模拟处理后的文件内容"],{type:"application/octet-stream"}),_=URL.createObjectURL(S),K=`processed_${l.name}`;k.value.push({url:_,filename:K})}),k.value.length>0&&setTimeout(()=>{const l=document.createElement("a");l.href=k.value[0].url,l.download=k.value[0].filename,document.body.appendChild(l),l.click(),document.body.removeChild(l)},1e3)}catch(s){v.value=`处理失败：${s.message||"未知错误"}`,w.value=P(v.value)}finally{z.value=!1}},Y=()=>{x.value=[],u.value="",b.value={duplicateKey:"allColumns",specificColumns:"",keepOption:"first"},y.value={calculationType:"sum",customFormula:"",applyRange:""},p.value={standardizeHeaders:!0,standardizeDataTypes:!0,standardizeDateFormats:!0,standardizeNumberFormats:!0,dateFormat:"yyyy-MM-dd"},r.value={operationType:"watermark",watermarkText:"机密文件",watermarkOpacity:30,watermarkFontSize:24,encryptPassword:"",confirmPassword:""},v.value="",w.value="",M.value=!1,T.value="",F.value=0,h.value="",k.value=[]};return(s,e)=>(o(),$(X,{title:"Excel表格数据处理",description:"支持表格重复数据清洗去重、公式批量计算、表格格式标准化、批量加水印/加密",tips:O},{default:G(()=>[t("div",te,[I(Z,{multiple:!0,accept:[".xls",".xlsx",".csv"],"max-size":100*1024*1024,modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=l=>x.value=l),onFilesChanged:N,onError:H},null,8,["modelValue"]),f.value.length>0?(o(),a("div",le,[e[21]||(e[21]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",se,[(o(!0),a(D,null,U(f.value,(l,c)=>(o(),a("div",{key:c,class:"flex items-center justify-between p-2 bg-white rounded border"},[t("div",oe,[e[19]||(e[19]=t("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("div",null,[t("div",ae,d(l.name),1),t("div",re,d(E(l.name))+" • "+d(j(l.size)),1)])]),t("button",{onClick:S=>A(c),class:"text-red-500 hover:text-red-700"},[...e[20]||(e[20]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ne)]))),128))])])):i("",!0),f.value.length>0?(o(),a("div",ue,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold mb-4"},"处理功能",-1)),t("div",ie,[(o(),a(D,null,U(B,l=>t("label",{key:l.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[n(t("input",{type:"radio","onUpdate:modelValue":e[1]||(e[1]=c=>u.value=c),value:l.value,class:"w-4 h-4 text-blue-600"},null,8,de),[[q,u.value]]),t("div",null,[t("div",me,d(l.label),1),t("div",pe,d(l.description),1)])])),64))])])):i("",!0),f.value.length>0&&u.value?(o(),a("div",ve,[u.value==="removeDuplicates"?(o(),a("div",ce,[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold mb-3"},"重复数据清洗选项",-1)),t("div",be,[t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"去重依据",-1)),n(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>b.value.duplicateKey=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[23]||(e[23]=[t("option",{value:"allColumns"},"所有列",-1),t("option",{value:"specificColumns"},"指定列",-1)])],512),[[C,b.value.duplicateKey]])]),b.value.duplicateKey==="specificColumns"?(o(),a("div",ye,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"指定列（用逗号分隔）",-1)),n(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>b.value.specificColumns=l),type:"text",placeholder:"例如：A,B,C 或 姓名,年龄,性别",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,b.value.specificColumns]])])):i("",!0),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"保留方式",-1)),n(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>b.value.keepOption=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[26]||(e[26]=[t("option",{value:"first"},"保留第一个",-1),t("option",{value:"last"},"保留最后一个",-1)])],512),[[C,b.value.keepOption]])])])])):i("",!0),u.value==="batchCalculation"?(o(),a("div",fe,[e[33]||(e[33]=t("h3",{class:"text-lg font-semibold mb-3"},"公式批量计算选项",-1)),t("div",ge,[t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"计算类型",-1)),n(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>y.value.calculationType=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[29]||(e[29]=[t("option",{value:"sum"},"求和",-1),t("option",{value:"average"},"平均值",-1),t("option",{value:"max"},"最大值",-1),t("option",{value:"min"},"最小值",-1),t("option",{value:"count"},"计数",-1),t("option",{value:"custom"},"自定义公式",-1)])],512),[[C,y.value.calculationType]])]),y.value.calculationType==="custom"?(o(),a("div",xe,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"自定义公式",-1)),n(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>y.value.customFormula=l),type:"text",placeholder:"例如：=A1+B1 或 =SUM(A1:A10)",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,y.value.customFormula]])])):i("",!0),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"应用范围",-1)),n(t("input",{"onUpdate:modelValue":e[7]||(e[7]=l=>y.value.applyRange=l),type:"text",placeholder:"例如：A1:A100 或 所有行",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,y.value.applyRange]])])])])):i("",!0),u.value==="standardizeFormat"?(o(),a("div",ke,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold mb-3"},"表格格式标准化选项",-1)),t("div",we,[t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"标准化项目",-1)),t("div",Fe,[t("label",he,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=l=>p.value.standardizeHeaders=l),class:"w-4 h-4 text-blue-600"},null,512),[[V,p.value.standardizeHeaders]]),e[34]||(e[34]=t("span",null,"标准化表头",-1))]),t("label",ze,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=l=>p.value.standardizeDataTypes=l),class:"w-4 h-4 text-blue-600"},null,512),[[V,p.value.standardizeDataTypes]]),e[35]||(e[35]=t("span",null,"标准化数据类型",-1))]),t("label",Me,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=l=>p.value.standardizeDateFormats=l),class:"w-4 h-4 text-blue-600"},null,512),[[V,p.value.standardizeDateFormats]]),e[36]||(e[36]=t("span",null,"标准化日期格式",-1))]),t("label",Ce,[n(t("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=l=>p.value.standardizeNumberFormats=l),class:"w-4 h-4 text-blue-600"},null,512),[[V,p.value.standardizeNumberFormats]]),e[37]||(e[37]=t("span",null,"标准化数字格式",-1))])])]),p.value.standardizeDateFormats?(o(),a("div",Ve,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"日期格式",-1)),n(t("select",{"onUpdate:modelValue":e[12]||(e[12]=l=>p.value.dateFormat=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[39]||(e[39]=[t("option",{value:"yyyy-MM-dd"},"YYYY-MM-DD",-1),t("option",{value:"yyyy/MM/dd"},"YYYY/MM/DD",-1),t("option",{value:"MM/dd/yyyy"},"MM/DD/YYYY",-1),t("option",{value:"dd/MM/yyyy"},"DD/MM/YYYY",-1)])],512),[[C,p.value.dateFormat]])])):i("",!0)])])):i("",!0),u.value==="watermarkEncrypt"?(o(),a("div",Te,[e[50]||(e[50]=t("h3",{class:"text-lg font-semibold mb-3"},"批量加水印/加密选项",-1)),t("div",De,[t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"操作类型",-1)),n(t("select",{"onUpdate:modelValue":e[13]||(e[13]=l=>r.value.operationType=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[42]||(e[42]=[t("option",{value:"watermark"},"加水印",-1),t("option",{value:"encrypt"},"加密",-1)])],512),[[C,r.value.operationType]])]),r.value.operationType==="watermark"?(o(),a("div",Ue,[e[47]||(e[47]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印内容",-1)),n(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>r.value.watermarkText=l),type:"text",placeholder:"例如：机密文件 或 内部使用",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,r.value.watermarkText]]),t("div",Be,[e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"水印样式",-1)),t("div",Pe,[t("div",null,[e[44]||(e[44]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"透明度",-1)),n(t("input",{"onUpdate:modelValue":e[15]||(e[15]=l=>r.value.watermarkOpacity=l),type:"range",min:"0",max:"100",class:"w-full"},null,512),[[g,r.value.watermarkOpacity,void 0,{number:!0}]]),t("span",Ye,d(r.value.watermarkOpacity)+"%",1)]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"字体大小",-1)),n(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>r.value.watermarkFontSize=l),type:"range",min:"12",max:"72",class:"w-full"},null,512),[[g,r.value.watermarkFontSize,void 0,{number:!0}]]),t("span",Se,d(r.value.watermarkFontSize)+"px",1)])])])])):i("",!0),r.value.operationType==="encrypt"?(o(),a("div",Oe,[e[49]||(e[49]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密密码",-1)),n(t("input",{"onUpdate:modelValue":e[17]||(e[17]=l=>r.value.encryptPassword=l),type:"password",placeholder:"请输入加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,r.value.encryptPassword]]),t("div",Ee,[e[48]||(e[48]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"确认密码",-1)),n(t("input",{"onUpdate:modelValue":e[18]||(e[18]=l=>r.value.confirmPassword=l),type:"password",placeholder:"请确认加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[g,r.value.confirmPassword]])])])):i("",!0)])])):i("",!0)])):i("",!0),t("div",je,[t("button",{onClick:R,disabled:!f.value.length||!u.value||z.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[z.value?(o(),a("span",He,[e[51]||(e[51]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),J(" 处理中... "+d(F.value)+"% ",1)])):(o(),a("span",Ne,"开始处理"))],8,Ae),t("button",{onClick:Y,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),z.value?(o(),a("div",Le,[t("div",Re,[e[52]||(e[52]=t("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),t("span",_e,d(F.value)+"%",1)]),t("div",Ke,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:Q({width:F.value+"%"})},null,4)]),t("p",$e,d(h.value),1)])):i("",!0),M.value?(o(),a("div",Ge,[e[53]||(e[53]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),t("p",Ie,d(T.value),1),t("div",qe,[(o(!0),a(D,null,U(k.value,(l,c)=>(o(),a("a",{key:c,href:l.url,download:l.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载处理结果 "+d(c+1),9,Je))),128))])])):i("",!0),v.value?(o(),a("div",Qe,[e[54]||(e[54]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),t("p",We,d(v.value),1),w.value?(o(),a("p",Xe,"建议："+d(w.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{nt as default};
