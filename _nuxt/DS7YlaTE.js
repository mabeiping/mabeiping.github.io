import{j as e,w as l,o as a,a as s,b as t,c as o,F as u,p as r,t as n,l as i,q as d,v as c,s as v,y as p,C as m,d as g,B as b,r as h,x}from"./CU9sc1yl.js";import{_ as y}from"./KU0exf4c.js";import{G as f}from"./CwQEddwr.js";import{s as w}from"./Uj4zMvJp.js";import"./BaOdEBWl.js";import"./ByWfkjdR.js";import"./CIUYv0cq.js";import"./DKwMAC3i.js";import"./BCo6x5W8.js";const k={class:"space-y-6"},j={key:0,class:"bg-gray-50 p-4 rounded-lg"},z={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},M={class:"flex justify-center mb-3"},C=["src"],U={class:"text-center"},P={class:"font-medium truncate"},V={class:"text-sm text-gray-500"},B=["onClick"],G={key:1,class:"bg-gray-50 p-4 rounded-lg"},$={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},L=["value"],q={class:"text-center"},_={class:"font-medium"},E={class:"text-sm text-gray-500"},F={key:2,class:"space-y-4"},R={class:"bg-gray-50 p-4 rounded-lg"},J={class:"space-y-3"},N={class:"text-right text-sm text-gray-500"},W={key:0,class:"mt-2 grid grid-cols-2 gap-2"},O={key:1,class:"mt-2"},T={class:"flex items-center space-x-2"},A={class:"flex space-x-4"},H=["disabled"],I={key:0},K={key:1,class:"flex items-center justify-center"},Y={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Z={class:"flex items-center justify-between mb-2"},D={class:"text-blue-700"},Q={class:"w-full bg-gray-200 rounded-full h-2.5"},S={class:"mt-2 text-sm text-blue-700"},X={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},ee={class:"mt-2 text-green-700"},le={class:"mt-3 space-y-2"},ae=["href","download"],se={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},te={class:"mt-2 text-red-700"},oe={key:0,class:"mt-2 text-sm text-gray-600"},ue={__name:"index",setup(ue){const re=[{value:"png",label:"PNG",description:"无损压缩格式",extensions:[".png"]},{value:"jpg",label:"JPG",description:"有损压缩格式",extensions:[".jpg",".jpeg"]},{value:"webp",label:"WebP",description:"现代图片格式",extensions:[".webp"]}],ne=h(""),ie=h({quality:80,resizeMode:"original",width:0,height:0,percentage:100,optimize:!0}),de=h([]),ce=x(()=>de.value),ve=h(!1),pe=h(!1),me=h(""),ge=h(""),be=h(""),he=h(0),xe=h(""),ye=h([]),fe=h([]),we=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：图片质量、尺寸调整等",'5. 点击"开始转换"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保图片质量和格式的准确性"],ke=e=>e.split(".").pop().toLowerCase(),je=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},ze=e=>{de.value=e,e.length>0?Me():(fe.value=[],ne.value=""),ge.value="",pe.value=!1},Me=()=>{if(0===de.value.length)return void(fe.value=[]);const e=ke(de.value[0].name),l=[];re.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))||l.push(a)}),fe.value=l,l.length>0?ne.value=l[0].value:ne.value=""},Ce=e=>{ge.value=e,be.value=Ue(e)},Ue=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Pe=async()=>{if(0!==ce.length)if(ne.value){ve.value=!0,ge.value="",be.value="",pe.value=!1,he.value=0,xe.value="准备转换...",ye.value=[];try{await new Promise(e=>{let l=0;const a=w(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),he.value=l,xe.value=l<30?"正在分析图片...":l<70?"正在转换图片...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});ce.value,ne.value,ie.value;const e=re.find(e=>e.value===ne.value);me.value=`成功将 ${ce.length} 个图片转换为 ${e.label} 格式！`,pe.value=!0,ce.forEach((e,l)=>{const a=new Blob(["模拟转换后的图片内容"],{type:`image/${ne.value}`}),s=URL.createObjectURL(a),t=`converted_${e.name.replace(/\.[^/.]+$/,`.${ne.value}`)}`;ye.value.push({url:s,filename:t})}),ye.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=ye.value[0].url,e.download=ye.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){ge.value=`转换失败：${e.message||"未知错误"}`,be.value=Ue(ge.value)}finally{ve.value=!1}}else ge.value="请选择目标格式";else ge.value="请选择文件"},Ve=()=>{de.value=[],ne.value="",ie.value={quality:80,resizeMode:"original",width:0,height:0,percentage:100,optimize:!0},ge.value="",be.value="",pe.value=!1,me.value="",he.value=0,xe.value="",ye.value=[],fe.value=[]};return(h,x)=>(a(),e(y,{title:"图片格式转换",description:"支持PNG/JPG/WebP互转",tips:we},{default:l(()=>[s("div",k,[t(f,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":52428800,modelValue:de.value,"onUpdate:modelValue":x[0]||(x[0]=e=>de.value=e),onFilesChanged:ze,onError:Ce},null,8,["modelValue"]),ce.value.length>0?(a(),o("div",j,[x[8]||(x[8]=s("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),s("div",z,[(a(!0),o(u,null,r(ce.value,(e,l)=>(a(),o("div",{key:l,class:"bg-white rounded border p-3"},[s("div",M,[s("img",{src:h.URL.createObjectURL(e),class:"max-h-32 object-contain",alt:"Preview"},null,8,C)]),s("div",U,[s("div",P,n(e.name),1),s("div",V,n(ke(e.name))+" • "+n(je(e.size)),1)]),s("button",{onClick:e=>(e=>{de.value.splice(e,1),0===de.value.length?Ve():Me()})(l),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,B)]))),128))])])):i("",!0),ce.value.length>0?(a(),o("div",G,[x[9]||(x[9]=s("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),s("div",$,[(a(!0),o(u,null,r(fe.value,e=>(a(),o("label",{key:e.value,class:"flex flex-col items-center space-y-2 cursor-pointer p-4 border rounded-lg hover:bg-gray-100"},[d(s("input",{type:"radio","onUpdate:modelValue":x[1]||(x[1]=e=>ne.value=e),value:e.value,class:"w-4 h-4 text-blue-600"},null,8,L),[[c,ne.value]]),s("div",q,[s("div",_,n(e.label),1),s("div",E,n(e.description),1)])]))),128))])])):i("",!0),ce.value.length>0?(a(),o("div",F,[s("div",R,[x[14]||(x[14]=s("h3",{class:"text-lg font-semibold mb-3"},"转换选项",-1)),s("div",J,[s("div",null,[x[10]||(x[10]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"图片质量",-1)),d(s("input",{"onUpdate:modelValue":x[2]||(x[2]=e=>ie.value.quality=e),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[v,ie.value.quality,void 0,{number:!0}]]),s("div",N,n(ie.value.quality)+"%",1)]),s("div",null,[x[12]||(x[12]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"调整尺寸",-1)),d(s("select",{"onUpdate:modelValue":x[3]||(x[3]=e=>ie.value.resizeMode=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...x[11]||(x[11]=[s("option",{value:"original"},"保持原始尺寸",-1),s("option",{value:"custom"},"自定义尺寸",-1),s("option",{value:"percentage"},"按比例调整",-1)])],512),[[p,ie.value.resizeMode]]),"custom"===ie.value.resizeMode?(a(),o("div",W,[d(s("input",{"onUpdate:modelValue":x[4]||(x[4]=e=>ie.value.width=e),type:"number",placeholder:"宽度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[v,ie.value.width,void 0,{number:!0}]]),d(s("input",{"onUpdate:modelValue":x[5]||(x[5]=e=>ie.value.height=e),type:"number",placeholder:"高度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[v,ie.value.height,void 0,{number:!0}]])])):i("",!0),"percentage"===ie.value.resizeMode?(a(),o("div",O,[d(s("input",{"onUpdate:modelValue":x[6]||(x[6]=e=>ie.value.percentage=e),type:"number",min:"10",max:"200",placeholder:"缩放比例 (%)",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[v,ie.value.percentage,void 0,{number:!0}]])])):i("",!0)]),s("div",null,[s("label",T,[d(s("input",{type:"checkbox","onUpdate:modelValue":x[7]||(x[7]=e=>ie.value.optimize=e),class:"w-4 h-4 text-blue-600"},null,512),[[m,ie.value.optimize]]),x[13]||(x[13]=s("span",null,"优化图片大小",-1))])])])])])):i("",!0),s("div",A,[s("button",{onClick:Pe,disabled:!ce.value.length||!ne.value||ve.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[ve.value?(a(),o("span",K,[x[15]||(x[15]=s("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),g(" 处理中... "+n(he.value)+"% ",1)])):(a(),o("span",I,"开始转换"))],8,H),s("button",{onClick:Ve,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),ve.value?(a(),o("div",Y,[s("div",Z,[x[16]||(x[16]=s("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),s("span",D,n(he.value)+"%",1)]),s("div",Q,[s("div",{class:"bg-blue-600 h-2.5 rounded-full",style:b({width:he.value+"%"})},null,4)]),s("p",S,n(xe.value),1)])):i("",!0),pe.value?(a(),o("div",X,[x[17]||(x[17]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",ee,n(me.value),1),s("div",le,[(a(!0),o(u,null,r(ye.value,(e,l)=>(a(),o("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+n(l+1),9,ae))),128))])])):i("",!0),ge.value?(a(),o("div",se,[x[18]||(x[18]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",te,n(ge.value),1),be.value?(a(),o("p",oe,"建议："+n(be.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{ue as default};
