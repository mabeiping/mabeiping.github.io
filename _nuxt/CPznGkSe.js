import{j as e,w as l,o as t,a,b as o,c as s,t as n,l as u,q as r,s as c,y as d,r as i}from"./CbGhm0ms.js";import{_ as m}from"./Pqfqo65y.js";import{G as p}from"./CmrO9Qsr.js";import{_ as b}from"./BCo6x5W8.js";import"./BE6raXpT.js";import"./Cx5n45vH.js";import"./CpN0-MvT.js";import"./D0kt2dsR.js";const v={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},g={class:"lg:col-span-3 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},y={key:0,class:"mt-4 p-4 bg-green-50 rounded-md"},x={class:"mt-2 space-y-2"},f={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},h={class:"space-y-4"},w={key:0,class:"mt-4 p-4 bg-blue-50 rounded-md"},k={class:"mt-2"},D={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},j={key:0,class:"mt-4 space-y-4"},U={key:0,class:"mt-4"},C={class:"w-full h-64 bg-gray-100 rounded-md flex items-center justify-center"},_=["src"],T={class:"mt-4 flex space-x-4"},$=b({__name:"index",setup(b){const $=i(null),R=i(null),E=e=>{$.value=e[0]},L=e=>{$.value=e,setTimeout(()=>{R.value={attendanceDays:22,absenceDays:3,overtimeHours:15}},1500)},M=()=>{const e=new Blob([JSON.stringify(R.value,null,2)],{type:"application/json"}),l=URL.createObjectURL(e),t=document.createElement("a");t.href=l,t.download="attendance-result.json",t.click(),URL.revokeObjectURL(l)},V=i({startDate:"",endDate:"",calcType:"workingDays"}),F=i(null),O=()=>{V.value.startDate&&V.value.endDate?setTimeout(()=>{const e=new Date(V.value.startDate),l=new Date(V.value.endDate),t=Math.abs(l-e),a=Math.ceil(t/864e5);switch(V.value.calcType){case"workingDays":F.value=`工作日数量: ${Math.floor(.7*a)} 天`;break;case"holidays":F.value=`节假日数量: ${Math.ceil(.3*a)} 天`;break;case"countdown":F.value=`距离目标日期还有: ${a} 天`}},1e3):F.value="请选择开始和结束日期"},S=i(null),z=i(null),G=i({type:"line"}),H=i(null),I=e=>{S.value=e[0]},N=e=>{S.value=e,z.value=!0},P=()=>{z.value&&setTimeout(()=>{H.value=`https://neeko-copilot.bytedance.net/api/text2image?prompt=${encodeURIComponent("data visualization chart")}&size=800x600`},1500)},q=e=>{if(!H.value)return;const l=document.createElement("a");l.href=H.value,l.download=`chart.${e}`,l.click()};return(i,b)=>(t(),e(m,{title:"日历/考勤/数据统计",description:"支持Excel考勤表自动统计、日期批量计算、表格数据生成图表"},{default:l(()=>[a("div",v,[a("div",g,[b[7]||(b[7]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Excel考勤表自动统计",-1)),o(p,{accept:[".xls",".xlsx",".csv"],multiple:!1,onFilesSelected:E,onUploadComplete:L}),R.value?(t(),s("div",y,[b[6]||(b[6]=a("h4",{class:"font-medium text-green-800"},"统计结果",-1)),a("div",x,[a("p",null,"出勤天数: "+n(R.value.attendanceDays),1),a("p",null,"缺勤天数: "+n(R.value.absenceDays),1),a("p",null,"加班时长: "+n(R.value.overtimeHours)+" 小时",1)]),a("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:M}," 下载统计结果 ")])):u("",!0)]),a("div",f,[b[13]||(b[13]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"日期批量计算",-1)),a("div",h,[a("div",null,[b[8]||(b[8]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"开始日期",-1)),r(a("input",{type:"date","onUpdate:modelValue":b[0]||(b[0]=e=>V.value.startDate=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,V.value.startDate]])]),a("div",null,[b[9]||(b[9]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"结束日期",-1)),r(a("input",{type:"date","onUpdate:modelValue":b[1]||(b[1]=e=>V.value.endDate=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[c,V.value.endDate]])]),a("div",null,[b[11]||(b[11]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"计算类型",-1)),r(a("select",{"onUpdate:modelValue":b[2]||(b[2]=e=>V.value.calcType=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[10]||(b[10]=[a("option",{value:"workingDays"},"工作日",-1),a("option",{value:"holidays"},"节假日",-1),a("option",{value:"countdown"},"倒计时",-1)])],512),[[d,V.value.calcType]])]),a("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:O}," 计算 ")]),F.value?(t(),s("div",w,[b[12]||(b[12]=a("h4",{class:"font-medium text-blue-800"},"计算结果",-1)),a("p",k,n(F.value),1)])):u("",!0)]),a("div",D,[b[17]||(b[17]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"表格数据生成图表",-1)),o(p,{accept:[".xls",".xlsx",".csv",".json"],multiple:!1,onFilesSelected:I,onUploadComplete:N}),z.value?(t(),s("div",j,[a("div",null,[b[15]||(b[15]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"图表类型",-1)),r(a("select",{"onUpdate:modelValue":b[3]||(b[3]=e=>G.value.type=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[14]||(b[14]=[a("option",{value:"line"},"折线图",-1),a("option",{value:"bar"},"柱状图",-1),a("option",{value:"pie"},"饼图",-1)])],512),[[d,G.value.type]])]),a("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:P}," 生成图表 "),H.value?(t(),s("div",U,[b[16]||(b[16]=a("h4",{class:"font-medium text-gray-900 mb-2"},"生成的图表",-1)),a("div",C,[a("img",{src:H.value,alt:"生成的图表",class:"max-w-full max-h-full"},null,8,_)]),a("div",T,[a("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:b[4]||(b[4]=e=>q("png"))}," 下载为PNG "),a("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:b[5]||(b[5]=e=>q("pdf"))}," 下载为PDF ")])])):u("",!0)])):u("",!0)])])]),_:1}))}},[["__scopeId","data-v-2b7caab4"]]);export{$ as default};
