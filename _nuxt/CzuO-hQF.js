import{i as j,w as S,o as u,a as t,b as w,c as i,t as c,f as p,j as m,k as h,p as k,l as a}from"./-R7zUpUx.js";import{_ as V}from"./1SagYtif.js";import{G as D}from"./zseaTYbb.js";import{_ as M}from"./DlAUqK2U.js";import"./C_FLJhYl.js";import"./Cu7bTl1K.js";const B={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},E={class:"lg:col-span-3 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},N={key:0,class:"mt-4 p-4 bg-green-50 rounded-md"},L={class:"mt-2 space-y-2"},O={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},A={class:"space-y-4"},G={key:0,class:"mt-4 p-4 bg-blue-50 rounded-md"},z={class:"mt-2"},H={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},I={key:0,class:"mt-4 space-y-4"},P={key:0,class:"mt-4"},J={class:"w-full h-64 bg-gray-100 rounded-md flex items-center justify-center"},q=["src"],K={class:"mt-4 flex space-x-4"},Q={__name:"index",setup(W){const g=a(null),n=a(null),C=o=>{g.value=o[0]},U=o=>{g.value=o,setTimeout(()=>{n.value={attendanceDays:22,absenceDays:3,overtimeHours:15}},1500)},R=()=>{const o=new Blob([JSON.stringify(n.value,null,2)],{type:"application/json"}),e=URL.createObjectURL(o),l=document.createElement("a");l.href=e,l.download="attendance-result.json",l.click(),URL.revokeObjectURL(e)},s=a({startDate:"",endDate:"",calcType:"workingDays"}),d=a(null),T=()=>{if(!s.value.startDate||!s.value.endDate){d.value="请选择开始和结束日期";return}setTimeout(()=>{const o=new Date(s.value.startDate),e=new Date(s.value.endDate),l=Math.abs(e-o),v=Math.ceil(l/(1e3*60*60*24));switch(s.value.calcType){case"workingDays":d.value=`工作日数量: ${Math.floor(v*.7)} 天`;break;case"holidays":d.value=`节假日数量: ${Math.ceil(v*.3)} 天`;break;case"countdown":d.value=`距离目标日期还有: ${v} 天`;break}},1e3)},f=a(null),b=a(null),y=a({type:"line"}),r=a(null),_=o=>{f.value=o[0]},F=o=>{f.value=o,b.value=!0},$=()=>{b.value&&setTimeout(()=>{r.value=`https://neeko-copilot.bytedance.net/api/text2image?prompt=${encodeURIComponent("data visualization chart")}&size=800x600`},1500)},x=o=>{if(!r.value)return;const e=document.createElement("a");e.href=r.value,e.download=`chart.${o}`,e.click()};return(o,e)=>(u(),j(V,{title:"日历/考勤/数据统计",description:"支持Excel考勤表自动统计、日期批量计算、表格数据生成图表"},{default:S(()=>[t("div",B,[t("div",E,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Excel考勤表自动统计",-1)),w(D,{accept:[".xls",".xlsx",".csv"],multiple:!1,onFilesSelected:C,onUploadComplete:U}),n.value?(u(),i("div",N,[e[6]||(e[6]=t("h4",{class:"font-medium text-green-800"},"统计结果",-1)),t("div",L,[t("p",null,"出勤天数: "+c(n.value.attendanceDays),1),t("p",null,"缺勤天数: "+c(n.value.absenceDays),1),t("p",null,"加班时长: "+c(n.value.overtimeHours)+" 小时",1)]),t("button",{class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:R}," 下载统计结果 ")])):p("",!0)]),t("div",O,[e[13]||(e[13]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"日期批量计算",-1)),t("div",A,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"开始日期",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=l=>s.value.startDate=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[h,s.value.startDate]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"结束日期",-1)),m(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=l=>s.value.endDate=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[h,s.value.endDate]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"计算类型",-1)),m(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.calcType=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[10]||(e[10]=[t("option",{value:"workingDays"},"工作日",-1),t("option",{value:"holidays"},"节假日",-1),t("option",{value:"countdown"},"倒计时",-1)])],512),[[k,s.value.calcType]])]),t("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:T}," 计算 ")]),d.value?(u(),i("div",G,[e[12]||(e[12]=t("h4",{class:"font-medium text-blue-800"},"计算结果",-1)),t("p",z,c(d.value),1)])):p("",!0)]),t("div",H,[e[17]||(e[17]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"表格数据生成图表",-1)),w(D,{accept:[".xls",".xlsx",".csv",".json"],multiple:!1,onFilesSelected:_,onUploadComplete:F}),b.value?(u(),i("div",I,[t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"图表类型",-1)),m(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>y.value.type=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[14]||(e[14]=[t("option",{value:"line"},"折线图",-1),t("option",{value:"bar"},"柱状图",-1),t("option",{value:"pie"},"饼图",-1)])],512),[[k,y.value.type]])]),t("button",{class:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:$}," 生成图表 "),r.value?(u(),i("div",P,[e[16]||(e[16]=t("h4",{class:"font-medium text-gray-900 mb-2"},"生成的图表",-1)),t("div",J,[t("img",{src:r.value,alt:"生成的图表",class:"max-w-full max-h-full"},null,8,q)]),t("div",K,[t("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:e[4]||(e[4]=l=>x("png"))}," 下载为PNG "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:e[5]||(e[5]=l=>x("pdf"))}," 下载为PDF ")])])):p("",!0)])):p("",!0)])])]),_:1}))}},oe=M(Q,[["__scopeId","data-v-2b7caab4"]]);export{oe as default};
