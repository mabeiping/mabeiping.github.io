import{i as I,w as J,o,a as e,b as O,c as n,F as z,r as C,t as i,f as m,j as b,v as W,k,p as A,y as D,d as H,x as K,l as d,m as Q}from"./-R7zUpUx.js";import{_ as X}from"./1SagYtif.js";import{G as Y}from"./zseaTYbb.js";import{s as Z}from"./CI8PMl9t.js";import"./C_FLJhYl.js";import"./Cu7bTl1K.js";import"./DlAUqK2U.js";const ee={class:"space-y-6"},te={key:0,class:"bg-gray-50 p-4 rounded-lg"},le={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},se={class:"flex justify-center mb-3"},oe=["src"],ae={class:"text-center"},ne={class:"font-medium truncate"},re={class:"text-sm text-gray-500"},ie=["onClick"],ue={key:1,class:"bg-gray-50 p-4 rounded-lg"},de={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},ce=["value"],ve={class:"text-center"},pe={class:"font-medium"},me={class:"text-sm text-gray-500"},ge={key:2,class:"space-y-4"},be={class:"bg-gray-50 p-4 rounded-lg"},fe={class:"space-y-3"},he={class:"text-right text-sm text-gray-500"},xe={key:0,class:"mt-2 grid grid-cols-2 gap-2"},ye={key:1,class:"mt-2"},_e={class:"flex items-center space-x-2"},we={class:"flex space-x-4"},ke=["disabled"],Fe={key:0},ze={key:1,class:"flex items-center justify-center"},Ce={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Me={class:"flex items-center justify-between mb-2"},Pe={class:"text-blue-700"},Ve={class:"w-full bg-gray-200 rounded-full h-2.5"},je={class:"mt-2 text-sm text-blue-700"},Be={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Ue={class:"mt-2 text-green-700"},Ge={class:"mt-3 space-y-2"},$e=["href","download"],Le={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Se={class:"mt-2 text-red-700"},Ee={key:0,class:"mt-2 text-sm text-gray-600"},Ae={__name:"index",setup(Ne){const M=[{value:"png",label:"PNG",description:"无损压缩格式",extensions:[".png"]},{value:"jpg",label:"JPG",description:"有损压缩格式",extensions:[".jpg",".jpeg"]},{value:"webp",label:"WebP",description:"现代图片格式",extensions:[".webp"]}],u=d(""),a=d({quality:80,resizeMode:"original",width:0,height:0,percentage:100,optimize:!0}),v=d([]),p=Q(()=>v.value),y=d(!1),_=d(!1),F=d(""),c=d(""),f=d(""),h=d(0),x=d(""),g=d([]),w=d([]),G=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：图片质量、尺寸调整等",'5. 点击"开始转换"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保图片质量和格式的准确性"],P=s=>s.split(".").pop().toLowerCase(),$=s=>{if(s===0)return"0 B";const t=1024,l=["B","KB","MB","GB"],r=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,r)).toFixed(2))+" "+l[r]},L=s=>{v.value.splice(s,1),v.value.length===0?B():V()},S=s=>{v.value=s,s.length>0?V():(w.value=[],u.value=""),c.value="",_.value=!1},V=()=>{if(v.value.length===0){w.value=[];return}const s=P(v.value[0].name),t=[];M.forEach(l=>{l.extensions.some(r=>s===r.replace(".",""))||t.push(l)}),w.value=t,t.length>0?u.value=t[0].value:u.value=""},E=s=>{c.value=s,f.value=j(s)},j=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",N=()=>new Promise(s=>{let t=0;const l=Z(()=>{t+=Math.floor(Math.random()*10)+5,t>100&&(t=100),h.value=t,t<30?x.value="正在分析图片...":t<70?x.value="正在转换图片...":x.value="正在生成结果...",t===100&&(clearInterval(l),setTimeout(s,500))},500)}),T=async()=>{if(p.length===0){c.value="请选择文件";return}if(!u.value){c.value="请选择目标格式";return}y.value=!0,c.value="",f.value="",_.value=!1,h.value=0,x.value="准备转换...",g.value=[];try{await N();let s={files:p.value,targetFormat:u.value,options:a.value};console.log("转换参数:",s);const t=M.find(l=>l.value===u.value);F.value=`成功将 ${p.length} 个图片转换为 ${t.label} 格式！`,_.value=!0,p.forEach((l,r)=>{const U=new Blob(["模拟转换后的图片内容"],{type:`image/${u.value}`}),q=URL.createObjectURL(U),R=`converted_${l.name.replace(/\.[^/.]+$/,`.${u.value}`)}`;g.value.push({url:q,filename:R})}),g.value.length>0&&setTimeout(()=>{const l=document.createElement("a");l.href=g.value[0].url,l.download=g.value[0].filename,document.body.appendChild(l),l.click(),document.body.removeChild(l)},1e3)}catch(s){c.value=`转换失败：${s.message||"未知错误"}`,f.value=j(c.value)}finally{y.value=!1}},B=()=>{v.value=[],u.value="",a.value={quality:80,resizeMode:"original",width:0,height:0,percentage:100,optimize:!0},c.value="",f.value="",_.value=!1,F.value="",h.value=0,x.value="",g.value=[],w.value=[]};return(s,t)=>(o(),I(X,{title:"图片格式转换",description:"支持PNG/JPG/WebP互转",tips:G},{default:J(()=>[e("div",ee,[O(Y,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":50*1024*1024,modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),onFilesChanged:S,onError:E},null,8,["modelValue"]),p.value.length>0?(o(),n("div",te,[t[8]||(t[8]=e("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),e("div",le,[(o(!0),n(z,null,C(p.value,(l,r)=>(o(),n("div",{key:r,class:"bg-white rounded border p-3"},[e("div",se,[e("img",{src:s.URL.createObjectURL(l),class:"max-h-32 object-contain",alt:"Preview"},null,8,oe)]),e("div",ae,[e("div",ne,i(l.name),1),e("div",re,i(P(l.name))+" • "+i($(l.size)),1)]),e("button",{onClick:U=>L(r),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,ie)]))),128))])])):m("",!0),p.value.length>0?(o(),n("div",ue,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),e("div",de,[(o(!0),n(z,null,C(w.value,l=>(o(),n("label",{key:l.value,class:"flex flex-col items-center space-y-2 cursor-pointer p-4 border rounded-lg hover:bg-gray-100"},[b(e("input",{type:"radio","onUpdate:modelValue":t[1]||(t[1]=r=>u.value=r),value:l.value,class:"w-4 h-4 text-blue-600"},null,8,ce),[[W,u.value]]),e("div",ve,[e("div",pe,i(l.label),1),e("div",me,i(l.description),1)])]))),128))])])):m("",!0),p.value.length>0?(o(),n("div",ge,[e("div",be,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold mb-3"},"转换选项",-1)),e("div",fe,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"图片质量",-1)),b(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.quality=l),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[k,a.value.quality,void 0,{number:!0}]]),e("div",he,i(a.value.quality)+"%",1)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"调整尺寸",-1)),b(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.resizeMode=l),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[11]||(t[11]=[e("option",{value:"original"},"保持原始尺寸",-1),e("option",{value:"custom"},"自定义尺寸",-1),e("option",{value:"percentage"},"按比例调整",-1)])],512),[[A,a.value.resizeMode]]),a.value.resizeMode==="custom"?(o(),n("div",xe,[b(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.width=l),type:"number",placeholder:"宽度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[k,a.value.width,void 0,{number:!0}]]),b(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>a.value.height=l),type:"number",placeholder:"高度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[k,a.value.height,void 0,{number:!0}]])])):m("",!0),a.value.resizeMode==="percentage"?(o(),n("div",ye,[b(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>a.value.percentage=l),type:"number",min:"10",max:"200",placeholder:"缩放比例 (%)",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[k,a.value.percentage,void 0,{number:!0}]])])):m("",!0)]),e("div",null,[e("label",_e,[b(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=l=>a.value.optimize=l),class:"w-4 h-4 text-blue-600"},null,512),[[D,a.value.optimize]]),t[13]||(t[13]=e("span",null,"优化图片大小",-1))])])])])])):m("",!0),e("div",we,[e("button",{onClick:T,disabled:!p.value.length||!u.value||y.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[y.value?(o(),n("span",ze,[t[15]||(t[15]=e("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),H(" 处理中... "+i(h.value)+"% ",1)])):(o(),n("span",Fe,"开始转换"))],8,ke),e("button",{onClick:B,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),y.value?(o(),n("div",Ce,[e("div",Me,[t[16]||(t[16]=e("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),e("span",Pe,i(h.value)+"%",1)]),e("div",Ve,[e("div",{class:"bg-blue-600 h-2.5 rounded-full",style:K({width:h.value+"%"})},null,4)]),e("p",je,i(x.value),1)])):m("",!0),_.value?(o(),n("div",Be,[t[17]||(t[17]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),e("p",Ue,i(F.value),1),e("div",Ge,[(o(!0),n(z,null,C(g.value,(l,r)=>(o(),n("a",{key:r,href:l.url,download:l.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+i(r+1),9,$e))),128))])])):m("",!0),c.value?(o(),n("div",Le,[t[18]||(t[18]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),e("p",Se,i(c.value),1),f.value?(o(),n("p",Ee,"建议："+i(f.value),1)):m("",!0)])):m("",!0)])]),_:1}))}};export{Ae as default};
