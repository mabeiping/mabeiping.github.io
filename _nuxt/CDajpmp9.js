import{i as A,w as I,o as a,a as t,b as T,c as n,F as z,r as B,t as r,f as c,j as p,p as V,k as _,y as H,d as J,x as W,l as u,m as K}from"./-R7zUpUx.js";import{_ as Q}from"./1SagYtif.js";import{G as X}from"./zseaTYbb.js";import{s as Y}from"./CI8PMl9t.js";import"./C_FLJhYl.js";import"./Cu7bTl1K.js";import"./DlAUqK2U.js";const Z={class:"space-y-6"},ee={key:0,class:"bg-gray-50 p-4 rounded-lg"},te={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},se={class:"flex justify-center mb-3"},le=["src"],oe={class:"text-center"},ae={class:"font-medium truncate"},ne={class:"text-sm text-gray-500"},re={key:0,class:"text-sm text-gray-500"},ie=["onClick"],ue={key:1,class:"space-y-4"},de={class:"bg-gray-50 p-4 rounded-lg"},ce={class:"space-y-3"},ve={key:0,class:"space-y-2"},me={class:"grid grid-cols-2 gap-2"},pe={class:"flex items-center space-x-2"},ge={key:1},be={class:"text-right text-sm text-gray-500"},xe={key:2},fe={class:"bg-gray-50 p-4 rounded-lg"},he={class:"space-y-3"},ye={key:0},we={class:"text-right text-sm text-gray-500"},ke={class:"flex space-x-4"},_e=["disabled"],Ce={key:0},Ue={key:1,class:"flex items-center justify-center"},Ve={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},je={class:"flex items-center justify-between mb-2"},Fe={class:"text-blue-700"},Pe={class:"w-full bg-gray-200 rounded-full h-2.5"},ze={class:"mt-2 text-sm text-blue-700"},Be={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Me={class:"mt-2 text-green-700"},Re={class:"mt-3 space-y-2"},Le=["href","download"],Se={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},$e={class:"mt-2 text-red-700"},Ge={key:0,class:"mt-2 text-sm text-gray-600"},He={__name:"index",setup(Oe){const o=u({mode:"pixels",width:800,height:600,maintainAspectRatio:!0,percentage:100,preset:"1920x1080"}),d=u({format:"same",quality:90}),g=u([]),m=K(()=>g.value),b=u([]),w=u(!1),k=u(!1),C=u(""),v=u(""),h=u(""),y=u(0),x=u(""),f=u([]),M=["1. 上传图片：支持PNG、JPG和WebP格式，可批量上传","2. 选择调整模式：按像素、按百分比或预设尺寸","3. 设置调整参数：根据选择的模式设置相应的参数","4. 配置输出设置：选择输出格式和质量",'5. 点击"开始调整"按钮进行处理',"6. 等待处理完成，下载调整后的图片"],j=l=>l.split(".").pop().toLowerCase(),R=l=>{if(l===0)return"0 B";const e=1024,s=["B","KB","MB","GB"],i=Math.floor(Math.log(l)/Math.log(e));return parseFloat((l/Math.pow(e,i)).toFixed(2))+" "+s[i]},L=l=>new Promise(e=>{const s=new Image;s.onload=()=>{e({width:s.width,height:s.height})},s.onerror=()=>{e({width:0,height:0})},s.src=URL.createObjectURL(l)}),S=l=>{g.value.splice(l,1),b.value.splice(l,1),g.value.length===0&&P()},$=async l=>{g.value=l,b.value=[];for(const e of l){const s=await L(e);b.value.push(s)}v.value="",k.value=!1},G=l=>{v.value=l,h.value=F(l)},F=l=>l.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":l.includes("文件类型")?"请确保上传的文件格式受支持":l.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",O=()=>new Promise(l=>{let e=0;const s=Y(()=>{e+=Math.floor(Math.random()*10)+5,e>100&&(e=100),y.value=e,e<30?x.value="正在分析图片...":e<60?x.value="正在计算新尺寸...":e<90?x.value="正在调整图片大小...":x.value="正在生成结果...",e===100&&(clearInterval(s),setTimeout(l,500))},500)}),D=async()=>{if(m.length===0){v.value="请选择文件";return}w.value=!0,v.value="",h.value="",k.value=!1,y.value=0,x.value="准备处理...",f.value=[];try{await O();let l={files:m.value,resizeOptions:o.value,outputOptions:d.value};console.log("处理参数:",l),C.value=`成功调整 ${m.length} 个图片的尺寸！`,k.value=!0,m.forEach((e,s)=>{const i=j(e.name),U=d.value.format==="same"?i:d.value.format,E=new Blob(["模拟调整尺寸后的图片内容"],{type:`image/${U}`}),N=URL.createObjectURL(E),q=`resized_${e.name.replace(/\.[^/.]+$/,`.${U}`)}`;f.value.push({url:N,filename:q})}),f.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=f.value[0].url,e.download=f.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(l){v.value=`处理失败：${l.message||"未知错误"}`,h.value=F(v.value)}finally{w.value=!1}},P=()=>{g.value=[],b.value=[],o.value={mode:"pixels",width:800,height:600,maintainAspectRatio:!0,percentage:100,preset:"1920x1080"},d.value={format:"same",quality:90},v.value="",h.value="",k.value=!1,C.value="",y.value=0,x.value="",f.value=[]};return(l,e)=>(a(),A(Q,{title:"图片尺寸调整",description:"调整图片大小，保持或改变宽高比",tips:M},{default:I(()=>[t("div",Z,[T(X,{multiple:!0,accept:[".png",".jpg",".jpeg",".webp"],"max-size":100*1024*1024,modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s),onFilesChanged:$,onError:G},null,8,["modelValue"]),m.value.length>0?(a(),n("div",ee,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",te,[(a(!0),n(z,null,B(m.value,(s,i)=>(a(),n("div",{key:i,class:"bg-white rounded border p-3"},[t("div",se,[t("img",{src:l.URL.createObjectURL(s),class:"max-h-32 object-contain",alt:"Preview"},null,8,le)]),t("div",oe,[t("div",ae,r(s.name),1),t("div",ne,r(j(s.name))+" • "+r(R(s.size)),1),b.value[i]?(a(),n("div",re,r(b.value[i].width)+"x"+r(b.value[i].height)+"px ",1)):c("",!0)]),t("button",{onClick:U=>S(i),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,ie)]))),128))])])):c("",!0),m.value.length>0?(a(),n("div",ue,[t("div",de,[e[15]||(e[15]=t("h3",{class:"text-lg font-semibold mb-3"},"调整设置",-1)),t("div",ce,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"调整模式",-1)),p(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.mode=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[10]||(e[10]=[t("option",{value:"pixels"},"按像素调整",-1),t("option",{value:"percentage"},"按百分比调整",-1),t("option",{value:"preset"},"预设尺寸",-1)])],512),[[V,o.value.mode]])]),o.value.mode==="pixels"?(a(),n("div",ve,[t("div",me,[p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.width=s),type:"number",placeholder:"宽度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,o.value.width,void 0,{number:!0}]]),p(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.height=s),type:"number",placeholder:"高度 (px)",class:"border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,o.value.height,void 0,{number:!0}]])]),t("div",null,[t("label",pe,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=s=>o.value.maintainAspectRatio=s),class:"w-4 h-4 text-blue-600"},null,512),[[H,o.value.maintainAspectRatio]]),e[12]||(e[12]=t("span",null,"保持宽高比",-1))])])])):c("",!0),o.value.mode==="percentage"?(a(),n("div",ge,[p(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.percentage=s),type:"range",min:"10",max:"200",class:"w-full"},null,512),[[_,o.value.percentage,void 0,{number:!0}]]),t("div",be,r(o.value.percentage)+"%",1)])):c("",!0),o.value.mode==="preset"?(a(),n("div",xe,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"预设尺寸",-1)),p(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.preset=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[13]||(e[13]=[t("option",{value:"1920x1080"},"1920x1080 (Full HD)",-1),t("option",{value:"1280x720"},"1280x720 (HD)",-1),t("option",{value:"800x600"},"800x600 (标准)",-1),t("option",{value:"600x600"},"600x600 (正方形)",-1),t("option",{value:"400x400"},"400x400 (小正方形)",-1),t("option",{value:"300x300"},"300x300 (缩略图)",-1),t("option",{value:"1080x1920"},"1080x1920 (竖屏)",-1)])],512),[[V,o.value.preset]])])):c("",!0)])]),t("div",fe,[e[19]||(e[19]=t("h3",{class:"text-lg font-semibold mb-3"},"输出设置",-1)),t("div",he,[t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),p(t("select",{"onUpdate:modelValue":e[7]||(e[7]=s=>d.value.format=s),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[16]||(e[16]=[t("option",{value:"same"},"保持原格式",-1),t("option",{value:"png"},"PNG",-1),t("option",{value:"jpg"},"JPG",-1),t("option",{value:"webp"},"WebP",-1)])],512),[[V,d.value.format]])]),d.value.format==="jpg"||d.value.format==="webp"?(a(),n("div",ye,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出质量",-1)),p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>d.value.quality=s),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[_,d.value.quality,void 0,{number:!0}]]),t("div",we,r(d.value.quality)+"%",1)])):c("",!0)])])])):c("",!0),t("div",ke,[t("button",{onClick:D,disabled:!m.value.length||w.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[w.value?(a(),n("span",Ue,[e[20]||(e[20]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),J(" 处理中... "+r(y.value)+"% ",1)])):(a(),n("span",Ce,"开始调整"))],8,_e),t("button",{onClick:P,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),w.value?(a(),n("div",Ve,[t("div",je,[e[21]||(e[21]=t("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),t("span",Fe,r(y.value)+"%",1)]),t("div",Pe,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:W({width:y.value+"%"})},null,4)]),t("p",ze,r(x.value),1)])):c("",!0),k.value?(a(),n("div",Be,[e[22]||(e[22]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),t("p",Me,r(C.value),1),t("div",Re,[(a(!0),n(z,null,B(f.value,(s,i)=>(a(),n("a",{key:i,href:s.url,download:s.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载调整结果 "+r(i+1),9,Le))),128))])])):c("",!0),v.value?(a(),n("div",Se,[e[23]||(e[23]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),t("p",$e,r(v.value),1),h.value?(a(),n("p",Ge,"建议："+r(h.value),1)):c("",!0)])):c("",!0)])]),_:1}))}};export{He as default};
