import{_}from"./DcxfYlri.js";import{e as C,u as D,h as T,w as B,o as f,a as e,c as v,i as g,j as i,f as l,t as a,k as y,l as w,m as b}from"./Bbp9ol3F.js";import"./DxtqSkkZ.js";import"./CymrFrSx.js";const E={class:"space-y-6"},M={class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors"},z={key:0,class:"space-y-4"},W={class:"p-4 bg-gray-50 rounded-lg"},X={class:"font-medium text-text-primary"},L={class:"text-sm text-text-secondary"},R={class:"grid grid-cols-2 gap-4"},S=["disabled"],U={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},V={class:"space-y-1 text-sm text-green-700"},q={__name:"office-format-converter",setup(j){const m=i(null),n=i(null),c=i("pdf"),u=i("medium"),d=i(!1),r=i(null),h=()=>{m.value?.click()},k=o=>{const t=o.target.files[0];t&&(["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"].includes(t.type)?n.value=t:alert("请选择有效的Office文件（Word、Excel、PPT）"))},P=()=>{n.value=null,r.value=null},x=o=>{if(o===0)return"0 Bytes";const t=1024,p=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(o)/Math.log(t));return Math.round(o/Math.pow(t,s)*100)/100+" "+p[s]},F=async()=>{if(!n.value){alert("请先选择Office文件");return}d.value=!0;try{await new Promise(t=>setTimeout(t,2e3));const o={pdf:"PDF",docx:"Word (DOCX)",xlsx:"Excel (XLSX)",pptx:"PowerPoint (PPTX)"};r.value={originalFormat:n.value.name.split(".").pop(),outputFormat:o[c.value],size:n.value.size}}catch(o){console.error("Conversion error:",o),alert("转换失败，请重试")}finally{d.value=!1}},O=()=>{if(!r.value||!n.value)return;const o=document.createElement("a");o.href=URL.createObjectURL(n.value);const t={pdf:".pdf",docx:".docx",xlsx:".xlsx",pptx:".pptx"};o.download=`converted${t[c.value]}`,o.click(),URL.revokeObjectURL(o.href)};return C(),D({title:"Office转换 - 免费在线Office格式转换工具 - 办公工具箱",meta:[{name:"description",content:"免费在线Office格式转换工具，支持Word、Excel、PPT、PDF等格式互转。保持原有格式，支持批量转换，无需安装，即传即用，保护文件隐私。"},{name:"keywords",content:"Office转换, Word转PDF, Excel转PDF, PPT转PDF, PDF转Word, 文档格式转换, 免费格式转换, 在线格式转换, Office格式互转, 文档转换工具, 文件格式转换"},{name:"author",content:"办公工具箱"},{property:"og:title",content:"Office转换 - 免费在线Office格式转换工具 - 办公工具箱"},{property:"og:description",content:"免费在线Office格式转换工具，支持Word、Excel、PPT、PDF等格式互转"},{property:"og:type",content:"website"},{property:"og:url",content:"https://www.worktoolkit.top/tools/format/office-format-converter"},{property:"og:locale",content:"zh_CN"}],link:[{rel:"canonical",href:"https://www.worktoolkit.top/tools/format/office-format-converter"}]}),(o,t)=>{const p=_;return f(),T(p,{title:"Office转换",description:"Office文档格式转换"},{default:B(()=>[e("div",E,[e("div",M,[e("input",{ref_key:"fileInput",ref:m,type:"file",accept:".doc,.docx,.xls,.xlsx,.ppt,.pptx",class:"hidden",onChange:k},null,544),e("div",{class:"space-y-4"},[t[2]||(t[2]=e("svg",{class:"w-16 h-16 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("button",{onClick:h,class:"px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"}," 选择Office文件 "),t[3]||(t[3]=e("p",{class:"text-sm text-text-secondary"},"支持 Word、Excel、PPT",-1))])]),l(n)?(f(),v("div",z,[e("div",{class:"flex items-center justify-between"},[t[4]||(t[4]=e("h3",{class:"text-lg font-bold text-text-primary"},"已选择文件",-1)),e("button",{onClick:P,class:"text-sm text-red-500 hover:text-red-600 transition-colors"}," 清除 ")]),e("div",W,[e("p",X,a(l(n).name),1),e("p",L,a(x(l(n).size)),1)]),e("div",R,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-text-primary mb-2"},"输出格式",-1)),y(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>w(c)?c.value=s:null),class:"w-full px-3 py-2 border rounded-lg focus:outline-none"},[...t[5]||(t[5]=[e("option",{value:"pdf"},"PDF",-1),e("option",{value:"docx"},"Word (DOCX)",-1),e("option",{value:"xlsx"},"Excel (XLSX)",-1),e("option",{value:"pptx"},"PowerPoint (PPTX)",-1)])],512),[[b,l(c)]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-text-primary mb-2"},"质量",-1)),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>w(u)?u.value=s:null),class:"w-full px-3 py-2 border rounded-lg focus:outline-none"},[...t[7]||(t[7]=[e("option",{value:"high"},"高质量",-1),e("option",{value:"medium"},"中等质量",-1),e("option",{value:"low"},"低质量（文件更小）",-1)])],512),[[b,l(u)]])])]),e("button",{onClick:F,disabled:l(d),class:"w-full py-3 bg-gradient-to-r from-primary to-primary-light text-white rounded-lg font-medium hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed"},a(l(d)?"转换中...":"开始转换"),9,S)])):g("",!0),l(r)?(f(),v("div",U,[t[9]||(t[9]=e("h3",{class:"font-bold text-green-800 mb-2"},"转换完成！",-1)),e("div",V,[e("p",null,"原始格式："+a(l(r).originalFormat),1),e("p",null,"输出格式："+a(l(r).outputFormat),1),e("p",null,"文件大小："+a(x(l(r).size)),1)]),e("button",{onClick:O,class:"w-full mt-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"}," 下载转换后的文件 ")])):g("",!0)])]),_:1})}}};export{q as default};
