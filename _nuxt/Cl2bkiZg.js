import{j as e,w as l,o as a,a as t,q as s,y as o,b as r,c as u,s as d,l as n,t as i,C as c,r as m,x as p}from"./BgOf89w3.js";import{_ as b}from"./2wcj7HJB.js";import{G as g}from"./B8Y4AogL.js";import{_ as v}from"./BCo6x5W8.js";import"./BUkw5g4p.js";import"./BX-X-UIx.js";import"./COINl4vt.js";import"./B2Jz3f8v.js";const x={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},y={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},f={class:"space-y-4"},h={key:0},k={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},w={key:0,class:"mt-4 p-4 bg-gray-50 rounded-md"},C={class:"text-sm text-gray-600"},j={key:0},_={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},M={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},U={class:"flex items-center space-x-2"},V=["disabled"],B={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},T={key:0,class:"mt-4 space-y-4"},$={class:"p-4 bg-green-50 rounded-md"},F={class:"mt-2"},S={key:0},A={class:"text-sm text-gray-600"},E={key:1,class:"mt-4"},G=v({__name:"index",setup(v){const G=m("email"),R=m(null),q=m(""),z=e=>{R.value=e[0]},H=e=>{R.value=e},I=m(null),K=m(null),L=e=>{I.value=e[0]},W=e=>{I.value=e,setTimeout(()=>{K.value=Array(10).fill(null).map((e,l)=>({id:l+1,name:`测试数据${l+1}`,value:`值${l+1}`}))},1e3)},X=m("txt"),Y=m(10),Z=m(!1),D=m(!1),J=m(null),N=p(()=>"custom"===G.value?!!q.value&&!!I.value:!!R.value&&!!I.value),O=()=>{N.value&&(D.value=!0,setTimeout(()=>{J.value={count:Y.value,files:Array(Y.value).fill(null).map((e,l)=>({id:l+1,name:`document-${l+1}.${X.value}`,url:"#"})),plagiarismCheck:Z.value?{duplicationRate:20*Math.random(),details:"查重完成"}:null},D.value=!1},2e3))},P=()=>{alert("开始下载结果文件")},Q=()=>{alert("预览功能开发中")},ee=e=>{if(0===e)return"0 Bytes";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB"][l]};return(m,p)=>(a(),e(b,{title:"邮件/文案批量生成",description:"支持按Excel模板批量生成邮件正文/办公文案、自定义模板关键词替换"},{default:l(()=>[t("div",x,[t("div",y,[p[9]||(p[9]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"模板设置",-1)),t("div",f,[t("div",null,[p[6]||(p[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"模板类型",-1)),s(t("select",{"onUpdate:modelValue":p[0]||(p[0]=e=>G.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...p[5]||(p[5]=[t("option",{value:"email"},"邮件模板",-1),t("option",{value:"document"},"办公文案",-1),t("option",{value:"custom"},"自定义模板",-1)])],512),[[o,G.value]])]),t("div",null,[p[7]||(p[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"模板文件",-1)),r(g,{accept:[".doc",".docx",".txt",".html"],multiple:!1,onFilesSelected:z,onUploadComplete:H})]),"custom"===G.value?(a(),u("div",h,[p[8]||(p[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"自定义模板内容",-1)),s(t("textarea",{"onUpdate:modelValue":p[1]||(p[1]=e=>q.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[200px]",placeholder:"输入模板内容，使用{{变量名}}标记需要替换的变量"},null,512),[[d,q.value]])])):n("",!0)])]),t("div",k,[p[11]||(p[11]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"数据文件",-1)),p[12]||(p[12]=t("p",{class:"text-sm text-gray-600 mb-4"},"上传包含变量数据的Excel或CSV文件",-1)),r(g,{accept:[".xls",".xlsx",".csv"],multiple:!1,onFilesSelected:L,onUploadComplete:W}),I.value?(a(),u("div",w,[p[10]||(p[10]=t("h4",{class:"font-medium text-gray-900 mb-2"},"数据预览",-1)),t("div",C,[t("p",null,"文件: "+i(I.value.name),1),t("p",null,"大小: "+i(ee(I.value.size)),1),K.value?(a(),u("p",j,"数据行数: "+i(K.value.length),1)):n("",!0)])])):n("",!0)]),t("div",_,[p[18]||(p[18]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"生成设置",-1)),t("div",M,[t("div",null,[p[14]||(p[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),s(t("select",{"onUpdate:modelValue":p[2]||(p[2]=e=>X.value=e),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...p[13]||(p[13]=[t("option",{value:"txt"},"TXT",-1),t("option",{value:"docx"},"Word",-1),t("option",{value:"html"},"HTML",-1)])],512),[[o,X.value]])]),t("div",null,[p[15]||(p[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"生成数量",-1)),s(t("input",{type:"number","onUpdate:modelValue":p[3]||(p[3]=e=>Y.value=e),min:"1",max:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[d,Y.value,void 0,{number:!0}]])]),t("div",null,[p[17]||(p[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"操作选项",-1)),t("div",U,[s(t("input",{type:"checkbox",id:"enableCheck","onUpdate:modelValue":p[4]||(p[4]=e=>Z.value=e),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[c,Z.value]]),p[16]||(p[16]=t("label",{for:"enableCheck",class:"text-sm text-gray-700"},"启用查重",-1))])])]),t("button",{class:"mt-6 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:O,disabled:!N.value}," 开始生成 ",8,V)]),t("div",B,[p[22]||(p[22]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"生成结果",-1)),J.value?(a(),u("div",T,[t("div",$,[p[20]||(p[20]=t("h4",{class:"font-medium text-green-800"},"生成成功",-1)),t("p",F,"成功生成 "+i(J.value.count)+" 份文档",1),Z.value&&J.value.plagiarismCheck?(a(),u("div",S,[p[19]||(p[19]=t("h5",{class:"font-medium text-gray-900 mt-3"},"查重结果",-1)),t("p",A,"重复率: "+i(J.value.plagiarismCheck.duplicationRate)+"%",1)])):n("",!0)]),t("div",{class:"flex flex-wrap gap-3"},[t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:P}," 下载全部结果 "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:Q}," 预览结果 ")])])):D.value?(a(),u("div",E,[...p[21]||(p[21]=[t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),t("span",{class:"text-gray-700"},"正在生成文档...")],-1)])])):n("",!0)])])]),_:1}))}},[["__scopeId","data-v-36141314"]]);export{G as default};
