import{_ as e,w as l,m as a,p as s,q as t,n as o,z as n,a8 as u,D as c,K as i,x as r,v,F as p,u as d,k as m}from"./DFWWPSrV.js";import{_ as b}from"./C1jkWaCi.js";import{G as y}from"./BGFgIxDv.js";import{_ as f}from"./nEzmyvu1.js";import"./CdYbPlRr.js";import"./BM3HdAYC.js";import"./DUMejLMI.js";const w={class:"ocr-table-tool"},x={class:"upload-section"},k={key:0,class:"options-section"},h={class:"option-group"},g={class:"flex items-center space-x-2"},D={class:"flex items-center space-x-2 mt-2"},_={class:"flex items-center space-x-2 mt-2"},j={key:1,class:"process-section"},U=["disabled"],F={key:0},C={key:1},z={key:2,class:"progress-section"},E={class:"progress-bar"},P={class:"text-sm text-gray-500 mt-1"},H={key:3,class:"result-section"},L={class:"result-info"},S={key:0,class:"table-preview"},V={class:"preview-table-container"},I={class:"preview-table"},O={key:4,class:"error-section"},T={class:"error-message"},q=f({__name:"index",setup(f){const q=m(null),A=m(!1),B=m(0),G=m(""),J=m(null),K=m(""),M=m({autoDetect:!0,optimizeLayout:!0,includeHeaders:!0}),N=e=>{q.value=e,K.value="",J.value=null},R=()=>{q.value=null,K.value="",J.value=null},Q=async()=>{if(q.value){A.value=!0,B.value=0,G.value="准备处理...",K.value="",J.value=null;try{const e=new FormData;e.append("files",q.value),e.append("options",JSON.stringify(M.value));const l=await fetch("/api/ocr/table",{method:"POST",body:e});if(!l.ok)throw new Error("API请求失败");const a=await l.json();if(!a.success)throw new Error(a.message||"处理失败");{const e=a.data[0];J.value={tableCount:e.tableCount,previewData:e.previewData,downloadUrl:e.downloadUrl}}}catch(e){K.value=e.message||"处理失败，请重试"}finally{A.value=!1}}else K.value="请先上传文件"},W=()=>{J.value?.downloadUrl&&window.open(J.value.downloadUrl,"_blank")};return(m,f)=>(a(),e(b,{title:"表格识别",description:"识别图片或PDF中的表格内容，转换为Excel格式"},{default:l(()=>[s("div",w,[s("div",x,[f[3]||(f[3]=s("h3",null,"上传文件",-1)),t(y,{accept:["image/*",".pdf"],multiple:!1,onFileUploaded:N,onFileRemoved:R}),f[4]||(f[4]=s("p",{class:"text-sm text-gray-500 mt-2"},"支持图片和PDF文件，单个文件大小不超过10MB",-1))]),q.value?(a(),o("div",k,[f[8]||(f[8]=s("h3",null,"处理选项",-1)),s("div",h,[s("label",g,[n(s("input",{type:"checkbox","onUpdate:modelValue":f[0]||(f[0]=e=>M.value.autoDetect=e),class:"form-checkbox"},null,512),[[u,M.value.autoDetect]]),f[5]||(f[5]=s("span",null,"自动检测表格",-1))]),s("label",D,[n(s("input",{type:"checkbox","onUpdate:modelValue":f[1]||(f[1]=e=>M.value.optimizeLayout=e),class:"form-checkbox"},null,512),[[u,M.value.optimizeLayout]]),f[6]||(f[6]=s("span",null,"优化表格布局",-1))]),s("label",_,[n(s("input",{type:"checkbox","onUpdate:modelValue":f[2]||(f[2]=e=>M.value.includeHeaders=e),class:"form-checkbox"},null,512),[[u,M.value.includeHeaders]]),f[7]||(f[7]=s("span",null,"识别表头",-1))])])])):c("",!0),q.value?(a(),o("div",j,[s("button",{class:"btn btn-primary",onClick:Q,disabled:A.value},[A.value?(a(),o("span",C,"处理中...")):(a(),o("span",F,"开始识别"))],8,U)])):c("",!0),A.value?(a(),o("div",z,[s("div",E,[s("div",{class:"progress-fill",style:i({width:B.value+"%"})},null,4)]),s("p",P,r(G.value),1)])):c("",!0),J.value?(a(),o("div",H,[f[13]||(f[13]=s("h3",null,"识别结果",-1)),s("div",L,[s("p",null,[f[9]||(f[9]=v("识别成功！共识别到 ",-1)),s("strong",null,r(J.value.tableCount),1),f[10]||(f[10]=v(" 个表格",-1))]),s("button",{class:"btn btn-secondary mt-3",onClick:W},[...f[11]||(f[11]=[s("i",{class:"fas fa-download mr-2"},null,-1),v("下载Excel文件 ",-1)])])]),J.value.previewData&&J.value.previewData.length>0?(a(),o("div",S,[f[12]||(f[12]=s("h4",null,"表格预览",-1)),s("div",V,[s("table",I,[s("thead",null,[s("tr",null,[(a(!0),o(p,null,d(J.value.previewData[0],(e,l)=>(a(),o("th",{key:l},r(e),1))),128))])]),s("tbody",null,[(a(!0),o(p,null,d(J.value.previewData.slice(1),(e,l)=>(a(),o("tr",{key:l},[(a(!0),o(p,null,d(e,(e,l)=>(a(),o("td",{key:l},r(e),1))),128))]))),128))])])])])):c("",!0)])):c("",!0),K.value?(a(),o("div",O,[s("div",T,[f[14]||(f[14]=s("i",{class:"fas fa-exclamation-circle text-red-500 mr-2"},null,-1)),v(" "+r(K.value),1)])])):c("",!0)])]),_:1}))}},[["__scopeId","data-v-b371436c"]]);export{q as default};
