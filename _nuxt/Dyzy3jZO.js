import{$ as e,w as l,m as a,p as t,q as s,n as o,F as n,u,x as i,D as r,z as d,I as c,a8 as v,J as p,v as m,L as b,k as g,l as h}from"./DwDdtX2U.js";import{_ as x}from"./CFdA-A2g.js";import{G as f}from"./CiXH2Qpk.js";import{s as y}from"./vp7J0J8P.js";import"./C3WxCecE.js";import"./Dq87FbFi.js";import"./B7n04RKk.js";import"./DgXBCkKa.js";const w={class:"space-y-6"},k={key:0,class:"bg-gray-50 p-4 rounded-lg"},M={class:"space-y-2"},C={class:"flex items-center"},z={class:"font-medium"},B={class:"text-sm text-gray-500"},j=["onClick"],D={key:1,class:"bg-gray-50 p-4 rounded-lg"},V={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},F=["value"],U={class:"font-medium"},P={class:"text-sm text-gray-500"},E={key:2,class:"space-y-4"},L={class:"space-y-2"},$={class:"flex items-center space-x-2"},A={class:"flex items-center space-x-2"},I={class:"flex items-center space-x-2"},_={key:0,class:"bg-white p-4 rounded-lg border"},K={class:"flex space-x-4"},O=["disabled"],H={key:0},W={key:1,class:"flex items-center justify-center"},Z={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},G={class:"flex items-center justify-between mb-2"},R={class:"text-blue-700"},T={class:"w-full bg-gray-200 rounded-full h-2.5"},q={class:"mt-2 text-sm text-blue-700"},J={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},N={class:"mt-2 text-green-700"},Q={class:"mt-3 space-y-2"},S=["href","download"],X={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Y={class:"mt-2 text-red-700"},ee={key:0,class:"mt-2 text-sm text-gray-600"},le={__name:"index",setup(le){const ae=[{value:"epub",label:"EPUB (.epub)",description:"通用电子书格式",extensions:[".epub"]},{value:"mobi",label:"MOBI (.mobi)",description:"Kindle专用格式",extensions:[".mobi"]},{value:"azw3",label:"AZW3 (.azw3)",description:"新版Kindle格式",extensions:[".azw3"]},{value:"pdf",label:"PDF (.pdf)",description:"便携式文档格式",extensions:[".pdf"]},{value:"txt",label:"文本 (.txt)",description:"纯文本格式",extensions:[".txt"]}],te=g(""),se=g({includeMetadata:!0,includeCover:!0,optimizeForDevice:!1}),oe=g({targetDevice:"generic"}),ne=g([]),ue=h(()=>ne.value),ie=g(!1),re=g(!1),de=g(""),ce=g(""),ve=g(""),pe=g(0),me=g(""),be=g([]),ge=g([]),he=["1. 上传文件：支持EPUB、MOBI、AZW3、PDF和文本格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含元数据、封面，是否针对设备优化等",'5. 点击"开始转换"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保内容和格式的准确性"],xe=e=>e.split(".").pop().toLowerCase(),fe=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},ye=e=>{ne.value=e,e.length>0?we():(ge.value=[],te.value=""),ce.value="",re.value=!1},we=()=>{if(0===ne.value.length)return void(ge.value=[]);const e=xe(ne.value[0].name),l=[];ae.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))||l.push(a)}),ge.value=l,l.length>0?te.value=l[0].value:te.value=""},ke=e=>{ce.value=e,ve.value=Me(e)},Me=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Ce=async()=>{if(0!==ue.length)if(te.value){ie.value=!0,ce.value="",ve.value="",re.value=!1,pe.value=0,me.value="准备转换...",be.value=[];try{await new Promise(e=>{let l=0;const a=y(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),pe.value=l,me.value=l<30?"正在分析电子书...":l<70?"正在转换格式...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});ue.value,te.value,se.value,oe.value;const e=ae.find(e=>e.value===te.value);de.value=`成功将 ${ue.length} 个文件转换为 ${e.label} 格式！`,re.value=!0,ue.forEach((e,l)=>{const a=new Blob(["模拟转换后的电子书内容"],{type:"application/octet-stream"}),t=URL.createObjectURL(a),s=`converted_${e.name.replace(/\.[^/.]+$/,`.${te.value}`)}`;be.value.push({url:t,filename:s})}),be.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=be.value[0].url,e.download=be.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){ce.value=`转换失败：${e.message||"未知错误"}`,ve.value=Me(ce.value)}finally{ie.value=!1}}else ce.value="请选择目标格式";else ce.value="请选择文件"},ze=()=>{ne.value=[],te.value="",se.value={includeMetadata:!0,includeCover:!0,optimizeForDevice:!1},oe.value={targetDevice:"generic"},ce.value="",ve.value="",re.value=!1,de.value="",pe.value=0,me.value="",be.value=[],ge.value=[]};return(g,h)=>(a(),e(x,{title:"电子书转换",description:"EPUB/MOBI/AZW3等电子书格式互转",tips:he},{default:l(()=>[t("div",w,[s(f,{multiple:!0,accept:[".epub",".mobi",".azw3",".pdf",".txt"],"max-size":104857600,modelValue:ne.value,"onUpdate:modelValue":h[0]||(h[0]=e=>ne.value=e),onFilesChanged:ye,onError:ke},null,8,["modelValue"]),ue.value.length>0?(a(),o("div",k,[h[8]||(h[8]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",M,[(a(!0),o(n,null,u(ue.value,(e,l)=>(a(),o("div",{key:l,class:"flex items-center justify-between p-2 bg-white rounded border"},[t("div",C,[h[6]||(h[6]=t("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("div",null,[t("div",z,i(e.name),1),t("div",B,i(xe(e.name))+" • "+i(fe(e.size)),1)])]),t("button",{onClick:e=>(e=>{ne.value.splice(e,1),0===ne.value.length?ze():we()})(l),class:"text-red-500 hover:text-red-700"},[...h[7]||(h[7]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,j)]))),128))])])):r("",!0),ue.value.length>0&&ge.value.length>0?(a(),o("div",D,[h[9]||(h[9]=t("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),t("div",V,[(a(!0),o(n,null,u(ge.value,e=>(a(),o("label",{key:e.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[d(t("input",{type:"radio","onUpdate:modelValue":h[1]||(h[1]=e=>te.value=e),value:e.value,class:"w-4 h-4 text-blue-600"},null,8,F),[[c,te.value]]),t("div",null,[t("div",U,i(e.label),1),t("div",P,i(e.description),1)])]))),128))])])):r("",!0),ue.value.length>0?(a(),o("div",E,[t("div",null,[h[13]||(h[13]=t("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),t("div",L,[t("label",$,[d(t("input",{type:"checkbox","onUpdate:modelValue":h[2]||(h[2]=e=>se.value.includeMetadata=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,se.value.includeMetadata]]),h[10]||(h[10]=t("span",null,"包含元数据",-1))]),t("label",A,[d(t("input",{type:"checkbox","onUpdate:modelValue":h[3]||(h[3]=e=>se.value.includeCover=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,se.value.includeCover]]),h[11]||(h[11]=t("span",null,"包含封面",-1))]),t("label",I,[d(t("input",{type:"checkbox","onUpdate:modelValue":h[4]||(h[4]=e=>se.value.optimizeForDevice=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,se.value.optimizeForDevice]]),h[12]||(h[12]=t("span",null,"针对设备优化",-1))])])]),se.value.optimizeForDevice?(a(),o("div",_,[h[16]||(h[16]=t("h3",{class:"text-lg font-semibold mb-3"},"设备优化选项",-1)),t("div",null,[h[15]||(h[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"目标设备",-1)),d(t("select",{"onUpdate:modelValue":h[5]||(h[5]=e=>oe.value.targetDevice=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...h[14]||(h[14]=[t("option",{value:"kindle"},"Kindle",-1),t("option",{value:"ipad"},"iPad",-1),t("option",{value:"iphone"},"iPhone",-1),t("option",{value:"android"},"Android",-1),t("option",{value:"generic"},"通用",-1)])],512),[[p,oe.value.targetDevice]])])])):r("",!0)])):r("",!0),t("div",K,[t("button",{onClick:Ce,disabled:!ue.value.length||!te.value||ie.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[ie.value?(a(),o("span",W,[h[17]||(h[17]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),m(" 处理中... "+i(pe.value)+"% ",1)])):(a(),o("span",H,"开始转换"))],8,O),t("button",{onClick:ze,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),ie.value?(a(),o("div",Z,[t("div",G,[h[18]||(h[18]=t("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),t("span",R,i(pe.value)+"%",1)]),t("div",T,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:b({width:pe.value+"%"})},null,4)]),t("p",q,i(me.value),1)])):r("",!0),re.value?(a(),o("div",J,[h[19]||(h[19]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),t("p",N,i(de.value),1),t("div",Q,[(a(!0),o(n,null,u(be.value,(e,l)=>(a(),o("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+i(l+1),9,S))),128))])])):r("",!0),ce.value?(a(),o("div",X,[h[20]||(h[20]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),t("p",Y,i(ce.value),1),ve.value?(a(),o("p",ee,"建议："+i(ve.value),1)):r("",!0)])):r("",!0)])]),_:1}))}};export{le as default};
