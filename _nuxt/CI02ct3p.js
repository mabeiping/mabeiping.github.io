import{n as e,p as l,x as a,D as t,F as s,u,z as n,a8 as r,H as o,L as i,l as d,k as c,m as v,E as p,I as b}from"./DwDdtX2U.js";import{s as m}from"./Ta3x3s_8.js";import{_ as g}from"./DwL8tNwU.js";import"./DFiMgQNB.js";const x={class:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md"},f={class:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center"},y=["accept"],h={key:0,class:"mt-4 p-3 bg-gray-50 rounded"},k={class:"font-medium"},w={class:"text-gray-500 ml-2"},F={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},C=["value"],z={class:"group"},I={class:"mt-3 p-4 border rounded-lg"},S={class:"space-y-3"},M={class:"flex items-center"},U={class:"flex items-center"},V={class:"flex items-center"},_=["disabled"],j={key:0,class:"mt-6"},B={class:"w-full bg-gray-200 rounded-full h-2.5"},O={class:"text-center mt-2 text-gray-600"},A={key:1,class:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg"},E={class:"text-green-600 mb-4"},R=["href"],$={key:2,class:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg"},D={class:"text-red-600"},G=g({__name:"index",setup(g){const G=c(null),H=c(null),K=c("ics"),L=c(!1),N=c(0),P=c(null),T=c(null),q=c({includeAllFields:!0,optimizeForOutlook:!1,includeRecurrence:!0}),J=d(()=>".ics,.csv,.xls,.xlsx"),Q=[{value:"ics",label:"ICS",description:"通用日历格式"},{value:"csv",label:"CSV",description:"逗号分隔值格式"},{value:"xlsx",label:"Excel",description:"Microsoft Excel格式"}],W=e=>{const l=e.target.files[0];l&&(H.value=l,T.value=null)},X=()=>{H.value=null,G.value.value=""},Y=e=>{if(0===e)return"0 Bytes";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB"][l]},Z=e=>{const l=Q.find(l=>l.value===e);return l?l.label:e},ee=async()=>{if(H.value){L.value=!0,N.value=0,T.value=null;try{await new Promise(e=>{const l=m(()=>{N.value+=5,N.value>=100&&(clearInterval(l),setTimeout(e,500))},200)}),P.value={downloadUrl:"#",fileName:H.value.name.replace(/\.[^/.]+$/,`.${K.value}`),fileSize:H.value.size}}catch(e){T.value="转换失败，请重试"}finally{L.value=!1}}else T.value="请选择要转换的文件"},le=()=>{H.value=null,G.value.value="",K.value="ics",P.value=null,N.value=0,T.value=null,q.value={includeAllFields:!0,optimizeForOutlook:!1,includeRecurrence:!0}};return(d,c)=>(v(),e("div",x,[c[13]||(c[13]=l("h1",{class:"text-2xl font-bold mb-6 text-center"},"日历格式转换",-1)),c[14]||(c[14]=l("div",{class:"mb-8"},[l("p",{class:"text-gray-600 mb-4"},"支持ICS与其他日历格式互转，操作简单快捷")],-1)),l("form",{onSubmit:o(ee,["prevent"]),class:"space-y-6"},[l("div",f,[l("input",{type:"file",ref_key:"fileInput",ref:G,class:"hidden",accept:J.value,onChange:W},null,40,y),l("button",{type:"button",onClick:c[0]||(c[0]=e=>d.$refs.fileInput.click()),class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300"}," 选择文件 "),c[6]||(c[6]=l("p",{class:"text-gray-500 mt-2"},"支持 ICS、CSV、Excel 等格式",-1)),H.value?(v(),e("div",h,[l("span",k,a(H.value.name),1),l("span",w,"("+a(Y(H.value.size))+")",1),l("button",{type:"button",onClick:X,class:"ml-2 text-red-500 hover:text-red-700"}," 移除 ")])):t("",!0)]),l("div",null,[c[7]||(c[7]=l("label",{class:"block text-gray-700 font-medium mb-2"},"转换为",-1)),l("div",F,[(v(),e(s,null,u(Q,e=>l("label",{key:e.value,class:p(["flex items-center p-3 border rounded-lg cursor-pointer hover:border-blue-500 transition duration-200",{"border-blue-500 bg-blue-50":K.value===e.value}])},[n(l("input",{type:"radio",value:e.value,"onUpdate:modelValue":c[1]||(c[1]=e=>K.value=e),class:"mr-2"},null,8,C),[[b,K.value]]),l("span",null,a(e.label),1)],2)),64))])]),l("div",null,[l("details",z,[c[11]||(c[11]=l("summary",{class:"cursor-pointer list-none flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[l("span",{class:"font-medium"},"高级选项"),l("span",{class:"transition-transform duration-300 group-open:rotate-180"},"▼")],-1)),l("div",I,[l("div",S,[l("label",M,[n(l("input",{type:"checkbox","onUpdate:modelValue":c[2]||(c[2]=e=>q.value.includeAllFields=e),class:"mr-2"},null,512),[[r,q.value.includeAllFields]]),c[8]||(c[8]=l("span",null,"包含所有字段",-1))]),l("label",U,[n(l("input",{type:"checkbox","onUpdate:modelValue":c[3]||(c[3]=e=>q.value.optimizeForOutlook=e),class:"mr-2"},null,512),[[r,q.value.optimizeForOutlook]]),c[9]||(c[9]=l("span",null,"优化为Outlook使用",-1))]),l("label",V,[n(l("input",{type:"checkbox","onUpdate:modelValue":c[4]||(c[4]=e=>q.value.includeRecurrence=e),class:"mr-2"},null,512),[[r,q.value.includeRecurrence]]),c[10]||(c[10]=l("span",null,"包含重复事件",-1))])])])])]),l("button",{type:"submit",disabled:!H.value||L.value,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},a(L.value?"转换中...":"开始转换"),9,_)],32),L.value?(v(),e("div",j,[l("div",B,[l("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:i({width:N.value+"%"})},null,4)]),l("p",O,a(N.value)+"%",1)])):t("",!0),P.value?(v(),e("div",A,[c[12]||(c[12]=l("h3",{class:"font-semibold text-green-700 mb-2"},"转换成功",-1)),l("p",E,"文件已成功转换为 "+a(Z(K.value))+" 格式",1),l("a",{href:P.value.downloadUrl,class:"inline-block bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300",download:""}," 下载文件 ",8,R),l("button",{onClick:le,class:"ml-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-lg transition duration-300"}," 再次转换 ")])):t("",!0),T.value?(v(),e("div",$,[l("p",D,a(T.value),1),l("button",{onClick:c[5]||(c[5]=e=>T.value=null),class:"mt-2 text-red-600 hover:text-red-800 text-sm"}," 关闭 ")])):t("",!0)]))}},[["__scopeId","data-v-1d32b1c0"]]);export{G as default};
