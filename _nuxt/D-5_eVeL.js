import{j as e,w as l,o as a,a as s,b as t,c as o,F as r,p as u,t as n,l as d,q as i,v as c,C as v,y as p,s as m,d as g,B as b,r as x,x as f}from"./BGpdZ-s9.js";import{_ as h}from"./B4wm4ekp.js";import{G as y}from"./BtAA_ILT.js";import{s as w}from"./C2gVa5gV.js";import"./DILYegs3.js";import"./D_BBTi0O.js";import"./9Oz-M6e1.js";import"./DKLvglw8.js";import"./BCo6x5W8.js";const k={class:"space-y-6"},M={key:0,class:"bg-gray-50 p-4 rounded-lg"},j={class:"space-y-2"},V={class:"flex items-center"},L={class:"font-medium"},C={class:"text-sm text-gray-500"},U=["onClick"],F={key:1,class:"bg-gray-50 p-4 rounded-lg"},B={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},O=["value"],P={class:"font-medium"},z={class:"text-sm text-gray-500"},T={key:2,class:"space-y-4"},$={class:"space-y-2"},H={class:"flex items-center space-x-2"},_={class:"flex items-center space-x-2"},I={class:"flex items-center space-x-2"},E={key:0,class:"bg-white p-4 rounded-lg border"},W={key:0},A={key:0,class:"mt-2"},G={key:1},R={key:0,class:"mt-2"},q={key:1,class:"bg-white p-4 rounded-lg border"},D={class:"space-y-2"},K={class:"flex space-x-4"},X=["disabled"],Y={key:0},Z={key:1,class:"flex items-center justify-center"},J={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},N={class:"flex items-center justify-between mb-2"},Q={class:"text-blue-700"},S={class:"w-full bg-gray-200 rounded-full h-2.5"},ee={class:"mt-2 text-sm text-blue-700"},le={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},ae={class:"mt-2 text-green-700"},se={class:"mt-3 space-y-2"},te=["href","download"],oe={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},re={class:"mt-2 text-red-700"},ue={key:0,class:"mt-2 text-sm text-gray-600"},ne={__name:"index",setup(ne){const de=[{value:"docx",label:"Word (.docx)",description:"适合编辑和共享",extensions:[".docx",".doc"]},{value:"md",label:"Markdown (.md)",description:"适合写作和版本控制",extensions:[".md"]},{value:"html",label:"HTML (.html)",description:"适合网页展示",extensions:[".html"]},{value:"txt",label:"文本 (.txt)",description:"纯文本格式",extensions:[".txt"]},{value:"split",label:"拆分文档",description:"将文档拆分为多个文件",extensions:[".docx",".doc"]},{value:"merge",label:"合并文档",description:"将多个文档合并为一个文件",extensions:[".docx",".doc"]},{value:"encrypt",label:"加密文档",description:"为文档添加密码保护",extensions:[".docx",".doc"]}],ie=x(""),ce=x({includeImages:!0,preserveFormatting:!0,handleLinks:!0}),ve=x({splitMode:"page",pagesPerFile:1,mergeOrder:"upload",customOrder:""}),pe=x({password:"",confirmPassword:"",encryptionLevel:"medium"}),me=x([]),ge=f(()=>me.value),be=x(!1),xe=x(!1),fe=x(""),he=x(""),ye=x(""),we=x(0),ke=x(""),Me=x([]),je=x([]),Ve=["1. 上传文件：支持Word、Markdown、HTML和文本格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含图片、保留格式、处理超链接等","5. 对于拆分/合并/加密操作，设置相应的选项",'6. 点击"开始转换"按钮进行处理',"7. 等待处理完成，系统会自动下载处理后的文件","8. 查看处理结果，确保内容和格式的准确性"],Le=e=>e.split(".").pop().toLowerCase(),Ce=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},Ue=e=>{me.value=e,e.length>0?Fe():(je.value=[],ie.value=""),he.value="",xe.value=!1},Fe=()=>{if(0===me.value.length)return void(je.value=[]);const e=Le(me.value[0].name),l=[];de.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))&&"split"!==a.value&&"merge"!==a.value&&"encrypt"!==a.value||l.push(a)}),je.value=l,l.length>0?ie.value=l[0].value:ie.value=""},Be=e=>{he.value=e,ye.value=Oe(e)},Oe=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Pe=async()=>{if(0!==ge.length)if(ie.value){if("encrypt"===ie.value){if(!pe.value.password)return void(he.value="请输入加密密码");if(pe.value.password!==pe.value.confirmPassword)return void(he.value="两次输入的密码不一致")}be.value=!0,he.value="",ye.value="",xe.value=!1,we.value=0,ke.value="准备转换...",Me.value=[];try{await new Promise(e=>{let l=0;const a=w(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),we.value=l,ke.value=l<30?"正在分析文件...":l<70?"正在转换文件...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});let e={files:ge.value,targetFormat:ie.value,options:ce.value};"split"===ie.value||"merge"===ie.value?e.splitMergeOptions=ve.value:"encrypt"===ie.value&&(e.encryptOptions=pe.value);const l=de.find(e=>e.value===ie.value);fe.value=`成功将 ${ge.length} 个文件转换为 ${l.label} 格式！`,xe.value=!0,ge.forEach((e,l)=>{let a=ie.value;"split"!==ie.value&&"merge"!==ie.value&&"encrypt"!==ie.value||(a="docx");const s=new Blob(["模拟转换后的文件内容"],{type:"application/octet-stream"}),t=URL.createObjectURL(s),o=`converted_${e.name.replace(/\.[^/.]+$/,`.${a}`)}`;Me.value.push({url:t,filename:o})}),Me.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=Me.value[0].url,e.download=Me.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){he.value=`转换失败：${e.message||"未知错误"}`,ye.value=Oe(he.value)}finally{be.value=!1}}else he.value="请选择目标格式";else he.value="请选择文件"},ze=()=>{me.value=[],ie.value="",ce.value={includeImages:!0,preserveFormatting:!0,handleLinks:!0},ve.value={splitMode:"page",pagesPerFile:1,mergeOrder:"upload",customOrder:""},pe.value={password:"",confirmPassword:"",encryptionLevel:"medium"},he.value="",ye.value="",xe.value=!1,fe.value="",we.value=0,ke.value="",Me.value=[],je.value=[]};return(x,f)=>(a(),e(h,{title:"办公文档格式转换",description:"支持doc/docx批量拆分合并加密、MD/HTML/TXT/Word互转",tips:Ve},{default:l(()=>[s("div",k,[t(y,{multiple:!0,accept:[".doc",".docx",".md",".html",".txt"],"max-size":104857600,modelValue:me.value,"onUpdate:modelValue":f[0]||(f[0]=e=>me.value=e),onFilesChanged:Ue,onError:Be},null,8,["modelValue"]),ge.value.length>0?(a(),o("div",M,[f[14]||(f[14]=s("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),s("div",j,[(a(!0),o(r,null,u(ge.value,(e,l)=>(a(),o("div",{key:l,class:"flex items-center justify-between p-2 bg-white rounded border"},[s("div",V,[f[12]||(f[12]=s("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),s("div",null,[s("div",L,n(e.name),1),s("div",C,n(Le(e.name))+" • "+n(Ce(e.size)),1)])]),s("button",{onClick:e=>(e=>{me.value.splice(e,1),0===me.value.length?ze():Fe()})(l),class:"text-red-500 hover:text-red-700"},[...f[13]||(f[13]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,U)]))),128))])])):d("",!0),ge.value.length>0&&je.value.length>0?(a(),o("div",F,[f[15]||(f[15]=s("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),s("div",B,[(a(!0),o(r,null,u(je.value,e=>(a(),o("label",{key:e.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[i(s("input",{type:"radio","onUpdate:modelValue":f[1]||(f[1]=e=>ie.value=e),value:e.value,class:"w-4 h-4 text-blue-600"},null,8,O),[[c,ie.value]]),s("div",null,[s("div",P,n(e.label),1),s("div",z,n(e.description),1)])]))),128))])])):d("",!0),ge.value.length>0?(a(),o("div",T,[s("div",null,[f[19]||(f[19]=s("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),s("div",$,[s("label",H,[i(s("input",{type:"checkbox","onUpdate:modelValue":f[2]||(f[2]=e=>ce.value.includeImages=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ce.value.includeImages]]),f[16]||(f[16]=s("span",null,"包含图片",-1))]),s("label",_,[i(s("input",{type:"checkbox","onUpdate:modelValue":f[3]||(f[3]=e=>ce.value.preserveFormatting=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ce.value.preserveFormatting]]),f[17]||(f[17]=s("span",null,"保留格式",-1))]),s("label",I,[i(s("input",{type:"checkbox","onUpdate:modelValue":f[4]||(f[4]=e=>ce.value.handleLinks=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ce.value.handleLinks]]),f[18]||(f[18]=s("span",null,"处理超链接",-1))])])]),"split"===ie.value||"merge"===ie.value?(a(),o("div",E,[f[26]||(f[26]=s("h3",{class:"text-lg font-semibold mb-3"},"文档拆分/合并选项",-1)),"split"===ie.value?(a(),o("div",W,[f[22]||(f[22]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"拆分方式",-1)),i(s("select",{"onUpdate:modelValue":f[5]||(f[5]=e=>ve.value.splitMode=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...f[20]||(f[20]=[s("option",{value:"page"},"按页码拆分",-1),s("option",{value:"section"},"按章节拆分",-1),s("option",{value:"size"},"按文件大小拆分",-1)])],512),[[p,ve.value.splitMode]]),"page"===ve.value.splitMode?(a(),o("div",A,[f[21]||(f[21]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"每页拆分",-1)),i(s("input",{"onUpdate:modelValue":f[6]||(f[6]=e=>ve.value.pagesPerFile=e),type:"number",min:"1",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,ve.value.pagesPerFile,void 0,{number:!0}]])])):d("",!0)])):"merge"===ie.value?(a(),o("div",G,[f[25]||(f[25]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"合并顺序",-1)),i(s("select",{"onUpdate:modelValue":f[7]||(f[7]=e=>ve.value.mergeOrder=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...f[23]||(f[23]=[s("option",{value:"upload"},"按上传顺序",-1),s("option",{value:"name"},"按文件名排序",-1),s("option",{value:"custom"},"自定义顺序",-1)])],512),[[p,ve.value.mergeOrder]]),"custom"===ve.value.mergeOrder?(a(),o("div",R,[f[24]||(f[24]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"自定义顺序（用逗号分隔）",-1)),i(s("input",{"onUpdate:modelValue":f[8]||(f[8]=e=>ve.value.customOrder=e),type:"text",placeholder:"例如：file1.docx,file2.docx",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,ve.value.customOrder]])])):d("",!0)])):d("",!0)])):d("",!0),"encrypt"===ie.value?(a(),o("div",q,[f[31]||(f[31]=s("h3",{class:"text-lg font-semibold mb-3"},"文档加密选项",-1)),s("div",D,[s("div",null,[f[27]||(f[27]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密密码",-1)),i(s("input",{"onUpdate:modelValue":f[9]||(f[9]=e=>pe.value.password=e),type:"password",placeholder:"请输入加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,pe.value.password]])]),s("div",null,[f[28]||(f[28]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"确认密码",-1)),i(s("input",{"onUpdate:modelValue":f[10]||(f[10]=e=>pe.value.confirmPassword=e),type:"password",placeholder:"请确认加密密码",class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[m,pe.value.confirmPassword]])]),s("div",null,[f[30]||(f[30]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"加密级别",-1)),i(s("select",{"onUpdate:modelValue":f[11]||(f[11]=e=>pe.value.encryptionLevel=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...f[29]||(f[29]=[s("option",{value:"low"},"低级别加密",-1),s("option",{value:"medium"},"中级别加密",-1),s("option",{value:"high"},"高级别加密",-1)])],512),[[p,pe.value.encryptionLevel]])])])])):d("",!0)])):d("",!0),s("div",K,[s("button",{onClick:Pe,disabled:!ge.value.length||!ie.value||be.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[be.value?(a(),o("span",Z,[f[32]||(f[32]=s("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),g(" 处理中... "+n(we.value)+"% ",1)])):(a(),o("span",Y,"开始转换"))],8,X),s("button",{onClick:ze,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),be.value?(a(),o("div",J,[s("div",N,[f[33]||(f[33]=s("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),s("span",Q,n(we.value)+"%",1)]),s("div",S,[s("div",{class:"bg-blue-600 h-2.5 rounded-full",style:b({width:we.value+"%"})},null,4)]),s("p",ee,n(ke.value),1)])):d("",!0),xe.value?(a(),o("div",le,[f[34]||(f[34]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",ae,n(fe.value),1),s("div",se,[(a(!0),o(r,null,u(Me.value,(e,l)=>(a(),o("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+n(l+1),9,te))),128))])])):d("",!0),he.value?(a(),o("div",oe,[f[35]||(f[35]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",re,n(he.value),1),ye.value?(a(),o("p",ue,"建议："+n(ye.value),1)):d("",!0)])):d("",!0)])]),_:1}))}};export{ne as default};
