import{_ as O}from"./BQHxoWhy.js";import{e as C,u as D,h as T,w as B,o as f,a as e,c as v,i as g,j as i,k as y,f as l,l as b,m as w,t as a}from"./B8s1FeTi.js";import"./Bgh1zsjK.js";import"./B2vQDBnT.js";const E={class:"space-y-6"},M={class:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary transition-colors"},z={class:"grid grid-cols-2 gap-4"},W=["disabled"],X=["disabled"],L=["disabled"],R={key:0,class:"space-y-4"},S={class:"p-4 bg-gray-50 rounded-lg"},U={class:"font-medium text-text-primary"},V={class:"text-sm text-text-secondary"},j={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},N={class:"space-y-1 text-sm text-green-700"},K={__name:"office-format-converter",setup(I){const m=i(null),s=i(null),d=i("pdf"),u=i("medium"),c=i(!1),r=i(null),h=()=>{m.value?.click()},k=o=>{const t=o.target.files[0];t&&(["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"].includes(t.type)?s.value=t:alert("请选择有效的Office文件（Word、Excel、PPT）"))},P=()=>{s.value=null,r.value=null},x=o=>{if(o===0)return"0 Bytes";const t=1024,p=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(o)/Math.log(t));return Math.round(o/Math.pow(t,n)*100)/100+" "+p[n]},_=async()=>{if(!s.value){alert("请先选择Office文件");return}c.value=!0;try{await new Promise(t=>setTimeout(t,2e3));const o={pdf:"PDF",docx:"Word (DOCX)",xlsx:"Excel (XLSX)",pptx:"PowerPoint (PPTX)"};r.value={originalFormat:s.value.name.split(".").pop(),outputFormat:o[d.value],size:s.value.size}}catch(o){console.error("Conversion error:",o),alert("转换失败，请重试")}finally{c.value=!1}},F=()=>{if(!r.value||!s.value)return;const o=document.createElement("a");o.href=URL.createObjectURL(s.value);const t={pdf:".pdf",docx:".docx",xlsx:".xlsx",pptx:".pptx"};o.download=`converted${t[d.value]}`,o.click(),URL.revokeObjectURL(o.href)};return C(),D({title:"Office转换 - 免费在线Office格式转换工具 - 办公工具箱",meta:[{name:"description",content:"免费在线Office格式转换工具，支持Word、Excel、PPT、PDF等格式互转。保持原有格式，支持批量转换，无需安装，即传即用，保护文件隐私。"},{name:"keywords",content:"Office转换, Word转PDF, Excel转PDF, PPT转PDF, PDF转Word, 文档格式转换, 免费格式转换, 在线格式转换, Office格式互转, 文档转换工具, 文件格式转换"},{name:"author",content:"办公工具箱"},{property:"og:title",content:"Office转换 - 免费在线Office格式转换工具 - 办公工具箱"},{property:"og:description",content:"免费在线Office格式转换工具，支持Word、Excel、PPT、PDF等格式互转"},{property:"og:type",content:"website"},{property:"og:url",content:"https://www.worktoolkit.top/tools/format/office-format-converter"},{property:"og:locale",content:"zh_CN"}],link:[{rel:"canonical",href:"https://www.worktoolkit.top/tools/format/office-format-converter"}]}),(o,t)=>{const p=O;return f(),T(p,{title:"Office转换",description:"Office文档格式转换"},{default:B(()=>[e("div",E,[e("div",M,[e("input",{ref_key:"fileInput",ref:m,type:"file",accept:".doc,.docx,.xls,.xlsx,.ppt,.pptx",class:"hidden",onChange:k},null,544),e("div",{class:"space-y-4"},[t[2]||(t[2]=e("svg",{class:"w-16 h-16 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("button",{onClick:h,class:"px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"}," 选择Office文件 "),t[3]||(t[3]=e("p",{class:"text-sm text-text-secondary"},"支持 Word、Excel、PPT",-1))])]),e("div",z,[e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-text-primary mb-2"},"输出格式",-1)),y(e("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>b(d)?d.value=n:null),class:"w-full px-3 py-2 border rounded-lg focus:outline-none disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!l(s)},[...t[4]||(t[4]=[e("option",{value:"pdf"},"PDF",-1),e("option",{value:"docx"},"Word (DOCX)",-1),e("option",{value:"xlsx"},"Excel (XLSX)",-1),e("option",{value:"pptx"},"PowerPoint (PPTX)",-1)])],8,W),[[w,l(d)]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-text-primary mb-2"},"质量",-1)),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>b(u)?u.value=n:null),class:"w-full px-3 py-2 border rounded-lg focus:outline-none disabled:bg-gray-100 disabled:cursor-not-allowed",disabled:!l(s)},[...t[6]||(t[6]=[e("option",{value:"high"},"高质量",-1),e("option",{value:"medium"},"中等质量",-1),e("option",{value:"low"},"低质量（文件更小）",-1)])],8,X),[[w,l(u)]])])]),e("button",{onClick:_,disabled:l(c)||!l(s),class:"w-full py-3 bg-gradient-to-r from-primary to-primary-light text-white rounded-lg font-medium hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed"},a(l(c)?"转换中...":l(s)?"开始转换":"请先选择Office文件"),9,L),l(s)?(f(),v("div",R,[e("div",{class:"flex items-center justify-between"},[t[8]||(t[8]=e("h3",{class:"text-lg font-bold text-text-primary"},"已选择文件",-1)),e("button",{onClick:P,class:"text-sm text-red-500 hover:text-red-600 transition-colors"}," 清除 ")]),e("div",S,[e("p",U,a(l(s).name),1),e("p",V,a(x(l(s).size)),1)])])):g("",!0),l(r)?(f(),v("div",j,[t[9]||(t[9]=e("h3",{class:"font-bold text-green-800 mb-2"},"转换完成！",-1)),e("div",N,[e("p",null,"原始格式："+a(l(r).originalFormat),1),e("p",null,"输出格式："+a(l(r).outputFormat),1),e("p",null,"文件大小："+a(x(l(r).size)),1)]),e("button",{onClick:F,class:"w-full mt-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"}," 下载转换后的文件 ")])):g("",!0)])]),_:1})}}};export{K as default};
