import{j as K,w as J,o as l,a as e,b as Q,c as n,F as q,p as S,t as a,l as m,q as k,s as $,y as C,d as X,B as Y,r,x as V}from"./5KiIeb3O.js";import{_ as Z}from"./D50zL9At.js";import{G as ee}from"./9UHln5xC.js";import{s as te}from"./CkncbWtC.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";import"./DlAUqK2U.js";const se={class:"space-y-6"},oe={key:0,class:"bg-gray-50 p-4 rounded-lg"},le={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},ne={class:"flex justify-center mb-3"},ae={key:0,class:"flex flex-col items-center justify-center bg-gray-100 rounded w-full h-24"},re={key:1,class:"flex flex-col items-center justify-center bg-gray-100 rounded w-full h-24"},ie={class:"text-center"},ue={class:"font-medium truncate"},de={class:"text-sm text-gray-500"},ve={key:0,class:"text-sm text-gray-500"},me=["onClick"],ce={key:1,class:"space-y-4"},pe={key:0,class:"bg-gray-50 p-4 rounded-lg"},ge={class:"space-y-3"},be={class:"text-right text-sm text-gray-500"},xe={key:1,class:"bg-gray-50 p-4 rounded-lg"},fe={class:"space-y-3"},ye={class:"text-right text-sm text-gray-500"},ke={class:"bg-gray-50 p-4 rounded-lg"},he={class:"space-y-3"},we={class:"flex space-x-4"},_e=["disabled"],Ce={key:0},Me={key:1,class:"flex items-center justify-center"},Fe={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Ve={class:"flex items-center justify-between mb-2"},Be={class:"text-blue-700"},ze={class:"w-full bg-gray-200 rounded-full h-2.5"},je={class:"mt-2 text-sm text-blue-700"},qe={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Se={class:"mt-2 text-green-700"},$e={class:"mt-3 space-y-2"},Ee=["href","download"],Pe={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},Ue={class:"mt-2 text-red-700"},Le={key:0,class:"mt-2 text-sm text-gray-600"},Ke={__name:"index",setup(Oe){const d=r({quality:70,bitrate:"auto",resolution:"original"}),c=r({quality:80,bitrate:"auto"}),x=r({format:"same"}),p=r([]),i=V(()=>p.value),h=r(!1),w=r(!1),M=r(""),v=r(""),f=r(""),y=r(0),g=r(""),b=r([]),E=V(()=>i.value.some(s=>F(s.name))),P=V(()=>i.value.some(s=>L(s.name))),U=["1. 上传音视频文件：支持MP4、MP3等常见格式","2. 配置压缩参数：根据文件类型设置相应的压缩选项",'3. 点击"开始压缩"按钮进行处理',"4. 等待处理完成，下载压缩后的文件"],F=s=>[".mp4",".avi",".mov",".wmv",".flv"].some(o=>s.toLowerCase().endsWith(o)),L=s=>[".mp3",".wav",".ogg",".m4a"].some(o=>s.toLowerCase().endsWith(o)),B=s=>s.split(".").pop().toLowerCase(),O=s=>{if(s===0)return"0 B";const t=1024,o=["B","KB","MB","GB"],u=Math.floor(Math.log(s)/Math.log(t));return parseFloat((s/Math.pow(t,u)).toFixed(2))+" "+o[u]},D=s=>{if(!s)return"";const t=Math.floor(s/60),o=Math.floor(s%60);return`${t}:${o.toString().padStart(2,"0")}`},A=s=>{p.value.splice(s,1),p.value.length===0&&j()},N=s=>{p.value=s,v.value="",w.value=!1},T=s=>{v.value=s,f.value=z(s)},z=s=>s.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":s.includes("文件类型")?"请确保上传的文件格式受支持":s.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",G=()=>new Promise(s=>{let t=0;const o=te(()=>{t+=Math.floor(Math.random()*10)+5,t>100&&(t=100),y.value=t,t<30?g.value="正在分析文件...":t<60?g.value="正在压缩音视频...":t<90?g.value="正在优化输出...":g.value="正在生成结果...",t===100&&(clearInterval(o),setTimeout(s,500))},500)}),H=async()=>{if(i.length===0){v.value="请选择文件";return}h.value=!0,v.value="",f.value="",w.value=!1,y.value=0,g.value="准备处理...",b.value=[];try{await G();let s={files:i.value,videoOptions:d.value,audioOptions:c.value,outputOptions:x.value};console.log("处理参数:",s),M.value=`成功压缩 ${i.length} 个音视频文件！`,w.value=!0,i.forEach((t,o)=>{const u=B(t.name),_=x.value.format==="same"?u:x.value.format,I=new Blob(["模拟压缩后的音视频内容"],{type:F(t.name)?`video/${_}`:`audio/${_}`}),R=URL.createObjectURL(I),W=`compressed_${t.name.replace(/\.[^/.]+$/,`.${_}`)}`;b.value.push({url:R,filename:W})}),b.value.length>0&&setTimeout(()=>{const t=document.createElement("a");t.href=b.value[0].url,t.download=b.value[0].filename,document.body.appendChild(t),t.click(),document.body.removeChild(t)},1e3)}catch(s){v.value=`处理失败：${s.message||"未知错误"}`,f.value=z(v.value)}finally{h.value=!1}},j=()=>{p.value=[],d.value={quality:70,bitrate:"auto",resolution:"original"},c.value={quality:80,bitrate:"auto"},x.value={format:"same"},v.value="",f.value="",w.value=!1,M.value="",y.value=0,g.value="",b.value=[]};return(s,t)=>(l(),K(Z,{title:"音视频压缩",description:"减小音视频文件大小，保持画质音质",tips:U},{default:J(()=>[e("div",se,[Q(ee,{multiple:!0,accept:[".mp4",".avi",".mov",".wmv",".flv",".mp3",".wav",".ogg",".m4a"],"max-size":500*1024*1024,modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=o=>p.value=o),onFilesChanged:N,onError:T},null,8,["modelValue"]),i.value.length>0?(l(),n("div",oe,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),e("div",le,[(l(!0),n(q,null,S(i.value,(o,u)=>(l(),n("div",{key:u,class:"bg-white rounded border p-3"},[e("div",ne,[F(o.name)?(l(),n("div",ae,[...t[7]||(t[7]=[e("svg",{class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("span",{class:"text-xs text-gray-500 mt-1"},"视频文件",-1)])])):(l(),n("div",re,[...t[8]||(t[8]=[e("svg",{class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3",class:"text-gray-400"})],-1),e("span",{class:"text-xs text-gray-500 mt-1"},"音频文件",-1)])]))]),e("div",ie,[e("div",ue,a(o.name),1),e("div",de,a(B(o.name))+" • "+a(O(o.size)),1),o.duration?(l(),n("div",ve,a(D(o.duration)),1)):m("",!0)]),e("button",{onClick:_=>A(u),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,me)]))),128))])])):m("",!0),i.value.length>0?(l(),n("div",ce,[E.value?(l(),n("div",pe,[t[15]||(t[15]=e("h3",{class:"text-lg font-semibold mb-3"},"视频压缩设置",-1)),e("div",ge,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"视频质量",-1)),k(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>d.value.quality=o),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[$,d.value.quality,void 0,{number:!0}]]),e("div",be,a(d.value.quality)+"%",1)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"视频比特率",-1)),k(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>d.value.bitrate=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[11]||(t[11]=[e("option",{value:"auto"},"自动",-1),e("option",{value:"1000"},"1000 kbps",-1),e("option",{value:"2000"},"2000 kbps",-1),e("option",{value:"3000"},"3000 kbps",-1),e("option",{value:"5000"},"5000 kbps",-1),e("option",{value:"8000"},"8000 kbps",-1)])],512),[[C,d.value.bitrate]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"分辨率",-1)),k(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>d.value.resolution=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[13]||(t[13]=[e("option",{value:"original"},"保持原始",-1),e("option",{value:"1920x1080"},"1920x1080 (Full HD)",-1),e("option",{value:"1280x720"},"1280x720 (HD)",-1),e("option",{value:"854x480"},"854x480 (480p)",-1),e("option",{value:"640x360"},"640x360 (360p)",-1)])],512),[[C,d.value.resolution]])])])])):m("",!0),P.value?(l(),n("div",xe,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold mb-3"},"音频压缩设置",-1)),e("div",fe,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"音频质量",-1)),k(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>c.value.quality=o),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[$,c.value.quality,void 0,{number:!0}]]),e("div",ye,a(c.value.quality)+"%",1)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"音频比特率",-1)),k(e("select",{"onUpdate:modelValue":t[5]||(t[5]=o=>c.value.bitrate=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[17]||(t[17]=[e("option",{value:"auto"},"自动",-1),e("option",{value:"64"},"64 kbps",-1),e("option",{value:"128"},"128 kbps",-1),e("option",{value:"192"},"192 kbps",-1),e("option",{value:"256"},"256 kbps",-1),e("option",{value:"320"},"320 kbps",-1)])],512),[[C,c.value.bitrate]])])])])):m("",!0),e("div",ke,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold mb-3"},"输出设置",-1)),e("div",he,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),k(e("select",{"onUpdate:modelValue":t[6]||(t[6]=o=>x.value.format=o),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...t[20]||(t[20]=[e("option",{value:"same"},"保持原格式",-1),e("option",{value:"mp4"},"MP4 (视频)",-1),e("option",{value:"mp3"},"MP3 (音频)",-1)])],512),[[C,x.value.format]])])])])])):m("",!0),e("div",we,[e("button",{onClick:H,disabled:!i.value.length||h.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[h.value?(l(),n("span",Me,[t[23]||(t[23]=e("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),X(" 处理中... "+a(y.value)+"% ",1)])):(l(),n("span",Ce,"开始压缩"))],8,_e),e("button",{onClick:j,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),h.value?(l(),n("div",Fe,[e("div",Ve,[t[24]||(t[24]=e("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),e("span",Be,a(y.value)+"%",1)]),e("div",ze,[e("div",{class:"bg-blue-600 h-2.5 rounded-full",style:Y({width:y.value+"%"})},null,4)]),e("p",je,a(g.value),1)])):m("",!0),w.value?(l(),n("div",qe,[t[25]||(t[25]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),e("p",Se,a(M.value),1),e("div",$e,[(l(!0),n(q,null,S(b.value,(o,u)=>(l(),n("a",{key:u,href:o.url,download:o.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载压缩结果 "+a(u+1),9,Ee))),128))])])):m("",!0),v.value?(l(),n("div",Pe,[t[26]||(t[26]=e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),e("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),e("p",Ue,a(v.value),1),f.value?(l(),n("p",Le,"建议："+a(f.value),1)):m("",!0)])):m("",!0)])]),_:1}))}};export{Ke as default};
