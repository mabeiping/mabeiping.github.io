import{$ as e,w as a,m as s,p as l,q as o,n as t,z as r,J as i,K as n,D as u,L as p,x as c,v,k as d}from"./DwDdtX2U.js";import{_ as m}from"./CFdA-A2g.js";import{G as f}from"./CiXH2Qpk.js";import{_ as w}from"./Dq87FbFi.js";import"./C3WxCecE.js";import"./B7n04RKk.js";import"./DgXBCkKa.js";const b={class:"archive-compress"},g={class:"upload-section"},h={key:0,class:"options-section"},y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},k={class:"form-group"},x={class:"form-group"},N={class:"form-group"},U={class:"form-group"},j={key:1,class:"process-section"},z=["disabled"],L={key:0},_={key:1},R={key:2,class:"progress-section"},C={class:"progress-bar"},I={class:"text-sm text-gray-500 mt-1"},P={key:3,class:"result-section"},S={class:"result-info"},V={class:"result-item"},A={class:"value"},E={class:"result-item"},F={class:"value"},Z={class:"result-item"},D={class:"value"},G={class:"result-item"},T={class:"value"},q={class:"result-item"},B={class:"value"},J={key:4,class:"error-section"},K={class:"error-message"},M=w({__name:"index",setup(w){const M=d([]),O=d(!1),$=d(0),H=d(""),Q=d(null),W=d(""),X=d({format:"zip",compressionLevel:"normal",fileName:"compressed",password:""}),Y=e=>{M.value=[...M.value,...e],W.value="",Q.value=null},ee=()=>{M.value=[],W.value="",Q.value=null},ae=async()=>{if(0!==M.value.length){O.value=!0,$.value=0,H.value="准备压缩...",W.value="",Q.value=null;try{const e=new FormData;M.value.forEach(a=>{e.append("files",a)}),e.append("format",X.value.format),e.append("compressionLevel",X.value.compressionLevel),e.append("fileName",X.value.fileName),e.append("password",X.value.password);const a=await fetch("/api/archive/compress",{method:"POST",body:e});if(!a.ok)throw new Error("API请求失败");const s=await a.json();if(!s.success)throw new Error(s.message||"压缩失败");{const e=s.data[0];Q.value={fileName:e.fileName,format:X.value.format.toUpperCase(),fileCount:e.fileCount,compressedSize:e.compressedSize,compressionRatio:e.compressionRatio,downloadUrl:e.downloadUrl}}}catch(e){W.value=e.message||"压缩失败，请重试"}finally{O.value=!1}}else W.value="请先上传文件"},se=()=>{Q.value?.downloadUrl&&window.open(Q.value.downloadUrl,"_blank")};return(d,w)=>(s(),e(m,{title:"文件压缩",description:"将文件或文件夹压缩为各种格式的压缩包"},{default:a(()=>[l("div",b,[l("div",g,[w[4]||(w[4]=l("h3",null,"上传文件",-1)),o(f,{accept:["*"],multiple:!0,onFileUploaded:Y,onFileRemoved:ee}),w[5]||(w[5]=l("p",{class:"text-sm text-gray-500 mt-2"},"支持多个文件，单个文件大小不超过50MB",-1))]),M.value.length>0?(s(),t("div",h,[w[12]||(w[12]=l("h3",null,"压缩选项",-1)),l("div",y,[l("div",k,[w[7]||(w[7]=l("label",{for:"format"},"压缩格式",-1)),r(l("select",{id:"format","onUpdate:modelValue":w[0]||(w[0]=e=>X.value.format=e),class:"form-select"},[...w[6]||(w[6]=[l("option",{value:"zip"},"ZIP",-1),l("option",{value:"rar"},"RAR",-1),l("option",{value:"7z"},"7Z",-1),l("option",{value:"tar"},"TAR",-1),l("option",{value:"gz"},"GZIP",-1)])],512),[[i,X.value.format]])]),l("div",x,[w[9]||(w[9]=l("label",{for:"compressionLevel"},"压缩级别",-1)),r(l("select",{id:"compressionLevel","onUpdate:modelValue":w[1]||(w[1]=e=>X.value.compressionLevel=e),class:"form-select"},[...w[8]||(w[8]=[l("option",{value:"store"},"存储 (无压缩)",-1),l("option",{value:"fast"},"快速压缩",-1),l("option",{value:"normal"},"标准压缩",-1),l("option",{value:"high"},"高压缩",-1),l("option",{value:"ultra"},"极限压缩",-1)])],512),[[i,X.value.compressionLevel]])]),l("div",N,[w[10]||(w[10]=l("label",{for:"fileName"},"压缩包名称",-1)),r(l("input",{id:"fileName",type:"text","onUpdate:modelValue":w[2]||(w[2]=e=>X.value.fileName=e),class:"form-input",placeholder:"默认为 compressed"},null,512),[[n,X.value.fileName]])]),l("div",U,[w[11]||(w[11]=l("label",{for:"password"},"密码保护",-1)),r(l("input",{id:"password",type:"password","onUpdate:modelValue":w[3]||(w[3]=e=>X.value.password=e),class:"form-input",placeholder:"可选"},null,512),[[n,X.value.password]])])])])):u("",!0),M.value.length>0?(s(),t("div",j,[l("button",{class:"btn btn-primary",onClick:ae,disabled:O.value},[O.value?(s(),t("span",_,"压缩中...")):(s(),t("span",L,"开始压缩"))],8,z)])):u("",!0),O.value?(s(),t("div",R,[l("div",C,[l("div",{class:"progress-fill",style:p({width:$.value+"%"})},null,4)]),l("p",I,c(H.value),1)])):u("",!0),Q.value?(s(),t("div",P,[w[19]||(w[19]=l("h3",null,"压缩结果",-1)),l("div",S,[l("div",V,[w[13]||(w[13]=l("span",{class:"label"},"压缩包名称:",-1)),l("span",A,c(Q.value.fileName),1)]),l("div",E,[w[14]||(w[14]=l("span",{class:"label"},"压缩格式:",-1)),l("span",F,c(Q.value.format),1)]),l("div",Z,[w[15]||(w[15]=l("span",{class:"label"},"文件数量:",-1)),l("span",D,c(Q.value.fileCount),1)]),l("div",G,[w[16]||(w[16]=l("span",{class:"label"},"压缩大小:",-1)),l("span",T,c(Q.value.compressedSize),1)]),l("div",q,[w[17]||(w[17]=l("span",{class:"label"},"压缩率:",-1)),l("span",B,c(Q.value.compressionRatio),1)]),l("button",{class:"btn btn-secondary mt-4",onClick:se},[...w[18]||(w[18]=[l("i",{class:"fas fa-download mr-2"},null,-1),v("下载压缩包 ",-1)])])])])):u("",!0),W.value?(s(),t("div",J,[l("div",K,[w[20]||(w[20]=l("i",{class:"fas fa-exclamation-circle text-red-500 mr-2"},null,-1)),v(" "+c(W.value),1)])])):u("",!0)])]),_:1}))}},[["__scopeId","data-v-259924bc"]]);export{M as default};
