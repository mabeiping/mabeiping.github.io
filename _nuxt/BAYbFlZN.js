import{i as e,D as l,o as a,c as t,a as s,A as o,z as r,t as n,F as i,p as u,l as d,q as c,v,y as p,s as g,d as x,B as b,r as m}from"./BGpdZ-s9.js";import{_ as f}from"./BCo6x5W8.js";const y={id:"format-converter",class:"mb-6"},h={class:"bg-white rounded-xl shadow-sm"},w={class:"p-4"},k={class:"flex flex-col items-center justify-center space-y-3"},P={class:"text-xs text-gray-500 mt-0.5"},j=["accept"],D={key:0,class:"mt-4"},F={class:"flex items-center justify-between bg-gray-100 p-2 rounded-lg mb-2"},M={class:"flex items-center space-x-2"},C={class:"text-xs font-medium"},L={class:"space-y-1"},B={class:"text-xs truncate"},T={class:"text-xs text-gray-500"},G=["onClick"],V={key:0,class:"space-y-4"},_={class:"bg-gray-50 p-3 rounded-lg"},I={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-1.5"},W=["value"],q={class:"text-xs"},z={class:"text-xs text-gray-500"},A={key:0,class:"bg-gray-50 p-3 rounded-lg"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},R=["value"],S={key:0},H={key:1},U={class:"text-xs text-gray-500 text-center"},N={class:"flex space-x-3"},$=["disabled"],J={key:0},X={key:1,class:"flex items-center justify-center"},Y={key:1,class:"mt-3"},K={class:"w-full bg-gray-200 rounded-full h-2"},O={class:"mt-1 flex justify-between items-center"},Z={class:"text-xs text-gray-600"},Q={class:"text-xs text-gray-500"},ee={class:"mt-1 flex justify-between text-xs text-gray-400"},le={key:1,class:"mt-4"},ae={key:0,class:"bg-green-50 border border-green-200 rounded-lg p-3"},te={class:"mt-1 text-sm text-green-700"},se={class:"mt-2 space-y-1.5"},oe=["href","download"],re={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-3"},ne={class:"mt-1 text-sm text-red-700"},ie={key:0,class:"mt-1 text-xs text-gray-600"},ue=f({__name:"FormatConverter",setup(f){const ue=m([".pdf",".doc",".docx",".xls",".xlsx",".jpg",".jpeg",".png",".gif",".webp"]),de=m(null),ce=m([]),ve=m(!1),pe=m(""),ge=m(""),xe=m(!1),be=m(null),me=m(0),fe=m(""),ye=m(-1),he=m({processMode:"format-preserve",quality:80,pageRange:"",preserveLayout:!0,includeImages:!0}),we=m([]),ke=m([{value:"format-preserve",label:"保留原格式还原"},{value:"text-image",label:"文字 + 图片提取"},{value:"text-only",label:"纯文字提取"}]),Pe={pdf:[{value:"docx",label:"Word (.docx)",description:"适合编辑文本内容"},{value:"txt",label:"文本 (.txt)",description:"纯文本格式"},{value:"html",label:"HTML (.html)",description:"网页格式"},{value:"jpg",label:"图片 (.jpg)",description:"将PDF转换为图片"},{value:"png",label:"图片 (.png)",description:"无损压缩图片格式"},{value:"webp",label:"图片 (.webp)",description:"现代网页图片格式"},{value:"gif",label:"图片 (.gif)",description:"支持动画的图片格式"},{value:"pptx",label:"PowerPoint (.pptx)",description:"适合演示文稿"},{value:"xlsx",label:"Excel (.xlsx)",description:"适合表格数据"},{value:"md",label:"Markdown (.md)",description:"适合编写文档"},{value:"csv",label:"CSV (.csv)",description:"适合表格数据导出"}],doc:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"},{value:"docx",label:"Word (.docx)",description:"更新的Word格式"},{value:"txt",label:"文本 (.txt)",description:"纯文本格式"},{value:"html",label:"HTML (.html)",description:"网页格式"}],docx:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"},{value:"doc",label:"Word (.doc)",description:"兼容旧版本Word"},{value:"txt",label:"文本 (.txt)",description:"纯文本格式"},{value:"html",label:"HTML (.html)",description:"网页格式"}],xls:[{value:"xlsx",label:"Excel (.xlsx)",description:"更新的Excel格式"},{value:"csv",label:"CSV (.csv)",description:"逗号分隔值"},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],xlsx:[{value:"xls",label:"Excel (.xls)",description:"兼容旧版本Excel"},{value:"csv",label:"CSV (.csv)",description:"逗号分隔值"},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],ppt:[{value:"pptx",label:"PowerPoint (.pptx)",description:"更新的PowerPoint格式"},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],pptx:[{value:"ppt",label:"PowerPoint (.ppt)",description:"兼容旧版本PowerPoint"},{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"}],txt:[{value:"pdf",label:"PDF (.pdf)",description:"适合共享和打印"},{value:"docx",label:"Word (.docx)",description:"适合编辑文本内容"},{value:"html",label:"HTML (.html)",description:"网页格式"},{value:"md",label:"Markdown (.md)",description:"Markdown格式"}],jpg:[{value:"png",label:"PNG (.png)",description:"无损压缩格式"},{value:"webp",label:"WebP (.webp)",description:"现代网页图片格式"},{value:"gif",label:"GIF (.gif)",description:"支持动画的图片格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}],jpeg:[{value:"png",label:"PNG (.png)",description:"无损压缩格式"},{value:"webp",label:"WebP (.webp)",description:"现代网页图片格式"},{value:"gif",label:"GIF (.gif)",description:"支持动画的图片格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}],png:[{value:"jpg",label:"JPG (.jpg)",description:"有损压缩格式"},{value:"webp",label:"WebP (.webp)",description:"现代网页图片格式"},{value:"gif",label:"GIF (.gif)",description:"支持动画的图片格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}],webp:[{value:"jpg",label:"JPG (.jpg)",description:"通用图片格式"},{value:"png",label:"PNG (.png)",description:"无损压缩格式"},{value:"gif",label:"GIF (.gif)",description:"支持动画的图片格式"},{value:"pdf",label:"PDF (.pdf)",description:"将图片转换为PDF"}]},je=e=>{e.preventDefault(),ve.value=!0},De=e=>{e.preventDefault(),ve.value=!0},Fe=e=>{e.preventDefault();const l=e.currentTarget.getBoundingClientRect();(e.clientX<l.left||e.clientX>=l.right||e.clientY<l.top||e.clientY>=l.bottom)&&(ve.value=!1)},Me=e=>{e.preventDefault(),ve.value=!1;const l=Array.from(e.dataTransfer.files);Le(l)},Ce=e=>{const l=Array.from(e.target.files);Le(l)},Le=e=>{if(0===e.length)return;if(e.length>10)return void alert("最多支持上传10个文件");const l=e.map(e=>{const l=e.name.split(".");return l.length>1?l.pop().toLowerCase():""}),a=[...new Set(l)];if(a.length>1)return void alert("仅允许上传相同后缀名的文件");const t=a[0];pe.value=t,Te(t),Be(e)},Be=e=>{ce.value=e},Te=e=>{we.value=Pe[e]||[],we.value.length>0?(ge.value=we.value[0].value,Ge(we.value[0].value)):ge.value=""},Ge=e=>{ke.value={docx:[{value:"format-preserve",label:"保留原格式还原"},{value:"text-image",label:"文字 + 图片提取"},{value:"text-only",label:"纯文字提取"}],txt:[{value:"text-only",label:"纯文字提取"}],html:[{value:"text-image",label:"文字 + 图片提取"},{value:"text-only",label:"纯文字提取"}],jpg:[{value:"text-image",label:"文字 + 图片提取"}],png:[{value:"text-image",label:"文字 + 图片提取"}],webp:[{value:"text-image",label:"文字 + 图片提取"}],gif:[{value:"text-image",label:"文字 + 图片提取"}],pptx:[{value:"format-preserve",label:"保留原格式还原"},{value:"text-only",label:"纯文字提取"},{value:"text-image",label:"文字 + 图片提取"}],xlsx:[{value:"format-preserve",label:"保留原格式还原"},{value:"text-only",label:"纯文字提取"}],md:[{value:"text-only",label:"纯文字提取"}],csv:[{value:"text-only",label:"纯文字提取"}],pdf:[{value:"format-preserve",label:"保留原格式还原"}]}[e]||[{value:"format-preserve",label:"保留原格式还原"}];const l=ke.value[0].value;he.value.processMode=l},Ve=()=>{ce.value=[],pe.value="",ge.value="",we.value=[],be.value=null,he.value={processMode:"standard",quality:80,pageRange:"",preserveLayout:!0,includeImages:!0},de.value&&(de.value.value="")},_e=async()=>{if(ge.value){xe.value=!0,me.value=0,fe.value="准备开始处理...",ye.value=-1,be.value=null;try{ye.value=0,fe.value="上传中：正在上传文件到服务器";for(let t=0;t<=33;t++)me.value=t,await new Promise(e=>setTimeout(e,50));const e=new FormData;ce.value.forEach(l=>{e.append("files",l)}),e.append("source_format",pe.value),e.append("target_format",ge.value),e.append("process_mode",he.value.processMode),e.append("quality",he.value.quality.toString()),e.append("page_range",he.value.pageRange),ye.value=1,fe.value="处理中：服务器正在转换文件格式";for(let t=34;t<=66;t++)me.value=t,await new Promise(e=>setTimeout(e,30));const l=await fetch("http://localhost:8002/api/format-convert",{method:"POST",body:e});ye.value=2,fe.value="返回结果中：正在获取转换结果";for(let t=67;t<=99;t++)me.value=t,await new Promise(e=>setTimeout(e,20));const a=await l.json();me.value=100,fe.value="处理完成：正在显示结果",await new Promise(e=>setTimeout(e,300)),be.value=a}catch(e){be.value={success:!1,message:`转换失败：${e.message||"未知错误"}`,suggestion:"请检查文件是否损坏，或尝试使用其他文件"}}finally{setTimeout(()=>{xe.value=!1,me.value=0,fe.value="",ye.value=-1},500)}}else alert("请选择目标格式")},Ie=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]};return e(()=>{}),l(ge,e=>{e&&Ge(e)}),(e,l)=>(a(),t("section",y,[s("div",h,[l[16]||(l[16]=s("div",{class:"border-b border-gray-200 px-4 py-1"},[s("h2",{class:"text-lg font-bold text-gray-800"},"格式转换")],-1)),s("div",w,[s("div",{class:r(["border-2 border-dashed border-gray-300 rounded-lg p-4 text-center transition-all duration-300 mb-4",{"border-blue-500 bg-blue-50":ve.value}]),onDragover:o(je,["prevent"]),onDragenter:o(De,["prevent"]),onDragleave:o(Fe,["prevent"]),onDrop:o(Me,["prevent"])},[s("div",k,[l[6]||(l[6]=s("svg",{class:"w-10 h-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),s("div",null,[s("p",P," 拖拽文件到此处或点击选择，支持："+n(ue.value.join(", ")),1),l[5]||(l[5]=s("p",{class:"text-xs text-gray-400 mt-0.5"}," 提示：仅允许上传相同后缀名的文件，最多支持10个文件 ",-1))]),s("input",{type:"file",ref_key:"fileInput",ref:de,onChange:Ce,accept:ue.value.join(","),multiple:"",class:"hidden"},null,40,j),s("button",{onClick:l[0]||(l[0]=l=>e.$refs.fileInput.click()),class:"px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm"}," 选择文件 ")]),ce.value.length>0?(a(),t("div",D,[s("div",F,[s("div",M,[l[7]||(l[7]=s("svg",{class:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20"},[s("path",{"fill-rule":"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V4z","clip-rule":"evenodd"})],-1)),s("span",C,n(ce.value.length)+" 个文件已选择 ",1)]),s("button",{onClick:Ve,class:"text-red-500 hover:text-red-700 text-xs"}," 清空 ")]),s("div",L,[(a(!0),t(i,null,u(ce.value,(e,l)=>(a(),t("div",{key:l,class:"flex items-center justify-between bg-gray-50 p-1.5 rounded"},[s("span",B,n(e.name),1),s("span",T,n(Ie(e.size)),1),s("button",{onClick:e=>(e=>{ce.value.splice(e,1),0===ce.value.length&&(pe.value="",ge.value="",we.value=[],be.value=null)})(l),class:"text-red-500 hover:text-red-700 text-xs ml-2"}," × ",8,G)]))),128))])])):d("",!0)],34),ce.value.length>0&&pe.value?(a(),t("div",V,[s("div",_,[l[8]||(l[8]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"目标格式",-1)),s("div",I,[(a(!0),t(i,null,u(we.value,e=>(a(),t("label",{key:e.value,class:r(["flex items-center space-x-1.5 cursor-pointer p-1.5 border rounded-md hover:bg-gray-100 transition-colors",{"border-blue-500 bg-blue-50":ge.value===e.value}])},[c(s("input",{type:"radio","onUpdate:modelValue":l[1]||(l[1]=e=>ge.value=e),value:e.value,class:"w-2.5 h-2.5 text-blue-600"},null,8,W),[[v,ge.value]]),s("div",null,[s("div",q,n(e.label),1),s("div",z,n(e.description),1)])],2))),128))])]),ge.value?(a(),t("div",A,[l[12]||(l[12]=s("h3",{class:"text-sm font-medium text-gray-700 mb-2"},"操作参数",-1)),s("div",E,[s("div",null,[l[9]||(l[9]=s("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"处理方式",-1)),c(s("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>he.value.processMode=e),class:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"},[(a(!0),t(i,null,u(ke.value,e=>(a(),t("option",{key:e.value,value:e.value},n(e.label),9,R))),128))],512),[[p,he.value.processMode]])]),["pdf","docx","doc"].includes(pe.value)?(a(),t("div",S,[l[10]||(l[10]=s("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"页面范围",-1)),c(s("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>he.value.pageRange=e),type:"text",placeholder:"例如：1-5, 7, 9-12（留空表示全部）",class:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"},null,512),[[g,he.value.pageRange]])])):d("",!0),["jpg","jpeg","png","webp"].includes(pe.value)?(a(),t("div",H,[l[11]||(l[11]=s("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"图片质量",-1)),c(s("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>he.value.quality=e),type:"range",min:"1",max:"100",class:"w-full"},null,512),[[g,he.value.quality,void 0,{number:!0}]]),s("p",U,n(he.value.quality)+"%",1)])):d("",!0)])])):d("",!0),s("div",N,[s("button",{onClick:_e,disabled:!ge.value||xe.value,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed text-sm"},[xe.value?(a(),t("span",X,[...l[13]||(l[13]=[s("svg",{class:"animate-spin -ml-1 mr-1 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),x(" 处理中... ",-1)])])):(a(),t("span",J,"开始转换"))],8,$),s("button",{onClick:Ve,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm"}," 重置 ")]),xe.value?(a(),t("div",Y,[s("div",K,[s("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-500 ease-in-out",style:b({width:me.value+"%"})},null,4)]),s("div",O,[s("p",Z,n(fe.value),1),s("p",Q,n(me.value)+"%",1)]),s("div",ee,[s("span",{class:r({"text-blue-600 font-medium":ye.value>=0})},"上传中",2),s("span",{class:r({"text-blue-600 font-medium":ye.value>=1})},"处理中",2),s("span",{class:r({"text-blue-600 font-medium":ye.value>=2})},"返回结果中",2)])])):d("",!0)])):d("",!0),be.value?(a(),t("div",le,[be.value.success?(a(),t("div",ae,[l[14]||(l[14]=s("div",{class:"flex items-center"},[s("svg",{class:"w-4 h-4 text-green-500 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",te,n(be.value.message),1),s("div",se,[(a(!0),t(i,null,u(be.value.downloadLinks,(e,l)=>(a(),t("a",{key:l,href:`http://localhost:8002${e.url}`,download:e.filename,class:"block px-3 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 transition-colors text-center text-sm"}," 下载转换结果 "+n(l+1),9,oe))),128))])])):(a(),t("div",re,[l[15]||(l[15]=s("div",{class:"flex items-center"},[s("svg",{class:"w-4 h-4 text-red-500 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",ne,n(be.value.message),1),be.value.suggestion?(a(),t("p",ie,"建议："+n(be.value.suggestion),1)):d("",!0)]))])):d("",!0)])])]))}},[["__scopeId","data-v-0a9659e5"]]);export{ue as default};
