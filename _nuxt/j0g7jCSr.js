import{$ as e,w as l,m as a,p as s,q as t,n,F as o,u,x as i,D as r,z as d,I as c,a8 as v,J as p,v as m,L as g,k as b,l as h}from"./DwDdtX2U.js";import{_ as x}from"./CFdA-A2g.js";import{G as f}from"./CiXH2Qpk.js";import{s as y}from"./vp7J0J8P.js";import"./C3WxCecE.js";import"./Dq87FbFi.js";import"./B7n04RKk.js";import"./DgXBCkKa.js";const k={class:"space-y-6"},w={key:0,class:"bg-gray-50 p-4 rounded-lg"},C={class:"space-y-2"},M={class:"flex items-center"},L={class:"font-medium"},j={class:"text-sm text-gray-500"},V=["onClick"],F={key:1,class:"bg-gray-50 p-4 rounded-lg"},U={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4"},z=["value"],O={class:"font-medium"},B={class:"text-sm text-gray-500"},H={key:2,class:"space-y-4"},T={class:"space-y-2"},D={class:"flex items-center space-x-2"},S={class:"flex items-center space-x-2"},A={class:"flex items-center space-x-2"},E={key:0,class:"bg-white p-4 rounded-lg border"},$={class:"space-y-2"},I={class:"flex items-center space-x-2"},G={key:1,class:"bg-white p-4 rounded-lg border"},P={class:"space-y-2"},_={class:"flex items-center space-x-2"},R={class:"flex items-center space-x-2"},q={class:"flex items-center space-x-2"},J={class:"flex space-x-4"},K=["disabled"],N={key:0},Q={key:1,class:"flex items-center justify-center"},W={key:3,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},X={class:"flex items-center justify-between mb-2"},Y={class:"text-blue-700"},Z={class:"w-full bg-gray-200 rounded-full h-2.5"},ee={class:"mt-2 text-sm text-blue-700"},le={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4"},ae={class:"mt-2 text-green-700"},se={class:"mt-3 space-y-2"},te=["href","download"],ne={key:5,class:"bg-red-50 border border-red-200 rounded-lg p-4"},oe={class:"mt-2 text-red-700"},ue={key:0,class:"mt-2 text-sm text-gray-600"},ie={__name:"index",setup(ie){const re=[{value:"eml",label:"EML (.eml)",description:"电子邮件格式",extensions:[".eml"]},{value:"msg",label:"MSG (.msg)",description:"Outlook邮件格式",extensions:[".msg"]},{value:"pdf",label:"PDF (.pdf)",description:"便携式文档格式",extensions:[".pdf"]},{value:"html",label:"HTML (.html)",description:"网页格式",extensions:[".html"]},{value:"txt",label:"文本 (.txt)",description:"纯文本格式",extensions:[".txt"]}],de=b(""),ce=b({includeAttachments:!0,preserveFormatting:!0,includeHeaders:!1}),ve=b({pageSize:"a4",pageOrientation:"portrait",includeTableOfContents:!1}),pe=b({inlineCss:!0,responsiveDesign:!0,embedImages:!0}),me=b([]),ge=h(()=>me.value),be=b(!1),he=b(!1),xe=b(""),fe=b(""),ye=b(""),ke=b(0),we=b(""),Ce=b([]),Me=b([]),Le=["1. 上传文件：支持EML、MSG、PDF、HTML和文本格式，可批量上传","2. 系统自动识别源文件格式","3. 选择目标格式：系统会根据源格式显示可用的目标格式","4. 设置转换选项：是否包含附件、保留格式、包含邮件头等",'5. 点击"开始转换"按钮进行处理',"6. 等待处理完成，系统会自动下载处理后的文件","7. 查看处理结果，确保内容和格式的准确性"],je=e=>e.split(".").pop().toLowerCase(),Ve=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},Fe=e=>{me.value=e,e.length>0?Ue():(Me.value=[],de.value=""),fe.value="",he.value=!1},Ue=()=>{if(0===me.value.length)return void(Me.value=[]);const e=je(me.value[0].name),l=[];re.forEach(a=>{a.extensions.some(l=>e===l.replace(".",""))||l.push(a)}),Me.value=l,l.length>0?de.value=l[0].value:de.value=""},ze=e=>{fe.value=e,ye.value=Oe(e)},Oe=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",Be=async()=>{if(0!==ge.length)if(de.value){be.value=!0,fe.value="",ye.value="",he.value=!1,ke.value=0,we.value="准备转换...",Ce.value=[];try{await new Promise(e=>{let l=0;const a=y(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),ke.value=l,we.value=l<30?"正在分析邮件文件...":l<70?"正在转换格式...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});let e={files:ge.value,targetFormat:de.value,options:ce.value};"pdf"===de.value?e.pdfOptions=ve.value:"html"===de.value&&(e.htmlOptions=pe.value);const l=re.find(e=>e.value===de.value);xe.value=`成功将 ${ge.length} 个文件转换为 ${l.label} 格式！`,he.value=!0,ge.forEach((e,l)=>{const a=new Blob(["模拟转换后的邮件内容"],{type:"application/octet-stream"}),s=URL.createObjectURL(a),t=`converted_${e.name.replace(/\.[^/.]+$/,`.${de.value}`)}`;Ce.value.push({url:s,filename:t})}),Ce.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=Ce.value[0].url,e.download=Ce.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){fe.value=`转换失败：${e.message||"未知错误"}`,ye.value=Oe(fe.value)}finally{be.value=!1}}else fe.value="请选择目标格式";else fe.value="请选择文件"},He=()=>{me.value=[],de.value="",ce.value={includeAttachments:!0,preserveFormatting:!0,includeHeaders:!1},ve.value={pageSize:"a4",pageOrientation:"portrait",includeTableOfContents:!1},pe.value={inlineCss:!0,responsiveDesign:!0,embedImages:!0},fe.value="",ye.value="",he.value=!1,xe.value="",ke.value=0,we.value="",Ce.value=[],Me.value=[]};return(b,h)=>(a(),e(x,{title:"邮件格式转换",description:"EML/MSG与PDF/HTML等格式互转",tips:Le},{default:l(()=>[s("div",k,[t(f,{multiple:!0,accept:[".eml",".msg",".pdf",".html",".txt"],"max-size":104857600,modelValue:me.value,"onUpdate:modelValue":h[0]||(h[0]=e=>me.value=e),onFilesChanged:Fe,onError:ze},null,8,["modelValue"]),ge.value.length>0?(a(),n("div",w,[h[13]||(h[13]=s("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),s("div",C,[(a(!0),n(o,null,u(ge.value,(e,l)=>(a(),n("div",{key:l,class:"flex items-center justify-between p-2 bg-white rounded border"},[s("div",M,[h[11]||(h[11]=s("svg",{class:"w-5 h-5 text-gray-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)),s("div",null,[s("div",L,i(e.name),1),s("div",j,i(je(e.name))+" • "+i(Ve(e.size)),1)])]),s("button",{onClick:e=>(e=>{me.value.splice(e,1),0===me.value.length?He():Ue()})(l),class:"text-red-500 hover:text-red-700"},[...h[12]||(h[12]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,V)]))),128))])])):r("",!0),ge.value.length>0&&Me.value.length>0?(a(),n("div",F,[h[14]||(h[14]=s("h3",{class:"text-lg font-semibold mb-4"},"目标格式",-1)),s("div",U,[(a(!0),n(o,null,u(Me.value,e=>(a(),n("label",{key:e.value,class:"flex items-center space-x-2 cursor-pointer p-3 border rounded-lg hover:bg-gray-100"},[d(s("input",{type:"radio","onUpdate:modelValue":h[1]||(h[1]=e=>de.value=e),value:e.value,class:"w-4 h-4 text-blue-600"},null,8,z),[[c,de.value]]),s("div",null,[s("div",O,i(e.label),1),s("div",B,i(e.description),1)])]))),128))])])):r("",!0),ge.value.length>0?(a(),n("div",H,[s("div",null,[h[18]||(h[18]=s("h3",{class:"text-lg font-semibold mb-2"},"转换选项",-1)),s("div",T,[s("label",D,[d(s("input",{type:"checkbox","onUpdate:modelValue":h[2]||(h[2]=e=>ce.value.includeAttachments=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ce.value.includeAttachments]]),h[15]||(h[15]=s("span",null,"包含附件",-1))]),s("label",S,[d(s("input",{type:"checkbox","onUpdate:modelValue":h[3]||(h[3]=e=>ce.value.preserveFormatting=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ce.value.preserveFormatting]]),h[16]||(h[16]=s("span",null,"保留格式",-1))]),s("label",A,[d(s("input",{type:"checkbox","onUpdate:modelValue":h[4]||(h[4]=e=>ce.value.includeHeaders=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ce.value.includeHeaders]]),h[17]||(h[17]=s("span",null,"包含邮件头",-1))])])]),"pdf"===de.value?(a(),n("div",E,[h[24]||(h[24]=s("h3",{class:"text-lg font-semibold mb-3"},"PDF转换选项",-1)),s("div",$,[s("div",null,[h[20]||(h[20]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"页面大小",-1)),d(s("select",{"onUpdate:modelValue":h[5]||(h[5]=e=>ve.value.pageSize=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...h[19]||(h[19]=[s("option",{value:"a4"},"A4",-1),s("option",{value:"letter"},"Letter",-1),s("option",{value:"legal"},"Legal",-1)])],512),[[p,ve.value.pageSize]])]),s("div",null,[h[22]||(h[22]=s("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"页面方向",-1)),d(s("select",{"onUpdate:modelValue":h[6]||(h[6]=e=>ve.value.pageOrientation=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...h[21]||(h[21]=[s("option",{value:"portrait"},"纵向",-1),s("option",{value:"landscape"},"横向",-1)])],512),[[p,ve.value.pageOrientation]])]),s("div",null,[s("label",I,[d(s("input",{type:"checkbox","onUpdate:modelValue":h[7]||(h[7]=e=>ve.value.includeTableOfContents=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,ve.value.includeTableOfContents]]),h[23]||(h[23]=s("span",null,"包含目录",-1))])])])])):r("",!0),"html"===de.value?(a(),n("div",G,[h[28]||(h[28]=s("h3",{class:"text-lg font-semibold mb-3"},"HTML转换选项",-1)),s("div",P,[s("div",null,[s("label",_,[d(s("input",{type:"checkbox","onUpdate:modelValue":h[8]||(h[8]=e=>pe.value.inlineCss=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,pe.value.inlineCss]]),h[25]||(h[25]=s("span",null,"内联CSS样式",-1))])]),s("div",null,[s("label",R,[d(s("input",{type:"checkbox","onUpdate:modelValue":h[9]||(h[9]=e=>pe.value.responsiveDesign=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,pe.value.responsiveDesign]]),h[26]||(h[26]=s("span",null,"响应式设计",-1))])]),s("div",null,[s("label",q,[d(s("input",{type:"checkbox","onUpdate:modelValue":h[10]||(h[10]=e=>pe.value.embedImages=e),class:"w-4 h-4 text-blue-600"},null,512),[[v,pe.value.embedImages]]),h[27]||(h[27]=s("span",null,"嵌入图片",-1))])])])])):r("",!0)])):r("",!0),s("div",J,[s("button",{onClick:Be,disabled:!ge.value.length||!de.value||be.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[be.value?(a(),n("span",Q,[h[29]||(h[29]=s("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),m(" 处理中... "+i(ke.value)+"% ",1)])):(a(),n("span",N,"开始转换"))],8,K),s("button",{onClick:He,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),be.value?(a(),n("div",W,[s("div",X,[h[30]||(h[30]=s("h4",{class:"font-semibold text-blue-800"},"转换进度",-1)),s("span",Y,i(ke.value)+"%",1)]),s("div",Z,[s("div",{class:"bg-blue-600 h-2.5 rounded-full",style:g({width:ke.value+"%"})},null,4)]),s("p",ee,i(we.value),1)])):r("",!0),he.value?(a(),n("div",le,[h[31]||(h[31]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("h4",{class:"font-semibold text-green-800"},"转换成功")],-1)),s("p",ae,i(xe.value),1),s("div",se,[(a(!0),n(o,null,u(Ce.value,(e,l)=>(a(),n("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载转换结果 "+i(l+1),9,te))),128))])])):r("",!0),fe.value?(a(),n("div",ne,[h[32]||(h[32]=s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),s("h4",{class:"font-semibold text-red-800"},"转换失败")],-1)),s("p",oe,i(fe.value),1),ye.value?(a(),n("p",ue,"建议："+i(ye.value),1)):r("",!0)])):r("",!0)])]),_:1}))}};export{ie as default};
