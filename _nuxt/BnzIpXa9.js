import{j as $,w as G,o as n,a as t,q as u,y as h,b as C,c as r,s as F,l as i,t as m,C as z,r as s,x as E}from"./5KiIeb3O.js";import{_ as N}from"./D50zL9At.js";import{G as _}from"./9UHln5xC.js";import{_ as A}from"./DlAUqK2U.js";import"./drxn0VFK.js";import"./7YFkQcuL.js";import"./BrGRrvQ4.js";import"./bvqDPNRK.js";const P={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},j={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},q={class:"space-y-4"},H={key:0},I={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},K={key:0,class:"mt-4 p-4 bg-gray-50 rounded-md"},L={class:"text-sm text-gray-600"},W={key:0},X={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},J={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},O={class:"flex items-center space-x-2"},Q=["disabled"],Y={class:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Z={key:0,class:"mt-4 space-y-4"},ee={class:"p-4 bg-green-50 rounded-md"},te={class:"mt-2"},le={key:0},oe={class:"text-sm text-gray-600"},se={key:1,class:"mt-4"},ae={__name:"index",setup(ne){const p=s("email"),b=s(null),v=s(""),M=o=>{b.value=o[0]},T=o=>{b.value=o},a=s(null),x=s(null),U=o=>{a.value=o[0]},V=o=>{a.value=o,setTimeout(()=>{x.value=Array(10).fill(null).map((e,l)=>({id:l+1,name:`测试数据${l+1}`,value:`值${l+1}`}))},1e3)},f=s("txt"),c=s(10),g=s(!1),y=s(!1),d=s(null),k=E(()=>p.value==="custom"?!!v.value&&!!a.value:!!b.value&&!!a.value),B=()=>{k.value&&(y.value=!0,setTimeout(()=>{d.value={count:c.value,files:Array(c.value).fill(null).map((o,e)=>({id:e+1,name:`document-${e+1}.${f.value}`,url:"#"})),plagiarismCheck:g.value?{duplicationRate:Math.random()*20,details:"查重完成"}:null},y.value=!1},2e3))},S=()=>{alert("开始下载结果文件")},D=()=>{alert("预览功能开发中")},R=o=>{if(o===0)return"0 Bytes";const e=1024,l=["Bytes","KB","MB","GB"],w=Math.floor(Math.log(o)/Math.log(e));return parseFloat((o/Math.pow(e,w)).toFixed(2))+" "+l[w]};return(o,e)=>(n(),$(N,{title:"邮件/文案批量生成",description:"支持按Excel模板批量生成邮件正文/办公文案、自定义模板关键词替换"},{default:G(()=>[t("div",P,[t("div",j,[e[9]||(e[9]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"模板设置",-1)),t("div",q,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"模板类型",-1)),u(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>p.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[5]||(e[5]=[t("option",{value:"email"},"邮件模板",-1),t("option",{value:"document"},"办公文案",-1),t("option",{value:"custom"},"自定义模板",-1)])],512),[[h,p.value]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"模板文件",-1)),C(_,{accept:[".doc",".docx",".txt",".html"],multiple:!1,onFilesSelected:M,onUploadComplete:T})]),p.value==="custom"?(n(),r("div",H,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"自定义模板内容",-1)),u(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>v.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[200px]",placeholder:"输入模板内容，使用{{变量名}}标记需要替换的变量"},null,512),[[F,v.value]])])):i("",!0)])]),t("div",I,[e[11]||(e[11]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"数据文件",-1)),e[12]||(e[12]=t("p",{class:"text-sm text-gray-600 mb-4"},"上传包含变量数据的Excel或CSV文件",-1)),C(_,{accept:[".xls",".xlsx",".csv"],multiple:!1,onFilesSelected:U,onUploadComplete:V}),a.value?(n(),r("div",K,[e[10]||(e[10]=t("h4",{class:"font-medium text-gray-900 mb-2"},"数据预览",-1)),t("div",L,[t("p",null,"文件: "+m(a.value.name),1),t("p",null,"大小: "+m(R(a.value.size)),1),x.value?(n(),r("p",W,"数据行数: "+m(x.value.length),1)):i("",!0)])])):i("",!0)]),t("div",X,[e[18]||(e[18]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"生成设置",-1)),t("div",J,[t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>f.value=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[...e[13]||(e[13]=[t("option",{value:"txt"},"TXT",-1),t("option",{value:"docx"},"Word",-1),t("option",{value:"html"},"HTML",-1)])],512),[[h,f.value]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"生成数量",-1)),u(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),min:"1",max:"100",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[F,c.value,void 0,{number:!0}]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"操作选项",-1)),t("div",O,[u(t("input",{type:"checkbox",id:"enableCheck","onUpdate:modelValue":e[4]||(e[4]=l=>g.value=l),class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[z,g.value]]),e[16]||(e[16]=t("label",{for:"enableCheck",class:"text-sm text-gray-700"},"启用查重",-1))])])]),t("button",{class:"mt-6 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:B,disabled:!k.value}," 开始生成 ",8,Q)]),t("div",Y,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"生成结果",-1)),d.value?(n(),r("div",Z,[t("div",ee,[e[20]||(e[20]=t("h4",{class:"font-medium text-green-800"},"生成成功",-1)),t("p",te,"成功生成 "+m(d.value.count)+" 份文档",1),g.value&&d.value.plagiarismCheck?(n(),r("div",le,[e[19]||(e[19]=t("h5",{class:"font-medium text-gray-900 mt-3"},"查重结果",-1)),t("p",oe,"重复率: "+m(d.value.plagiarismCheck.duplicationRate)+"%",1)])):i("",!0)]),t("div",{class:"flex flex-wrap gap-3"},[t("button",{class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",onClick:S}," 下载全部结果 "),t("button",{class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",onClick:D}," 预览结果 ")])])):y.value?(n(),r("div",se,[...e[21]||(e[21]=[t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),t("span",{class:"text-gray-700"},"正在生成文档...")],-1)])])):i("",!0)])])]),_:1}))}},be=A(ae,[["__scopeId","data-v-36141314"]]);export{be as default};
