import{r as f,o as m,c as p,a,t as i,d as S,l as g,F as T,p as $,A as h,z as j}from"./5KiIeb3O.js";import{_ as L}from"./DlAUqK2U.js";const _={class:"flex flex-col items-center justify-center"},E={class:"text-gray-500 mb-4"},G=["accept","multiple"],I={key:0,class:"mt-4"},N={class:"flex items-center justify-between bg-gray-100 p-3 rounded"},O={class:"flex items-center space-x-3"},U={class:"text-sm font-medium"},W={key:0},X={key:0,class:"mt-3 space-y-2"},Y={class:"text-sm truncate"},H={class:"text-xs text-gray-500"},K=["onClick"],R={key:1,class:"mt-4 text-red-500 text-sm"},q={__name:"ToolUploadGeneralFileUpload",props:{multiple:{type:Boolean,default:!1},accept:{type:[String,Array],default:""},maxSize:{type:Number,default:100*1024*1024},modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","files-changed","error"],setup(r,{emit:k}){const c=r,n=k,l=f([...c.modelValue]),v=f(!1),o=f(""),x=f(null),F=t=>{const e=Array.from(t.target.files);y(e)},M=()=>{v.value=!0},w=t=>{const e=t.currentTarget.getBoundingClientRect();(t.clientX<e.left||t.clientX>=e.right||t.clientY<e.top||t.clientY>=e.bottom)&&(v.value=!1)},z=()=>{v.value=!0},B=t=>{v.value=!1;const e=Array.from(t.dataTransfer.files);y(e)},y=t=>{o.value="";const e=[];for(const s of t){if(c.accept&&!C(s)){o.value=`文件类型不支持：${s.name}`,n("error",o.value);return}if(s.size>c.maxSize){o.value=`文件大小超过限制：${s.name}`,n("error",o.value);return}e.push(s)}if(c.multiple)l.value=[...l.value,...e];else{if(e.length>1){o.value="只能选择一个文件",n("error",o.value);return}l.value=e}n("update:modelValue",l.value),n("files-changed",l.value)},C=t=>{if(!c.accept)return!0;const e=Array.isArray(c.accept)?c.accept:c.accept.split(",").map(u=>u.trim()),s=t.name.split(".").pop().toLowerCase(),d=e.some(u=>u.startsWith(".")?u.toLowerCase()===`.${s}`:!1),b=e.some(u=>u.startsWith(".")?!1:t.type===u||t.type.startsWith(u.replace("/*","/")));return d||b},V=t=>{l.value.splice(t,1),n("update:modelValue",l.value),n("files-changed",l.value)},A=()=>{l.value=[],x.value&&(x.value.value=""),n("update:modelValue",l.value),n("files-changed",l.value)},D=t=>{if(t===0)return"0 B";const e=1024,s=["B","KB","MB","GB"],d=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,d)).toFixed(2))+" "+s[d]};return(t,e)=>(m(),p("div",{class:j(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-all duration-300",{"border-blue-500 bg-blue-50":v.value}]),onDragover:h(z,["prevent"]),onDragenter:h(M,["prevent"]),onDragleave:h(w,["prevent"]),onDrop:h(B,["prevent"])},[a("div",_,[e[1]||(e[1]=a("svg",{class:"w-16 h-16 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1)),e[2]||(e[2]=a("h3",{class:"text-lg font-medium mb-2"},"选择文件",-1)),a("p",E,i(r.multiple?"支持多个文件":"支持单个文件")+i(r.accept?`，类型：${Array.isArray(r.accept)?r.accept.join(", "):r.accept}`:"")+"，最大"+i(r.maxSize/(1024*1024))+"MB ",1),a("input",{type:"file",ref_key:"fileInput",ref:x,onChange:F,accept:r.accept,multiple:r.multiple,class:"hidden"},null,40,G),a("button",{onClick:e[0]||(e[0]=s=>t.$refs.fileInput.click()),class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," 选择文件 "),e[3]||(e[3]=a("p",{class:"text-sm text-gray-500 mt-4"},"或拖拽文件到此处",-1))]),l.value.length>0?(m(),p("div",I,[a("div",N,[a("div",O,[e[4]||(e[4]=a("svg",{class:"w-6 h-6 text-red-500",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm2 6a2 2 0 114 0 2 2 0 01-4 0zM2 12a1 1 0 110-2 1 1 0 010 2zm14 0a1 1 0 110-2 1 1 0 010 2z","clip-rule":"evenodd"})],-1)),a("span",U,[S(i(l.value.length)+" 个文件已选择 ",1),!r.multiple&&l.value.length>0?(m(),p("span",W,i(l.value[0].name),1)):g("",!0)])]),a("button",{onClick:A,class:"text-red-500 hover:text-red-700 text-sm"},i(r.multiple?"清空文件":"移除"),1)]),r.multiple&&l.value.length>0?(m(),p("div",X,[(m(!0),p(T,null,$(l.value,(s,d)=>(m(),p("div",{key:d,class:"flex items-center justify-between bg-gray-50 p-2 rounded"},[a("span",Y,i(s.name),1),a("span",H,i(D(s.size)),1),a("button",{onClick:b=>V(d),class:"text-red-500 hover:text-red-700 text-sm ml-2"}," 删除 ",8,K)]))),128))])):g("",!0)])):g("",!0),o.value?(m(),p("div",R,i(o.value),1)):g("",!0)],34))}},Q=L(q,[["__scopeId","data-v-24ec22f4"]]);export{Q as G};
