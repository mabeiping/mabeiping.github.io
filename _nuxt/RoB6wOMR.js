import{n as e,p as l,H as a,E as t,x as s,D as r,L as u,F as o,u as n,z as d,a8 as i,k as v,m as c,I as p}from"./DwDdtX2U.js";import{s as b}from"./vp7J0J8P.js";import{_ as m}from"./Dq87FbFi.js";import"./C3WxCecE.js";const g={class:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-md"},x={key:0,class:"mb-4"},f={key:1,class:"mb-4"},y={key:2,class:"mt-6 p-4 bg-gray-50 rounded-lg"},h={class:"flex items-center justify-between"},w={class:"font-medium text-gray-800"},k={class:"text-sm text-gray-500"},D={key:3,class:"mt-6"},F={class:"w-full bg-gray-200 rounded-full h-2.5"},M={class:"text-center mt-2 text-gray-600"},P={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},B=["value"],j={class:"group"},C={class:"mt-3 p-4 border rounded-lg"},I={class:"space-y-3"},z={class:"flex items-center"},L={class:"flex items-center"},U={class:"flex items-center"},W=["disabled"],_={key:0,class:"mt-6"},T={class:"w-full bg-gray-200 rounded-full h-2.5"},V={class:"text-center mt-2 text-gray-600"},E={key:1,class:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg"},A={class:"text-green-600 mb-4"},S=["href"],$={key:2,class:"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg"},G={class:"text-red-600"},H=m({__name:"index",setup(m){const H=v(null),K=v(null),N=v(!1),q=v(!1),J=v(0),O=v("word"),Q=v(!1),R=v(0),X=v(null),Y=v(null),Z=v({optimizeForWeb:!1,preserveLayout:!0,includeImages:!0}),ee=[{value:"word",label:"Word (.docx)"},{value:"excel",label:"Excel (.xlsx)"},{value:"ppt",label:"PowerPoint (.pptx)"},{value:"pdf",label:"PDF (.pdf)"}],le=e=>{e.preventDefault(),N.value=!0},ae=e=>{e.preventDefault(),N.value=!1},te=e=>{e.preventDefault(),N.value=!1;const l=e.dataTransfer.files;l.length>0&&re(l[0])},se=e=>{const l=e.target.files[0];l&&re(l)},re=e=>{Y.value=null,e.name.toLowerCase().endsWith(".pdf")?e.size>52428800?Y.value="文件大小不能超过 50MB":ue(e):Y.value="仅支持 PDF 格式文件"},ue=e=>{q.value=!0,J.value=0;const l=b(()=>{J.value+=5,J.value>=100&&(clearInterval(l),setTimeout(()=>{q.value=!1,K.value=e},500))},200)},oe=()=>{K.value=null,H.value&&(H.value.value=""),Y.value=null},ne=e=>{if(0===e)return"0 Bytes";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB"][l]},de=e=>{const l=ee.find(l=>l.value===e);return l?l.label:e},ie=async()=>{if(K.value){Q.value=!0,R.value=0,Y.value=null;try{await new Promise(e=>{const l=b(()=>{R.value+=5,R.value>=100&&(clearInterval(l),setTimeout(e,500))},200)}),X.value={downloadUrl:"#",fileName:K.value.name.replace(/\.[^/.]+$/,"")+ve(O.value),fileSize:K.value.size}}catch(e){Y.value="转换失败，请重试"}finally{Q.value=!1}}else Y.value="请选择要转换的文件"},ve=e=>({word:".docx",excel:".xlsx",ppt:".pptx",pdf:".pdf"}[e]||".pdf"),ce=()=>{K.value=null,H.value&&(H.value.value=""),N.value=!1,q.value=!1,J.value=0,O.value="word",X.value=null,R.value=0,Y.value=null};return(v,b)=>(c(),e("div",g,[b[15]||(b[15]=l("h1",{class:"text-2xl font-bold mb-6 text-center"},"PDF格式转换",-1)),b[16]||(b[16]=l("div",{class:"mb-8"},[l("p",{class:"text-gray-600 mb-4"},"支持PDF与Word/Excel/PPT等格式互转，操作简单快捷")],-1)),l("form",{onSubmit:a(ie,["prevent"]),class:"space-y-6"},[l("div",{class:t(["border-2 border-dashed border-gray-300 rounded-lg p-8 text-center transition-all duration-300",{"border-blue-500 bg-blue-50":N.value,"border-red-500 bg-red-50":Y.value}]),onDragover:a(le,["prevent"]),onDragleave:a(ae,["prevent"]),onDrop:a(te,["prevent"])},[N.value?(c(),e("div",x,[...b[6]||(b[6]=[l("svg",{class:"w-16 h-16 mx-auto text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),l("p",{class:"mt-2 text-blue-600 font-medium"},"释放文件以上传",-1)])])):(c(),e("div",f,[...b[7]||(b[7]=[l("svg",{class:"w-16 h-16 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),l("p",{class:"mt-2 text-gray-600"},"拖拽 PDF 文件到此处或点击选择",-1),l("p",{class:"text-gray-400 text-sm mt-1"},"仅支持 PDF 格式文件，最大文件大小 50MB",-1)])])),l("input",{type:"file",ref_key:"fileInput",ref:H,class:"hidden",accept:".pdf",onChange:se},null,544),l("button",{type:"button",onClick:b[0]||(b[0]=e=>v.$refs.fileInput.click()),class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300"}," 选择 PDF 文件 "),K.value?(c(),e("div",y,[l("div",h,[l("div",null,[l("div",w,s(K.value.name),1),l("div",k,s(ne(K.value.size)),1)]),l("button",{type:"button",onClick:oe,class:"text-red-500 hover:text-red-700"},[...b[8]||(b[8]=[l("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])])):r("",!0),q.value?(c(),e("div",D,[l("div",F,[l("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:u({width:J.value+"%"})},null,4)]),l("p",M,s(J.value)+"%",1)])):r("",!0)],34),l("div",null,[b[9]||(b[9]=l("label",{class:"block text-gray-700 font-medium mb-2"},"转换为",-1)),l("div",P,[(c(),e(o,null,n(ee,e=>l("label",{key:e.value,class:t(["flex items-center p-3 border rounded-lg cursor-pointer hover:border-blue-500 transition duration-200",{"border-blue-500 bg-blue-50":O.value===e.value}])},[d(l("input",{type:"radio",value:e.value,"onUpdate:modelValue":b[1]||(b[1]=e=>O.value=e),class:"mr-2"},null,8,B),[[p,O.value]]),l("span",null,s(e.label),1)],2)),64))])]),l("div",null,[l("details",j,[b[13]||(b[13]=l("summary",{class:"cursor-pointer list-none flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[l("span",{class:"font-medium"},"高级选项"),l("span",{class:"transition-transform duration-300 group-open:rotate-180"},"▼")],-1)),l("div",C,[l("div",I,[l("label",z,[d(l("input",{type:"checkbox","onUpdate:modelValue":b[2]||(b[2]=e=>Z.value.optimizeForWeb=e),class:"mr-2"},null,512),[[i,Z.value.optimizeForWeb]]),b[10]||(b[10]=l("span",null,"优化为web使用",-1))]),l("label",L,[d(l("input",{type:"checkbox","onUpdate:modelValue":b[3]||(b[3]=e=>Z.value.preserveLayout=e),class:"mr-2"},null,512),[[i,Z.value.preserveLayout]]),b[11]||(b[11]=l("span",null,"保持原始布局",-1))]),l("label",U,[d(l("input",{type:"checkbox","onUpdate:modelValue":b[4]||(b[4]=e=>Z.value.includeImages=e),class:"mr-2"},null,512),[[i,Z.value.includeImages]]),b[12]||(b[12]=l("span",null,"包含图片",-1))])])])])]),l("button",{type:"submit",disabled:!K.value||Q.value,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed"},s(Q.value?"转换中...":"开始转换"),9,W)],32),Q.value?(c(),e("div",_,[l("div",T,[l("div",{class:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:u({width:R.value+"%"})},null,4)]),l("p",V,s(R.value)+"%",1)])):r("",!0),X.value?(c(),e("div",E,[b[14]||(b[14]=l("h3",{class:"font-semibold text-green-700 mb-2"},"转换成功",-1)),l("p",A,"文件已成功转换为 "+s(de(O.value))+" 格式",1),l("a",{href:X.value.downloadUrl,class:"inline-block bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-lg transition duration-300",download:""}," 下载文件 ",8,S),l("button",{onClick:ce,class:"ml-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-lg transition duration-300"}," 再次转换 ")])):r("",!0),Y.value?(c(),e("div",$,[l("p",G,s(Y.value),1),l("button",{onClick:b[5]||(b[5]=e=>Y.value=null),class:"mt-2 text-red-600 hover:text-red-800 text-sm"}," 关闭 ")])):r("",!0)]))}},[["__scopeId","data-v-2abd437e"]]);export{H as default};
