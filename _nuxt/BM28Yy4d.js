import{_ as R,a as U,b as W}from"./D9JWhQ1s.js";import{_ as q}from"./DWCqW3hE.js";import{e as A,p as I,m as J,u as G,c as d,b as y,a as t,j as Q,q as w,v as X,h as a,s as C,i as x,x as P,t as g,F as S,g as V,n as k,k as _,o as u,l as z}from"./Cyl4WCzq.js";import{g as Y,b as Z}from"./D-FQcWls.js";import"./D_fA1zd6.js";import"./DlAUqK2U.js";const ee={class:"min-h-screen bg-background"},te={class:"flex pt-nav-height"},se={class:"flex-1 lg:ml-sidebar-left overflow-y-auto"},oe={class:"max-w-8xl mx-auto px-4 py-2"},ae={class:"bg-white rounded-xl shadow-sm overflow-hidden"},re={class:"p-4"},le={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4"},ne={class:"flex-1 w-full sm:w-auto"},ie={class:"relative"},ce={class:"flex items-center gap-4 flex-wrap"},de={class:"flex items-center gap-2"},ue={class:"flex items-center gap-2"},me={class:"text-sm text-text-secondary"},pe={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6"},ge=["onClick"],ve={class:"bg-background rounded-lg overflow-hidden hover:shadow-lg transition-all duration-300 hover:-translate-y-1"},he={class:"p-3"},xe={class:"text-sm font-medium text-text-primary truncate"},fe={class:"text-xs text-text-secondary mt-1"},ye={key:1,class:"flex flex-col items-center justify-center py-16"},_e={key:2,class:"flex justify-center items-center gap-2"},be=["disabled"],we={class:"flex items-center gap-1"},Ce=["onClick"],ke=["disabled"],Pe={class:"text-sm text-text-secondary ml-4"},$e={__name:"templates",setup(Se){const v=x("all"),p=x("newest"),i=x(10),o=x(1),c=x(""),B=Z(),f=_(()=>{let s=B;if(v.value!=="all"&&(s=s.filter(e=>e.type===v.value)),c.value.trim()){const e=c.value.toLowerCase();s=s.filter(n=>n.name.toLowerCase().includes(e))}return p.value==="newest"&&(s=[...s].sort((e,n)=>new Date(n.createdAt)-new Date(e.createdAt))),s}),h=_(()=>Math.ceil(f.value.length/i.value)),b=_(()=>{const s=(o.value-1)*i.value,e=s+i.value;return f.value.slice(s,e)}),M=_(()=>{const s=[],e=h.value,n=o.value;if(e<=7)for(let r=1;r<=e;r++)s.push(r);else if(n<=4){for(let r=1;r<=5;r++)s.push(r);s.push("..."),s.push(e)}else if(n>=e-3){s.push(1),s.push("...");for(let r=e-4;r<=e;r++)s.push(r)}else{s.push(1),s.push("...");for(let r=n-1;r<=n+1;r++)s.push(r);s.push("..."),s.push(e)}return s}),N=s=>{s===31?z("/leave-request"):z(`/template/${s}`)},T=s=>{v.value=s,o.value=1,m()},$=()=>{o.value=1,m()},j=()=>{o.value=1,m()},F=s=>{s!=="..."&&(o.value=s,m())},H=()=>{o.value>1&&(o.value--,m())},L=()=>{o.value<h.value&&(o.value++,m())},m=()=>{localStorage.setItem("templatesState",JSON.stringify({selectedCategory:v.value,sortBy:p.value,itemsPerPage:i.value,currentPage:o.value,searchKeyword:c.value}))},O=()=>{{const s=localStorage.getItem("templatesState");if(s)try{const e=JSON.parse(s);v.value=e.selectedCategory||"all",p.value=e.sortBy||"newest",i.value=e.itemsPerPage||10,o.value=e.currentPage||1,c.value=e.searchKeyword||""}catch(e){console.error("Failed to load state:",e)}}};return A(()=>{O()}),I(c,()=>{o.value=1,m()}),J(),G({title:"模板库 - 办公工具箱",meta:[{name:"description",content:"浏览和下载各种Office模板，包括Word、Excel、PPT模板。提供商务报告、简历、合同、会议纪要、项目计划、产品说明书、财务报表、项目管理表、考勤表、库存管理、销售统计、预算表、商务演示、产品介绍、培训课件、年度总结、营销方案、数据分析等免费模板。"},{name:"keywords",content:"Office模板, Word模板, Excel模板, PPT模板, 商务报告, 简历模板, 合同模板, 会议纪要, 项目计划, 产品说明书, 财务报表, 项目管理表, 考勤表, 库存管理, 销售统计, 预算表, 商务演示, 产品介绍, 培训课件, 年度总结, 营销方案, 数据分析, 免费模板"},{name:"author",content:"办公工具箱"},{property:"og:title",content:"模板库 - 办公工具箱"},{property:"og:description",content:"浏览和下载各种Office模板，包括Word、Excel、PPT模板"},{property:"og:type",content:"website"},{property:"og:url",content:"https://www.worktoolkit.top/templates"},{property:"og:locale",content:"zh_CN"}],link:[{rel:"canonical",href:"https://www.worktoolkit.top/templates"}]}),(s,e)=>{const n=R,r=U,D=q,E=W;return u(),d("div",ee,[y(n),t("div",te,[y(r,{onCategoryChange:T}),t("main",se,[t("div",oe,[t("div",ae,[t("div",re,[t("div",le,[t("div",ne,[t("div",ie,[e[3]||(e[3]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11l-6-6C9.46 4.59 8.41 4.59 6.5c0-1.1.9-2 2-2s2 .9 2 2c1.41 0 2.59.59 2.59l6 6c0 1.1-.9 2-2 2-.41 0-.79-.21-1.03-.28l.27.28v.79l5-4.99L20.49 19l-4.99 5zm-6 0C7.01 3 7 3 7 3s-1.01 3-2.25 3c-1.24 0-2.25 1.01-2.25 2.25s1.01 2.25 2.25 2.25c0 .41-.17.79-.44 1.03-.6l-.27-.28v-.79l-.49.5-.49 1.41z"})],-1)),w(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>C(c)?c.value=l:null),placeholder:"搜索模板...",class:"w-full pl-12 pr-4 py-2.5 border border-gray-200 rounded-lg text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"},null,512),[[X,a(c)]])])]),t("div",ce,[t("div",de,[e[5]||(e[5]=t("label",{class:"text-sm text-text-secondary"},"排序：",-1)),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>C(p)?p.value=l:null),onChange:$,class:"px-3 py-2 border border-gray-200 rounded-lg text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},[...e[4]||(e[4]=[t("option",{value:"newest"},"最新",-1)])],544),[[P,a(p)]])]),t("div",ue,[e[7]||(e[7]=t("label",{class:"text-sm text-text-secondary"},"每页：",-1)),w(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>C(i)?i.value=l:null),onChange:j,class:"px-3 py-2 border border-gray-200 rounded-lg text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-primary/20"},[...e[6]||(e[6]=[t("option",{value:"10"},"10条",-1),t("option",{value:"20"},"20条",-1),t("option",{value:"30"},"30条",-1)])],544),[[P,a(i)]])])]),t("div",me," 找到 "+g(a(f).length)+" 个模板 ",1)]),a(b).length>0?(u(),d("div",pe,[(u(!0),d(S,null,V(a(b),l=>(u(),d("div",{key:l.id,onClick:K=>N(l.id),class:"group cursor-pointer"},[t("div",ve,[e[8]||(e[8]=t("div",{class:"aspect-video bg-gradient-to-br from-primary/10 to-primary/5 flex items-center justify-center"},[t("svg",{class:"w-16 h-16 text-primary",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h5v6h6v10H6z"})])],-1)),t("div",he,[t("h4",xe,g(l.name),1),t("p",fe,g(a(Y)(l.type)),1)])])],8,ge))),128))])):(u(),d("div",ye,[...e[9]||(e[9]=[t("svg",{class:"w-20 h-20 text-gray-300 mb-4",fill:"currentColor",viewBox:"0 0 24 24"},[t("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zm-1 2l5 5h-5V4zM6 20V4h5v6h6v10H6z"})],-1),t("p",{class:"text-lg text-text-secondary"},"暂无模板",-1),t("p",{class:"text-sm text-gray-400 mt-1"},"该分类下暂无模板",-1)])])),a(b).length>0?(u(),d("div",_e,[t("button",{onClick:H,disabled:a(o)===1,class:k(["px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200",a(o)===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-text-primary hover:bg-gray-50 border border-gray-200"])}," 上一页 ",10,be),t("div",we,[(u(!0),d(S,null,V(a(M),l=>(u(),d("button",{key:l,onClick:K=>F(l),class:k(["w-10 h-10 rounded-lg text-sm font-medium transition-all duration-200",a(o)===l?"bg-primary text-white shadow-md":"bg-white text-text-primary hover:bg-gray-50 border border-gray-200"])},g(l),11,Ce))),128))]),t("button",{onClick:L,disabled:a(o)===a(h),class:k(["px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200",a(o)===a(h)?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-text-primary hover:bg-gray-50 border border-gray-200"])}," 下一页 ",10,ke),t("div",Pe," 共 "+g(a(f).length)+" 条，"+g(a(h))+" 页 ",1)])):Q("",!0)])]),y(D)])]),y(E)])])}}};export{$e as default};
