import{_ as L,r as u,c as a,a as e,m as f,y as P,t as c,F as _,l as x,n as v,v as N,d as g,z as h,o as i,p as w,B as U}from"./CXV6dDrr.js";const O={class:"office-converter-page"},$={class:"converter-container"},A={class:"upload-section"},R={key:0,class:"file-list"},W={class:"file-items"},q={class:"file-icon"},G={class:"file-name"},K={class:"file-size"},j=["onClick"],H={class:"options-section"},J={class:"option-group"},Q={class:"format-options"},Y=["value"],Z={class:"format-icon"},ee={class:"format-name"},se={class:"option-group"},oe={class:"option-group"},le={class:"option-label"},te={class:"option-group"},ne={class:"option-label"},ae={class:"option-group"},ie={class:"option-label"},ue={class:"action-section"},ce=["disabled"],de={key:0},re={key:1},pe=["disabled"],ve={key:0,class:"results-section"},me={class:"result-items"},fe={class:"result-icon"},_e={class:"result-name"},xe=["onClick"],ge={__name:"office-format-converter",setup(he){const k=u(null),t=u([]),d=u("pdf"),b=u("medium"),y=u(!0),C=u(!0),F=u(!1),r=u(!1),p=u([]),D=[{value:"pdf",name:"PDF",icon:"📕"},{value:"docx",name:"DOCX",icon:"📘"},{value:"xlsx",name:"XLSX",icon:"📊"},{value:"pptx",name:"PPTX",icon:"📽"},{value:"txt",name:"TXT",icon:"📝"}],M=()=>{k.value.click()},X=l=>{const s=Array.from(l.target.files);t.value=[...t.value,...s]},B=l=>{const o=Array.from(l.dataTransfer.files).filter(n=>{const m=n.name.split(".").pop().toLowerCase();return["doc","docx","xls","xlsx","ppt","pptx","pdf"].includes(m)});t.value=[...t.value,...o]},S=l=>{t.value.splice(l,1)},T=l=>{const s=l.split(".").pop().toLowerCase();return{doc:"📘",docx:"📘",xls:"📊",xlsx:"📊",ppt:"📽",pptx:"📽",pdf:"📕"}[s]||"📄"},V=l=>{if(l===0)return"0 B";const s=1024,o=["B","KB","MB","GB"],n=Math.floor(Math.log(l)/Math.log(s));return Math.round(l/Math.pow(s,n)*100)/100+" "+o[n]},z=async()=>{if(t.value.length!==0){r.value=!0,p.value=[];for(const l of t.value){await new Promise(o=>setTimeout(o,1e3));const s=Math.random()>.2;p.value.push({fileName:l.name,success:s,message:s?`转换成功 (${d.value.toUpperCase()})`:"转换失败，请重试",file:s?l:null})}r.value=!1}},E=l=>{const s=document.createElement("a");s.href="#",s.download=l.fileName.replace(/\.[^/.]+$/,"")+"."+d.value,s.click()},I=()=>{t.value=[],p.value=[]};return(l,s)=>(i(),a("div",O,[s[16]||(s[16]=e("h1",{class:"page-title"},"Office文档格式转换工具",-1)),e("div",$,[e("div",A,[e("div",{class:"upload-area",onClick:M,onDragover:s[0]||(s[0]=P(()=>{},["prevent"])),onDrop:P(B,["prevent"])},[s[6]||(s[6]=e("div",{class:"upload-icon"},"📊",-1)),s[7]||(s[7]=e("div",{class:"upload-text"},[e("p",null,"拖拽文件到此处或点击上传"),e("p",{class:"upload-hint"},"支持 Word, Excel, PowerPoint, PDF 格式")],-1)),e("input",{type:"file",ref_key:"fileInput",ref:k,onChange:X,accept:".doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf",multiple:"",style:{display:"none"}},null,544)],32),t.value.length>0?(i(),a("div",R,[e("h3",null,"已选择文件 ("+c(t.value.length)+")",1),e("div",W,[(i(!0),a(_,null,x(t.value,(o,n)=>(i(),a("div",{key:n,class:"file-item"},[e("span",q,c(T(o.name)),1),e("span",G,c(o.name),1),e("span",K,c(V(o.size)),1),e("button",{class:"remove-button",onClick:m=>S(n)},"✕",8,j)]))),128))])])):f("",!0)]),e("div",H,[s[14]||(s[14]=e("h3",null,"转换选项",-1)),e("div",J,[s[8]||(s[8]=e("label",{class:"option-label"},"目标格式",-1)),e("div",Q,[(i(),a(_,null,x(D,o=>e("label",{key:o.value,class:w(["format-option",{active:d.value===o.value}])},[v(e("input",{type:"radio","onUpdate:modelValue":s[1]||(s[1]=n=>d.value=n),value:o.value,name:"outputFormat"},null,8,Y),[[U,d.value]]),e("span",Z,c(o.icon),1),e("span",ee,c(o.name),1)],2)),64))])]),e("div",se,[s[10]||(s[10]=e("label",{class:"option-label"},"输出质量",-1)),v(e("select",{class:"option-select","onUpdate:modelValue":s[2]||(s[2]=o=>b.value=o)},[...s[9]||(s[9]=[e("option",{value:"high"},"高质量",-1),e("option",{value:"medium"},"标准质量",-1),e("option",{value:"low"},"低质量（文件更小）",-1)])],512),[[N,b.value]])]),e("div",oe,[e("label",le,[v(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=o=>y.value=o)},null,512),[[h,y.value]]),s[11]||(s[11]=g(" 保留格式 ",-1))])]),e("div",te,[e("label",ne,[v(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>C.value=o)},null,512),[[h,C.value]]),s[12]||(s[12]=g(" 保留图片 ",-1))])]),e("div",ae,[e("label",ie,[v(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=o=>F.value=o)},null,512),[[h,F.value]]),s[13]||(s[13]=g(" 合并Excel工作表 ",-1))])])]),e("div",ue,[e("button",{class:"convert-button",onClick:z,disabled:t.value.length===0||r.value},[r.value?(i(),a("span",re,"⏳ 转换中...")):(i(),a("span",de,"🔄 开始转换"))],8,ce),e("button",{class:"clear-button",onClick:I,disabled:r.value}," 🗑️ 清空 ",8,pe)]),p.value.length>0?(i(),a("div",ve,[s[15]||(s[15]=e("h3",null,"转换结果",-1)),e("div",me,[(i(!0),a(_,null,x(p.value,(o,n)=>(i(),a("div",{key:n,class:"result-item"},[e("span",fe,c(o.success?"✅":"❌"),1),e("span",_e,c(o.fileName),1),e("span",{class:w(["result-status",o.success?"success":"error"])},c(o.message),3),o.success?(i(),a("button",{key:0,class:"download-button",onClick:m=>E(o)}," ⬇️ 下载 ",8,xe)):f("",!0)]))),128))])])):f("",!0)]),s[17]||(s[17]=e("div",{class:"info-section"},[e("h2",null,"功能说明"),e("p",null,"这是一个功能强大的Office文档格式转换工具，支持多种格式之间的相互转换。"),e("ul",null,[e("li",null,"支持 Word (DOC, DOCX), Excel (XLS, XLSX), PowerPoint (PPT, PPTX), PDF 格式"),e("li",null,"批量转换，一次处理多个文件"),e("li",null,"支持拖拽上传，操作简便"),e("li",null,"可自定义输出质量和格式保留选项"),e("li",null,"支持合并Excel工作表"),e("li",null,"转换速度快，保持原文档结构")])],-1))]))}},be=L(ge,[["__scopeId","data-v-c84dca62"]]);export{be as default};
