const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./sRkIUGr0.js","./DNRRGdBn.js","./entry.CHqDdNv_.css"])))=>i.map(i=>d[i]);
import{e as ce,y as ue,h as pe,m as b,A as me,u as xe,c as a,b as j,a as e,t as d,f as o,j as x,q as y,F as V,r as F,k as h,p as E,g as z,v as M,z as ye,s as L,n as ve,o as i,d as ge,C as be,_ as D}from"./DNRRGdBn.js";import{_ as he,a as fe,b as _e}from"./D0ErU5Eq.js";import{b as we,c as ke,g as Ce}from"./B0vMD9RH.js";import"./D4IwebrK.js";const Se={class:"min-h-screen bg-background"},$e={class:"flex pt-nav-height"},Ve={class:"flex-1 lg:ml-sidebar-left overflow-y-auto"},Fe={class:"max-w-7xl mx-auto px-4 py-6"},Ee={class:"mb-6"},Me={class:"flex items-center justify-between mb-2"},Ne={class:"flex items-center gap-2"},Te={class:"text-2xl font-bold text-text-primary"},Ue={class:"px-3 py-1 bg-primary/10 text-primary text-sm rounded-full"},je={class:"relative export-button-container"},ze=["disabled"],De={key:0,class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},Be={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pe={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 z-50 overflow-hidden"},Le={class:"py-1"},He=["onClick","disabled"],Re={class:"flex-1"},Ie={class:"text-sm font-medium text-text-primary group-hover:text-primary transition-colors"},Oe={class:"text-xs text-text-secondary"},Ae={class:"flex flex-col lg:flex-row gap-6"},qe={class:"w-full lg:w-1/2 space-y-4"},Ge={class:"bg-white rounded-xl shadow-sm p-6"},We={class:"space-y-4"},Je={key:0,class:"text-red-500"},Ke=["onUpdate:modelValue","type","placeholder","onInput"],Xe=["onUpdate:modelValue","onChange"],Ye={value:""},Qe=["value"],Ze=["onUpdate:modelValue","onInput"],et=["onUpdate:modelValue","placeholder","onInput"],tt=["onUpdate:modelValue","placeholder","onInput"],ot={key:5,class:"text-xs text-red-500"},st={class:"bg-white rounded-xl shadow-sm p-6"},nt={class:"space-y-4"},rt={class:"space-y-1"},lt={class:"space-y-1"},at={class:"space-y-1"},it={class:"flex items-center gap-2"},dt={class:"text-sm text-text-secondary"},ct={class:"space-y-1"},ut={class:"w-full lg:w-1/2"},pt={class:"bg-white rounded-xl shadow-sm overflow-hidden"},mt={class:"flex items-center justify-between p-4 border-b border-gray-200"},xt={class:"flex items-center gap-2"},yt={class:"text-sm text-text-secondary w-16 text-center"},vt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},gt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},bt={key:0,class:"space-y-4"},ht={class:"text-2xl font-bold text-center mb-6"},ft={class:"space-y-3"},_t={key:0,class:"flex"},wt={key:1,class:"flex"},kt={key:2,class:"mt-4"},Ct={class:"mt-2 whitespace-pre-wrap"},St={key:1,class:"space-y-4"},$t={class:"text-2xl font-bold text-center mb-6"},Vt={class:"w-full border-collapse border border-gray-300"},Ft={class:"border border-gray-300 px-4 py-2"},Et={class:"border border-gray-300 px-4 py-2"},Mt={class:"border border-gray-300 px-4 py-2"},Nt={class:"border border-gray-300 px-4 py-2"},Tt={key:2,class:"space-y-4"},Ut={class:"text-3xl font-bold text-center mb-8"},jt={class:"space-y-6"},zt={key:0,class:"text-center text-xl"},Dt={key:1,class:"whitespace-pre-wrap"},Bt={key:2,class:"text-right text-text-secondary"},Pt={key:3,class:"text-center text-text-secondary py-12"},At={__name:"[id]",setup(Lt){const H=ce();ue();const N=L(()=>parseInt(H.params.id)),v=b(null),k=b([]),n=b({}),m=b({}),u=b({fontFamily:"SimSun",fontSize:"16",color:"#000000",lineHeight:"1.5"}),B=b({}),f=b(1),$=b(!1),_=b(!1),w=b(!1),R=[{value:"docx",name:"Word 文档",ext:"DOCX",desc:"Microsoft Word 格式",bgColor:"bg-blue-100",textColor:"text-blue-600"},{value:"doc",name:"Word 文档",ext:"DOC",desc:"旧版 Word 格式",bgColor:"bg-blue-100",textColor:"text-blue-600"},{value:"pdf",name:"PDF 文档",ext:"PDF",desc:"便携式文档格式",bgColor:"bg-red-100",textColor:"text-red-600"},{value:"png",name:"PNG 图片",ext:"PNG",desc:"高清图片格式",bgColor:"bg-green-100",textColor:"text-green-600"},{value:"jpg",name:"JPG 图片",ext:"JPG",desc:"压缩图片格式",bgColor:"bg-yellow-100",textColor:"text-yellow-600"}],I=()=>{v.value=we(N.value),v.value&&(k.value=ke(v.value.type)||[],n.value={},k.value.forEach(r=>{n.value[r.id]=""}))},C=r=>{const t=k.value.find(c=>c.id===r);t&&(t.required&&!n.value[r]?.trim()?m.value[r]="此项必填":t.type==="number"&&n.value[r]&&isNaN(n.value[r])?m.value[r]="请输入有效数字":delete m.value[r])},O=()=>{let r=!0;return k.value.forEach(t=>{t.required&&(C(t.id),m.value[t.id]&&(r=!1))}),r},A=()=>{n.value={},k.value.forEach(r=>{n.value[r.id]=""}),m.value={}},q=()=>{sessionStorage.setItem(`templateStyle_${N.value}`,JSON.stringify(u.value))},G=()=>{u.value={...B.value}},W=()=>{{const r=sessionStorage.getItem(`templateStyle_${N.value}`);if(r)try{u.value=JSON.parse(r)}catch(t){console.error("Failed to load style:",t)}}},J=()=>{f.value<2&&(f.value=Math.min(2,f.value+.1))},K=()=>{f.value>.5&&(f.value=Math.max(.5,f.value-.1))},X=()=>{$.value=!$.value},Y=()=>{w.value=!w.value},Q=async(r="docx")=>{if(!O()){alert("请先填写所有必填项");return}exportFormat.value=r,w.value=!1,_.value=!0;try{const t=`${v.value?.name||"模板"}_${new Date().getTime()}`;r==="docx"||r==="doc"?await Z(t,r):r==="pdf"?await ee(t):(r==="png"||r==="jpg")&&await te(t,r),console.log("文件已下载:",t)}catch(t){console.error("Export failed:",t),alert("下载失败，请重试")}finally{_.value=!1}},Z=async(r,t)=>{const{Document:c,Packer:p,Paragraph:g,TextRun:s,HeadingLevel:l,AlignmentType:S}=await D(async()=>{const{Document:ne,Packer:re,Paragraph:le,TextRun:ae,HeadingLevel:ie,AlignmentType:de}=await import("./Bn_dLcEw.js");return{Document:ne,Packer:re,Paragraph:le,TextRun:ae,HeadingLevel:ie,AlignmentType:de}},[],import.meta.url),T=new c({sections:[{properties:{},children:[new g({text:n.value.title||"文档标题",heading:l.HEADING_1,alignment:S.CENTER,spacing:{after:400}}),new g({children:[new s({text:`公司名称：${n.value.companyName||""}`,bold:!0})],spacing:{after:200}}),new g({children:[new s({text:`日期：${n.value.date||""}`,bold:!0})],spacing:{after:200}}),new g({text:"内容：",heading:l.HEADING_2,spacing:{before:400,after:200}}),new g({text:n.value.content||"",spacing:{after:400}})]}]}),U=await p.toBlob(T);oe(U,`${r}.${t}`)},ee=async r=>{const{default:t}=await D(async()=>{const{default:T}=await import("./sRkIUGr0.js").then(U=>U.j);return{default:T}},__vite__mapDeps([0,1,2]),import.meta.url),c=new t,p=n.value.title||"文档标题",g=n.value.companyName||"",s=n.value.date||"",l=n.value.content||"";c.setFontSize(20),c.text(p,105,20,{align:"center"}),c.setFontSize(12),c.text(`公司名称：${g}`,20,40),c.text(`日期：${s}`,20,50),c.setFontSize(14),c.text("内容：",20,70),c.setFontSize(12);const S=c.splitTextToSize(l,170,12);c.text(S,20,80),c.save(`${r}.pdf`)},te=async(r,t)=>{const{default:c}=await D(async()=>{const{default:S}=await import("./DXEQVQnt.js");return{default:S}},[],import.meta.url),p=document.querySelector(".preview-content");if(!p)throw new Error("预览元素未找到");const s=(await c(p,{scale:2,useCORS:!0,logging:!1})).toDataURL(`image/${t}`,.95),l=document.createElement("a");l.href=s,l.download=`${r}.${t}`,document.body.appendChild(l),l.click(),document.body.removeChild(l)},oe=(r,t)=>{const c=URL.createObjectURL(r),p=document.createElement("a");p.href=c,p.download=t,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(c)},se=()=>{ve("/templates")},P=r=>{!r.target.closest(".export-button-container")&&w.value&&(w.value=!1)};return pe(()=>{B.value={...u.value},I(),W(),document.addEventListener("click",P)}),me(()=>{document.removeEventListener("click",P)}),xe({title:L(()=>`${v.value?.name||"模板编辑"} - Office Tools`),meta:[{name:"description",content:"填写信息并自定义格式，一键生成专业文档"}]}),(r,t)=>{const c=he,p=fe,g=_e;return i(),a("div",Se,[j(c),e("div",$e,[j(p),e("main",Ve,[e("div",Fe,[e("div",Ee,[e("div",Me,[e("div",Ne,[e("button",{onClick:se,class:"text-text-secondary hover:text-primary transition-colors"},[...t[4]||(t[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e("h1",Te,d(o(v)?.name||"模板编辑"),1),e("span",Ue,d(o(Ce)(o(v)?.type)),1)]),e("div",je,[e("button",{onClick:Y,disabled:o(_),class:y(["flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-200",o(_)?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-primary to-primary-light text-white hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]"])},[o(_)?(i(),a("svg",De,[...t[5]||(t[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(i(),a("svg",Be,[...t[6]||(t[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])])),e("span",null,d(o(_)?"导出中...":"导出"),1),o(_)?x("",!0):(i(),a("svg",{key:2,class:y(["w-4 h-4 transition-transform duration-200",{"rotate-180":o(w)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[7]||(t[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],10,ze),o(w)?(i(),a("div",Pe,[e("div",Le,[(i(),a(V,null,F(R,s=>e("button",{key:s.value,onClick:l=>Q(s.value),disabled:o(_),class:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors flex items-center gap-3 group"},[e("span",{class:y(["w-8 h-8 rounded-lg flex items-center justify-center",s.bgColor])},[e("span",{class:y(["text-xs font-bold",s.textColor])},d(s.ext),3)],2),e("div",Re,[e("p",Ie,d(s.name),1),e("p",Oe,d(s.desc),1)])],8,He)),64))])])):x("",!0)])]),t[8]||(t[8]=e("p",{class:"text-text-secondary text-sm"},"填写左侧表单信息，右侧实时预览模板效果",-1))]),e("div",Ae,[e("div",qe,[e("div",Ge,[e("div",{class:"flex items-center justify-between mb-4"},[t[9]||(t[9]=e("h2",{class:"text-lg font-bold text-text-primary"},"填写信息",-1)),e("button",{onClick:A,class:"text-sm text-text-secondary hover:text-primary transition-colors"}," 重置 ")]),e("div",We,[(i(!0),a(V,null,F(o(k),s=>(i(),a("div",{key:s.id,class:"space-y-1"},[e("label",{class:y(["text-sm font-medium",s.required?"text-text-primary":"text-text-secondary"])},[ge(d(s.label)+" ",1),s.required?(i(),a("span",Je,"*")):x("",!0)],2),s.type==="text"?h((i(),a("input",{key:0,"onUpdate:modelValue":l=>o(n)[s.id]=l,type:s.inputType||"text",placeholder:s.placeholder,class:y(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(m)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:l=>C(s.id)},null,42,Ke)),[[be,o(n)[s.id]]]):s.type==="select"?h((i(),a("select",{key:1,"onUpdate:modelValue":l=>o(n)[s.id]=l,class:y(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(m)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onChange:l=>C(s.id)},[e("option",Ye,d(s.placeholder),1),(i(!0),a(V,null,F(s.options,l=>(i(),a("option",{key:l,value:l},d(l),9,Qe))),128))],42,Xe)),[[E,o(n)[s.id]]]):s.type==="date"?h((i(),a("input",{key:2,"onUpdate:modelValue":l=>o(n)[s.id]=l,type:"date",class:y(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(m)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:l=>C(s.id)},null,42,Ze)),[[M,o(n)[s.id]]]):s.type==="number"?h((i(),a("input",{key:3,"onUpdate:modelValue":l=>o(n)[s.id]=l,type:"number",placeholder:s.placeholder,class:y(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(m)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:l=>C(s.id)},null,42,et)),[[M,o(n)[s.id],void 0,{number:!0}]]):s.type==="textarea"?h((i(),a("textarea",{key:4,"onUpdate:modelValue":l=>o(n)[s.id]=l,placeholder:s.placeholder,rows:"3",class:y(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",o(m)[s.id]?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:l=>C(s.id)},null,42,tt)),[[M,o(n)[s.id]]]):x("",!0),o(m)[s.id]?(i(),a("p",ot,d(o(m)[s.id]),1)):x("",!0)]))),128))])]),e("div",st,[e("div",{class:"flex items-center justify-between mb-4"},[t[10]||(t[10]=e("h2",{class:"text-lg font-bold text-text-primary"},"格式设置",-1)),e("div",{class:"flex gap-2"},[e("button",{onClick:q,class:"text-sm text-text-secondary hover:text-primary transition-colors"}," 保存 "),e("button",{onClick:G,class:"text-sm text-text-secondary hover:text-primary transition-colors"}," 恢复默认 ")])]),e("div",nt,[e("div",rt,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-text-secondary"},"字体",-1)),h(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o(u).fontFamily=s),class:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"},[...t[11]||(t[11]=[z('<option value="SimSun">宋体</option><option value="SimHei">黑体</option><option value="Microsoft YaHei">微软雅黑</option><option value="KaiTi">楷体</option><option value="FangSong">仿宋</option>',5)])],512),[[E,o(u).fontFamily]])]),e("div",lt,[t[14]||(t[14]=e("label",{class:"text-sm font-medium text-text-secondary"},"字号",-1)),h(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(u).fontSize=s),class:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"},[...t[13]||(t[13]=[z('<option value="12">12pt</option><option value="14">14pt</option><option value="16">16pt</option><option value="18">18pt</option><option value="20">20pt</option><option value="22">22pt</option><option value="24">24pt</option>',7)])],512),[[E,o(u).fontSize]])]),e("div",at,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-text-secondary"},"文字颜色",-1)),e("div",it,[h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o(u).color=s),type:"color",class:"w-10 h-10 border border-gray-200 rounded cursor-pointer"},null,512),[[M,o(u).color]]),e("span",dt,d(o(u).color),1)])]),e("div",ct,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-text-secondary"},"行距",-1)),h(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>o(u).lineHeight=s),class:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"},[...t[16]||(t[16]=[z('<option value="1">1.0</option><option value="1.15">1.15</option><option value="1.5">1.5</option><option value="1.75">1.75</option><option value="2">2.0</option>',5)])],512),[[E,o(u).lineHeight]])])])])]),e("div",ut,[e("div",pt,[e("div",mt,[t[23]||(t[23]=e("h2",{class:"text-lg font-bold text-text-primary"},"模板预览",-1)),e("div",xt,[e("button",{onClick:K,class:"p-2 text-text-secondary hover:text-primary hover:bg-gray-100 rounded-lg transition-colors"},[...t[18]||(t[18]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])]),e("span",yt,d(Math.round(o(f)*100))+"%",1),e("button",{onClick:J,class:"p-2 text-text-secondary hover:text-primary hover:bg-gray-100 rounded-lg transition-colors"},[...t[19]||(t[19]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])]),t[22]||(t[22]=e("div",{class:"w-px h-6 bg-gray-200 mx-2"},null,-1)),e("button",{onClick:X,class:"p-2 text-text-secondary hover:text-primary hover:bg-gray-100 rounded-lg transition-colors"},[o($)?(i(),a("svg",gt,[...t[21]||(t[21]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])):(i(),a("svg",vt,[...t[20]||(t[20]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"},null,-1)])]))])])]),e("div",{ref:"previewContainer",class:y(["p-8 overflow-auto transition-all duration-300 bg-gray-100",o($)?"fixed inset-0 z-50 bg-white":"min-h-[600px]"])},[e("div",{style:ye([{transform:`scale(${o(f)})`,transformOrigin:"top center",fontFamily:o(u).fontFamily,fontSize:`${o(u).fontSize}pt`,color:o(u).color,lineHeight:o(u).lineHeight},{width:"210mm","min-height":"297mm",padding:"25.4mm"}]),class:"transition-all duration-200 preview-content mx-auto bg-white shadow-lg"},[o(v)?.type==="word"?(i(),a("div",bt,[e("h1",ht,d(o(n).title||"文档标题"),1),e("div",ft,[o(n).companyName?(i(),a("div",_t,[t[24]||(t[24]=e("span",{class:"font-medium w-24"},"公司名称：",-1)),e("span",null,d(o(n).companyName),1)])):x("",!0),o(n).date?(i(),a("div",wt,[t[25]||(t[25]=e("span",{class:"font-medium w-24"},"日期：",-1)),e("span",null,d(o(n).date),1)])):x("",!0),o(n).content?(i(),a("div",kt,[t[26]||(t[26]=e("span",{class:"font-medium"},"内容：",-1)),e("p",Ct,d(o(n).content),1)])):x("",!0)])])):o(v)?.type==="excel"?(i(),a("div",St,[e("h1",$t,d(o(n).title||"表格标题"),1),e("table",Vt,[t[27]||(t[27]=e("thead",null,[e("tr",{class:"bg-gray-50"},[e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"项目"),e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"数量"),e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"金额"),e("th",{class:"border border-gray-300 px-4 py-2 text-left"},"备注")])],-1)),e("tbody",null,[(i(),a(V,null,F(5,s=>e("tr",{key:s},[e("td",Ft,d(o(n)[`item${s}`]||`项目 ${s}`),1),e("td",Et,d(o(n)[`quantity${s}`]||"-"),1),e("td",Mt,d(o(n)[`amount${s}`]||"-"),1),e("td",Nt,d(o(n)[`note${s}`]||"-"),1)])),64))])])])):o(v)?.type==="ppt"?(i(),a("div",Tt,[e("h1",Ut,d(o(n).title||"演示文稿标题"),1),e("div",jt,[o(n).subtitle?(i(),a("div",zt,d(o(n).subtitle),1)):x("",!0),o(n).content?(i(),a("div",Dt,d(o(n).content),1)):x("",!0),o(n).presenter?(i(),a("div",Bt," 演讲者："+d(o(n).presenter),1)):x("",!0)])])):(i(),a("div",Pt," 请填写左侧表单以生成预览 "))],4)],2)])])])])]),j(g)])])}}};export{At as default};
