import{j as a,w as e,o as s,a as l,b as t,c as i,q as r,s as c,C as o,l as n,B as u,t as d,F as v,p,z as f,d as m,r as h}from"./CbGhm0ms.js";import{_ as x}from"./Pqfqo65y.js";import{G as b}from"./CmrO9Qsr.js";import{_ as w}from"./BCo6x5W8.js";import"./BE6raXpT.js";import"./Cx5n45vH.js";import"./CpN0-MvT.js";import"./D0kt2dsR.js";const y={class:"archive-extract"},g={class:"upload-section"},k={key:0,class:"options-section"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},z={class:"form-group"},j={class:"form-group"},C={class:"form-group col-span-1 md:col-span-2"},_={class:"flex items-center space-x-2"},F={key:1,class:"process-section"},R=["disabled"],S={key:0},U={key:1},A={key:2,class:"progress-section"},I={class:"progress-bar"},N={class:"text-sm text-gray-500 mt-1"},V={key:3,class:"result-section"},Z={class:"result-info"},B={class:"result-item"},E={class:"value"},T={class:"result-item"},$={class:"value"},q={class:"result-item"},D={class:"value"},G={class:"result-item"},M={class:"value"},O={class:"file-list-section"},Y={class:"file-list"},H={class:"file-icon"},J={class:"file-info"},K={class:"file-name"},L={class:"file-size"},Q={class:"file-actions"},W=["onClick"],X={key:4,class:"error-section"},aa={class:"error-message"},ea=w({__name:"index",setup(w){const ea=h(null),sa=h(!1),la=h(0),ta=h(""),ia=h(null),ra=h(""),ca=h({password:"",extractPath:"",overwrite:!1}),oa=a=>{ea.value=a,ra.value="",ia.value=null},na=()=>{ea.value=null,ra.value="",ia.value=null},ua=async()=>{if(ea.value){sa.value=!0,la.value=0,ta.value="准备解压...",ra.value="",ia.value=null;try{const a=new FormData;a.append("files",ea.value),a.append("password",ca.value.password),a.append("extractPath",ca.value.extractPath),a.append("overwrite",ca.value.overwrite);const e=await fetch("/api/archive/extract",{method:"POST",body:a});if(!e.ok)throw new Error("API请求失败");const s=await e.json();if(!s.success)throw new Error(s.message||"解压失败");{const a=s.data[0];ia.value={archiveName:a.archiveName,extractPath:a.extractPath,fileCount:a.fileCount,extractedSize:a.extractedSize,files:a.files}}}catch(a){ra.value=a.message||"解压失败，请重试"}finally{sa.value=!1}}else ra.value="请先上传压缩包"},da=()=>{alert("开始下载全部文件")},va=a=>{const e={pdf:"fa-file-pdf",image:"fa-file-image",csv:"fa-file-csv",text:"fa-file-alt",default:"fa-file"};return e[a]||e.default};return(h,w)=>(s(),a(x,{title:"文件解压",description:"解压各种格式的压缩包文件"},{default:e(()=>[l("div",y,[l("div",g,[w[3]||(w[3]=l("h3",null,"上传压缩包",-1)),t(b,{accept:".zip,.rar,.7z,.tar,.gz,.bz2,.xz,.iso",multiple:!1,onFileUploaded:oa,onFileRemoved:na}),w[4]||(w[4]=l("p",{class:"text-sm text-gray-500 mt-2"},"支持ZIP、RAR、7Z、TAR等多种压缩格式，单个文件大小不超过100MB",-1))]),ea.value?(s(),i("div",k,[w[8]||(w[8]=l("h3",null,"解压选项",-1)),l("div",P,[l("div",z,[w[5]||(w[5]=l("label",{for:"password"},"解压密码",-1)),r(l("input",{id:"password",type:"password","onUpdate:modelValue":w[0]||(w[0]=a=>ca.value.password=a),class:"form-input",placeholder:"如果压缩包有密码，请输入"},null,512),[[c,ca.value.password]])]),l("div",j,[w[6]||(w[6]=l("label",{for:"extractPath"},"解压路径",-1)),r(l("input",{id:"extractPath",type:"text","onUpdate:modelValue":w[1]||(w[1]=a=>ca.value.extractPath=a),class:"form-input",placeholder:"默认为当前目录"},null,512),[[c,ca.value.extractPath]])]),l("div",C,[l("label",_,[r(l("input",{type:"checkbox","onUpdate:modelValue":w[2]||(w[2]=a=>ca.value.overwrite=a),class:"form-checkbox"},null,512),[[o,ca.value.overwrite]]),w[7]||(w[7]=l("span",null,"覆盖已存在的文件",-1))])])])])):n("",!0),ea.value?(s(),i("div",F,[l("button",{class:"btn btn-primary",onClick:ua,disabled:sa.value},[sa.value?(s(),i("span",U,"解压中...")):(s(),i("span",S,"开始解压"))],8,R)])):n("",!0),sa.value?(s(),i("div",A,[l("div",I,[l("div",{class:"progress-fill",style:u({width:la.value+"%"})},null,4)]),l("p",N,d(ta.value),1)])):n("",!0),ia.value?(s(),i("div",V,[w[16]||(w[16]=l("h3",null,"解压结果",-1)),l("div",Z,[l("div",B,[w[9]||(w[9]=l("span",{class:"label"},"压缩包名称:",-1)),l("span",E,d(ia.value.archiveName),1)]),l("div",T,[w[10]||(w[10]=l("span",{class:"label"},"解压路径:",-1)),l("span",$,d(ia.value.extractPath),1)]),l("div",q,[w[11]||(w[11]=l("span",{class:"label"},"文件数量:",-1)),l("span",D,d(ia.value.fileCount),1)]),l("div",G,[w[12]||(w[12]=l("span",{class:"label"},"解压大小:",-1)),l("span",M,d(ia.value.extractedSize),1)]),l("div",O,[w[14]||(w[14]=l("h4",null,"解压文件列表",-1)),l("div",Y,[(s(!0),i(v,null,p(ia.value.files,(a,e)=>(s(),i("div",{key:e,class:"file-item"},[l("div",H,[l("i",{class:f(["fas",va(a.type)])},null,2)]),l("div",J,[l("div",K,d(a.name),1),l("div",L,d(a.size),1)]),l("div",Q,[l("button",{class:"btn btn-sm btn-secondary",onClick:e=>{return s=a.path,void alert(`开始下载文件: ${s}`);var s}},[...w[13]||(w[13]=[l("i",{class:"fas fa-download"},null,-1)])],8,W)])]))),128))])]),l("button",{class:"btn btn-secondary mt-4",onClick:da},[...w[15]||(w[15]=[l("i",{class:"fas fa-download mr-2"},null,-1),m("下载全部文件 ",-1)])])])])):n("",!0),ra.value?(s(),i("div",X,[l("div",aa,[w[17]||(w[17]=l("i",{class:"fas fa-exclamation-circle text-red-500 mr-2"},null,-1)),m(" "+d(ra.value),1)])])):n("",!0)])]),_:1}))}},[["__scopeId","data-v-d14ed3a7"]]);export{ea as default};
