const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./-O-YzalQ.js","./Cyl4WCzq.js","./entry.Df9dSrAs.css"])))=>i.map(i=>d[i]);
import{m as xe,z as ve,e as fe,u as ye,c as p,b as E,a as t,q as v,j as h,d as y,v as b,h as s,n as c,t as u,x as W,F as Y,g as G,A as be,i as D,l as he,_ as j,o as m,k as X}from"./Cyl4WCzq.js";import{_ as we,a as De,b as _e}from"./D9JWhQ1s.js";import"./D_fA1zd6.js";const B={id:"leave-request",name:"请假条",type:"word",category:"hr",version:"1.0.0",description:"专业的企业员工请假条模板，符合行政规范",documentStructure:{title:"请假条",sections:[{id:"basic-info",name:"员工基本信息",order:1,fields:["employeeName","department","employeeId"]},{id:"leave-type",name:"请假类型",order:2,fields:["leaveType","leaveSubtype"]},{id:"leave-time",name:"请假时间",order:3,fields:["startDate","endDate","totalDays"]},{id:"leave-reason",name:"请假事由",order:4,fields:["leaveReason"]},{id:"department-approval",name:"部门负责人审批意见",order:5,fields:["departmentOpinion","departmentSignature","departmentDate"]},{id:"hr-approval",name:"人力资源部审核意见",order:6,fields:["hrOpinion","hrSignature","hrDate"]}]},formFields:{employeeName:{id:"employeeName",label:"姓名",type:"text",required:!0,placeholder:"请输入员工姓名",maxLength:50,validation:{pattern:/^[\u4e00-\u9fa5a-zA-Z\s]{2,50}$/,message:"请输入有效的姓名"}},department:{id:"department",label:"部门",type:"select",required:!0,placeholder:"请选择部门",options:["人事部","财务部","市场部","技术部","运营部","行政部","销售部","客服部"],validation:{required:!0,message:"请选择部门"}},employeeId:{id:"employeeId",label:"工号",type:"text",required:!0,placeholder:"请输入工号",maxLength:20,validation:{pattern:/^[A-Za-z0-9]{4,20}$/,message:"请输入有效的工号"}},leaveType:{id:"leaveType",label:"请假类型",type:"select",required:!0,placeholder:"请选择请假类型",options:[{value:"sick",label:"病假",requiresProof:!0},{value:"personal",label:"事假",requiresProof:!1},{value:"annual",label:"年假",requiresProof:!1},{value:"marriage",label:"婚假",requiresProof:!0},{value:"maternity",label:"产假",requiresProof:!0},{value:"bereavement",label:"丧假",requiresProof:!0},{value:"injury",label:"工伤假",requiresProof:!0},{value:"other",label:"其他",requiresProof:!1}],validation:{required:!0,message:"请选择请假类型"}},leaveSubtype:{id:"leaveSubtype",label:"请假事由",type:"text",required:!0,placeholder:"请输入具体事由",maxLength:200,dependsOn:"leaveType",showWhen:["personal","other"],validation:{required:!0,message:"请输入请假事由"}},startDate:{id:"startDate",label:"起始日期",type:"date",required:!0,placeholder:"请选择起始日期",validation:{required:!0,message:"请选择起始日期",minDate:"today",maxDate:"endOfYear"}},endDate:{id:"endDate",label:"结束日期",type:"date",required:!0,placeholder:"请选择结束日期",validation:{required:!0,message:"请选择结束日期",minDate:"startDate",maxDate:"endOfYear"}},totalDays:{id:"totalDays",label:"请假天数",type:"number",required:!0,placeholder:"自动计算",readOnly:!0,validation:{required:!0,min:.5,max:365,message:"请假天数必须在0.5-365之间"}},leaveReason:{id:"leaveReason",label:"请假事由详细说明",type:"textarea",required:!0,placeholder:"请详细说明请假原因（至少20字）",minLength:20,maxLength:500,rows:4,validation:{required:!0,minLength:20,message:"请假事由至少需要20个字符"}},departmentOpinion:{id:"departmentOpinion",label:"部门负责人审批意见",type:"textarea",required:!1,placeholder:"请输入审批意见（可选）",maxLength:200,rows:2,role:"department-manager"},departmentSignature:{id:"departmentSignature",label:"部门负责人签名",type:"signature",required:!1,placeholder:"请签名",role:"department-manager"},departmentDate:{id:"departmentDate",label:"审批日期",type:"date",required:!1,placeholder:"请选择审批日期",role:"department-manager"},hrOpinion:{id:"hrOpinion",label:"人力资源部审核意见",type:"textarea",required:!1,placeholder:"请输入审核意见（可选）",maxLength:200,rows:2,role:"hr-manager"},hrSignature:{id:"hrSignature",label:"人力资源部签名",type:"signature",required:!1,placeholder:"请签名",role:"hr-manager"},hrDate:{id:"hrDate",label:"审核日期",type:"date",required:!1,placeholder:"请选择审核日期",role:"hr-manager"}},validationRules:{calculateDays:(g,a)=>{if(!g||!a)return 0;const o=new Date(g),w=new Date(a).getTime()-o.getTime(),f=Math.ceil(w/(1e3*60*60*24));return Math.max(.5,f)},validateDateRange:(g,a)=>{if(!g||!a)return{valid:!0,message:""};const o=new Date(g),x=new Date(a);return x<o?{valid:!1,message:"结束日期不能早于起始日期"}:Math.ceil((x.getTime()-o.getTime())/(1e3*60*60*24))>365?{valid:!1,message:"请假天数不能超过365天"}:{valid:!0,message:""}},validateRequired:(g,a)=>!g||g.toString().trim()===""?{valid:!1,message:`${a}为必填项`}:{valid:!0,message:""},validatePattern:(g,a,o)=>a.test(g)?{valid:!0,message:""}:{valid:!1,message:`${o}格式不正确`},validateLength:(g,a,o,x)=>{const w=g.toString().length;return a&&w<a?{valid:!1,message:`${x}至少需要${a}个字符`}:o&&w>o?{valid:!1,message:`${x}不能超过${o}个字符`}:{valid:!0,message:""}}},workflow:{steps:[{id:"submit",name:"提交申请",description:"员工填写请假信息并提交",action:"submit",role:"employee"},{id:"department-review",name:"部门审批",description:"部门负责人审核请假申请",action:"approve",role:"department-manager",requiredFields:["departmentOpinion","departmentSignature","departmentDate"]},{id:"hr-review",name:"人力资源审核",description:"人力资源部最终审核",action:"approve",role:"hr-manager",requiredFields:["hrOpinion","hrSignature","hrDate"]},{id:"export",name:"导出文档",description:"生成并下载请假条Word文档",action:"export",role:"system"}],statusTransitions:{pending:"待审批",departmentApproved:"部门已审批",departmentRejected:"部门已驳回",hrApproved:"人力资源已审核",hrRejected:"人力资源已驳回",completed:"已完成"}},documentTemplate:{pageSize:"A4",margins:{top:2.54,right:2.54,bottom:2.54,left:2.54},styles:{title:{fontSize:22,bold:!0,alignment:"center",spacingAfter:400},sectionTitle:{fontSize:16,bold:!0,spacingBefore:400,spacingAfter:200},fieldLabel:{fontSize:12,bold:!0,spacingAfter:100},fieldValue:{fontSize:12,spacingAfter:200},signature:{fontSize:12,alignment:"right",spacingBefore:400}}}},J=()=>B,ke=()=>B.formFields.leaveType.options,Se=()=>B.formFields.department.options,Ce={class:"min-h-screen bg-background"},Te={class:"flex pt-nav-height"},qe={class:"flex-1 lg:ml-sidebar-left overflow-y-auto"},Oe={class:"max-w-6xl mx-auto px-4 py-6"},Re={class:"flex flex-col lg:flex-row gap-6"},$e={class:"w-full lg:w-1/2 space-y-6"},Ie={class:"bg-white rounded-xl shadow-sm p-6"},Le={class:"space-y-4"},Ee={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},je={class:"space-y-1"},Be={key:0,class:"text-xs text-red-500 mt-1"},Me={class:"space-y-1"},Ne=["value"],Ve={key:0,class:"text-xs text-red-500 mt-1"},Pe={class:"space-y-1"},ze={key:0,class:"text-xs text-red-500 mt-1"},Ae={class:"bg-white rounded-xl shadow-sm p-6"},Fe={class:"space-y-4"},Ue={class:"space-y-1"},He=["value"],We={key:0,class:"text-xs text-red-500 mt-1"},Ye={key:0,class:"space-y-1"},Ge={key:0,class:"text-xs text-red-500 mt-1"},Xe={class:"bg-white rounded-xl shadow-sm p-6"},Je={class:"space-y-4"},Ze={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ke={class:"space-y-1"},Qe=["min","max"],et={key:0,class:"text-xs text-red-500 mt-1"},tt={class:"space-y-1"},st=["min","max"],at={key:0,class:"text-xs text-red-500 mt-1"},rt={class:"space-y-1"},nt={key:0,class:"text-xs text-red-500 mt-1"},ot={class:"bg-white rounded-xl shadow-sm p-6"},lt={class:"space-y-4"},it={class:"space-y-1"},dt={class:"flex justify-between mt-1"},ut={class:"text-xs text-text-secondary"},pt={key:0,class:"text-xs text-red-500 mt-1"},mt={class:"bg-white rounded-xl shadow-sm p-6"},ct={class:"space-y-4"},gt={class:"space-y-1"},xt={class:"flex justify-between mt-1"},vt={class:"text-xs text-text-secondary"},ft={class:"space-y-1"},yt={class:"border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50 relative"},bt={class:"space-y-1"},ht={class:"bg-white rounded-xl shadow-sm p-6"},wt={class:"space-y-4"},Dt={class:"space-y-1"},_t={class:"flex justify-between mt-1"},kt={class:"text-xs text-text-secondary"},St={class:"space-y-1"},Ct={class:"border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50 relative"},Tt={class:"space-y-1"},qt={class:"flex gap-3 pt-4"},Ot=["disabled"],Rt={key:0,class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},$t={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},It={class:"w-full lg:w-1/2"},Lt={class:"bg-white rounded-xl shadow-sm p-6 sticky top-6"},Et={class:"flex items-center justify-between mb-4"},jt={class:"flex items-center gap-2"},Bt=["disabled"],Mt={class:"text-sm text-text-secondary min-w-[50px] text-center"},Nt=["disabled"],Vt={class:"space-y-4"},Pt={class:"flex"},zt={class:"text-gray-700"},At={class:"flex"},Ft={class:"text-gray-700"},Ut={class:"flex"},Ht={class:"text-gray-700"},Wt={class:"flex"},Yt={class:"text-gray-700"},Gt={class:"flex"},Xt={class:"text-gray-700"},Jt={class:"mt-6"},Zt={class:"text-gray-700 leading-relaxed whitespace-pre-wrap"},Kt={class:"border-t-2 border-gray-900 mt-6 pt-6"},Qt={class:"text-gray-700 leading-relaxed whitespace-pre-wrap mb-3"},es={class:"flex"},ts={class:"text-gray-700"},ss={class:"border-t-2 border-gray-900 mt-6 pt-6"},as={class:"text-gray-700 leading-relaxed whitespace-pre-wrap mb-3"},rs={class:"flex"},ns={class:"text-gray-700"},os={class:"mt-4 flex gap-2"},ls=["disabled"],is=["disabled"],ms={__name:"leave-request",setup(g){xe(),ve();const a=D({employeeName:"",department:"",employeeId:"",leaveType:"",leaveSubtype:"",startDate:"",endDate:"",totalDays:0,leaveReason:"",departmentOpinion:"",departmentDate:"",hrOpinion:"",hrDate:""}),o=D({}),x=D(!1),w=D(!1),f=D(1),O=D(!1),S=D(!1),Z=Se(),C=ke(),M=X(()=>{const n=new Date;return n.setHours(0,0,0,0),n.toISOString().split("T")[0]}),N=X(()=>new Date(new Date().getFullYear(),11,31).toISOString().split("T")[0]),K=()=>{const n=C.find(e=>e.value===a.value.leaveType);w.value=n?.requiresProof||!1,w.value||(a.value.leaveSubtype="")},R=()=>{if(a.value.startDate&&a.value.endDate){const n=new Date(a.value.startDate),e=new Date(a.value.endDate);if(e<n){o.value.endDate="结束日期不能早于起始日期",a.value.totalDays=0;return}delete o.value.endDate;const i=e.getTime()-n.getTime(),l=Math.ceil(i/(1e3*60*60*24));if(l>365){o.value.totalDays="请假天数不能超过365天",a.value.totalDays=0;return}delete o.value.totalDays,a.value.totalDays=Math.max(.5,l)}},_=n=>{const i=J().formFields[n];if(!i)return;const l=a.value[n];if(i.required&&!l?.trim()){o.value[n]=i.validation.message;return}if(i.validation.pattern&&!new RegExp(i.validation.pattern).test(l)){o.value[n]=i.validation.message;return}if(i.validation.minLength&&l.length<i.validation.minLength){o.value[n]=`至少需要${i.validation.minLength}个字符`;return}if(i.validation.maxLength&&l.length>i.validation.maxLength){o.value[n]=`不能超过${i.validation.maxLength}个字符`;return}delete o.value[n]},V=()=>{const n=J();let e=!0;return Object.keys(n.formFields).forEach(i=>{const l=n.formFields[i];l.required&&!a.value[i]?.trim()&&(o.value[i]=l.validation.message,e=!1)}),e},P=n=>{const e=n==="department"?document.getElementById("departmentSignatureCanvas"):document.getElementById("hrSignatureCanvas");if(!e)return;const i=e.getContext("2d"),l=e.getBoundingClientRect(),d=event.clientX-l.left,r=event.clientY-l.top;i.beginPath(),i.moveTo(d,r),e.isDrawing=!0,e.lastX=d,e.lastY=r},z=n=>{const e=n==="department"?document.getElementById("departmentSignatureCanvas"):document.getElementById("hrSignatureCanvas");if(!e||!e.isDrawing)return;const i=e.getContext("2d"),l=e.getBoundingClientRect(),d=event.clientX-l.left,r=event.clientY-l.top;i.lineWidth=2,i.lineCap="round",i.strokeStyle="#000000",i.lineTo(d,r),i.stroke(),e.lastX=d,e.lastY=r},T=n=>{const e=n==="department"?document.getElementById("departmentSignatureCanvas"):document.getElementById("hrSignatureCanvas");e&&(e.isDrawing=!1)},A=n=>{const e=n==="department"?document.getElementById("departmentSignatureCanvas"):document.getElementById("hrSignatureCanvas");if(!e)return;e.getContext("2d").clearRect(0,0,e.width,e.height)},Q=()=>{localStorage.setItem("leaveRequestDraft",JSON.stringify(a.value)),alert("草稿已保存")},ee=()=>{{const n=localStorage.getItem("leaveRequestDraft");if(n)try{a.value=JSON.parse(n),R()}catch(e){console.error("Failed to load draft:",e)}}},te=async()=>{if(V()){x.value=!0;try{const n=`请假条_${a.value.employeeName}_${new Date().getTime()}`;await F(n),localStorage.removeItem("leaveRequestDraft"),console.log("请假条已生成并下载")}catch(n){console.error("Export failed:",n),alert("导出失败，请重试")}finally{x.value=!1}}},F=async n=>{const{Document:e,Packer:i,Paragraph:l,TextRun:d,HeadingLevel:r,AlignmentType:q,BorderStyle:$,TableWidthType:H}=await j(async()=>{const{Document:L,Packer:ie,Paragraph:de,TextRun:ue,HeadingLevel:pe,AlignmentType:me,BorderStyle:ce,TableWidthType:ge}=await import("./xLdiIeLa.js");return{Document:L,Packer:ie,Paragraph:de,TextRun:ue,HeadingLevel:pe,AlignmentType:me,BorderStyle:ce,TableWidthType:ge}},[],import.meta.url),k=new e({sections:[{properties:{},children:[new l({text:"请假条",heading:r.HEADING_1,alignment:q.CENTER,spacing:{after:400}}),new l({text:"",border:{bottom:{color:"000000",space:1,value:"single",size:6}}}),new l({children:[new d({text:"姓名：",bold:!0}),new d({text:a.value.employeeName||""})],spacing:{after:200}}),new l({children:[new d({text:"部门：",bold:!0}),new d({text:a.value.department||""})],spacing:{after:200}}),new l({children:[new d({text:"工号：",bold:!0}),new d({text:a.value.employeeId||""})],spacing:{after:200}}),new l({children:[new d({text:"请假类型：",bold:!0}),new d({text:C.find(L=>L.value===a.value.leaveType)?.label||""})],spacing:{after:200}}),new l({children:[new d({text:"请假天数：",bold:!0}),new d({text:a.value.totalDays?`${a.value.totalDays} 天`:""})],spacing:{after:200}}),new l({text:"请假事由：",heading:r.HEADING_2,spacing:{before:400,after:200}}),new l({text:a.value.leaveReason||"",spacing:{after:400}}),new l({text:"",border:{bottom:{color:"000000",space:1,value:"single",size:6}}}),new l({text:"部门负责人审批意见",heading:r.HEADING_2,spacing:{before:400,after:200}}),new l({text:a.value.departmentOpinion||"无",spacing:{after:200}}),new l({children:[new d({text:"审批日期：",bold:!0}),new d({text:a.value.departmentDate||"无"})],spacing:{after:200}}),new l({text:"",border:{bottom:{color:"000000",space:1,value:"single",size:6}}}),new l({text:"人力资源部审核意见",heading:r.HEADING_2,spacing:{before:400,after:200}}),new l({text:a.value.hrOpinion||"无",spacing:{after:200}}),new l({children:[new d({text:"审核日期：",bold:!0}),new d({text:a.value.hrDate||"无"})],spacing:{after:200}})]}]}),I=await i.toBlob(k);se(I,`${n}.docx`)},se=(n,e)=>{const i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)},ae=()=>{he("/templates")},re=()=>{f.value<1.5&&(f.value=Math.min(1.5,f.value+.1))},ne=()=>{f.value>.5&&(f.value=Math.max(.5,f.value-.1))},oe=()=>{O.value=!O.value},U=async n=>{if(!V()){alert("请先填写所有必填项");return}S.value=!0;try{const e=`请假条_${a.value.employeeName}_${new Date().getTime()}`;n==="docx"?await F(e):n==="pdf"&&await le(e),console.log("文件已下载:",e)}catch(e){console.error("Export failed:",e),alert("导出失败，请重试")}finally{S.value=!1}},le=async n=>{const{default:e}=await j(async()=>{const{default:k}=await import("./-O-YzalQ.js").then(I=>I.j);return{default:k}},__vite__mapDeps([0,1,2]),import.meta.url),{default:i}=await j(async()=>{const{default:k}=await import("./DXEQVQnt.js");return{default:k}},[],import.meta.url),l=document.querySelector(".preview-content");if(!l)throw new Error("Preview content not found");const d=await i(l,{scale:2,useCORS:!0,logging:!1}),r=d.toDataURL("image/png"),q=new e("p","mm","a4"),$=210,H=d.height*$/d.width;q.addImage(r,"PNG",0,0,$,H),q.save(`${n}.pdf`)};return fe(()=>{ee();{const n=document.getElementById("departmentSignatureCanvas"),e=document.getElementById("hrSignatureCanvas");n&&(n.width=n.offsetWidth,n.height=80),e&&(e.width=e.offsetWidth,e.height=80)}}),ye({title:"请假条 - Office Tools",meta:[{name:"description",content:"填写请假信息，生成专业的请假条Word文档"}]}),(n,e)=>{const i=we,l=De,d=_e;return m(),p("div",Ce,[E(i),t("div",Te,[E(l),t("main",qe,[t("div",Oe,[t("div",{class:"mb-6"},[t("div",{class:"flex items-center gap-2 mb-2"},[t("button",{onClick:ae,class:"text-text-secondary hover:text-primary transition-colors"},[...e[30]||(e[30]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e[31]||(e[31]=t("h1",{class:"text-2xl font-bold text-text-primary"},"请假条",-1)),e[32]||(e[32]=t("span",{class:"px-3 py-1 bg-primary/10 text-primary text-sm rounded-full"},"HR模板",-1))]),e[33]||(e[33]=t("p",{class:"text-text-secondary text-sm"},"填写请假信息，生成专业的请假条Word文档",-1))]),t("div",Re,[t("div",$e,[t("div",Ie,[e[38]||(e[38]=t("div",{class:"flex items-center justify-between mb-6"},[t("h2",{class:"text-lg font-bold text-text-primary"},"员工基本信息")],-1)),t("div",Le,[t("div",Ee,[t("div",je,[e[34]||(e[34]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 姓名 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s(a).employeeName=r),type:"text",placeholder:"请输入员工姓名",maxlength:"50",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",s(o).employeeName?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:e[1]||(e[1]=r=>_("employeeName"))},null,34),[[b,s(a).employeeName]]),s(o).employeeName?(m(),p("p",Be,u(s(o).employeeName),1)):h("",!0)]),t("div",Me,[e[36]||(e[36]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 部门 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>s(a).department=r),class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",s(o).department?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onChange:e[3]||(e[3]=r=>_("department"))},[e[35]||(e[35]=t("option",{value:""},"请选择部门",-1)),(m(!0),p(Y,null,G(s(Z),r=>(m(),p("option",{key:r,value:r},u(r),9,Ne))),128))],34),[[W,s(a).department]]),s(o).department?(m(),p("p",Ve,u(s(o).department),1)):h("",!0)]),t("div",Pe,[e[37]||(e[37]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 工号 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("input",{"onUpdate:modelValue":e[4]||(e[4]=r=>s(a).employeeId=r),type:"text",placeholder:"请输入工号",maxlength:"20",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",s(o).employeeId?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:e[5]||(e[5]=r=>_("employeeId"))},null,34),[[b,s(a).employeeId]]),s(o).employeeId?(m(),p("p",ze,u(s(o).employeeId),1)):h("",!0)])])])]),t("div",Ae,[e[42]||(e[42]=t("div",{class:"flex items-center justify-between mb-6"},[t("h2",{class:"text-lg font-bold text-text-primary"},"请假类型")],-1)),t("div",Fe,[t("div",Ue,[e[40]||(e[40]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 请假类型 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("select",{"onUpdate:modelValue":e[6]||(e[6]=r=>s(a).leaveType=r),onChange:K,class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",s(o).leaveType?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"])},[e[39]||(e[39]=t("option",{value:""},"请选择请假类型",-1)),(m(!0),p(Y,null,G(s(C),r=>(m(),p("option",{key:r.value,value:r.value},u(r.label),9,He))),128))],34),[[W,s(a).leaveType]]),s(o).leaveType?(m(),p("p",We,u(s(o).leaveType),1)):h("",!0)]),s(w)?(m(),p("div",Ye,[e[41]||(e[41]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 请假事由 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("input",{"onUpdate:modelValue":e[7]||(e[7]=r=>s(a).leaveSubtype=r),type:"text",placeholder:"请输入具体事由",maxlength:"200",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",s(o).leaveSubtype?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:e[8]||(e[8]=r=>_("leaveSubtype"))},null,34),[[b,s(a).leaveSubtype]]),s(o).leaveSubtype?(m(),p("p",Ge,u(s(o).leaveSubtype),1)):h("",!0)])):h("",!0)])]),t("div",Xe,[e[46]||(e[46]=t("div",{class:"flex items-center justify-between mb-6"},[t("h2",{class:"text-lg font-bold text-text-primary"},"请假时间")],-1)),t("div",Je,[t("div",Ze,[t("div",Ke,[e[43]||(e[43]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 起始日期 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("input",{"onUpdate:modelValue":e[9]||(e[9]=r=>s(a).startDate=r),type:"date",min:s(M),max:s(N),class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",s(o).startDate?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:R},null,42,Qe),[[b,s(a).startDate]]),s(o).startDate?(m(),p("p",et,u(s(o).startDate),1)):h("",!0)]),t("div",tt,[e[44]||(e[44]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 结束日期 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("input",{"onUpdate:modelValue":e[10]||(e[10]=r=>s(a).endDate=r),type:"date",min:s(a).startDate||s(M),max:s(N),class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all",s(o).endDate?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:R},null,42,st),[[b,s(a).endDate]]),s(o).endDate?(m(),p("p",at,u(s(o).endDate),1)):h("",!0)]),t("div",rt,[e[45]||(e[45]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 请假天数 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("input",{"onUpdate:modelValue":e[11]||(e[11]=r=>s(a).totalDays=r),type:"number",step:"0.5",min:"0.5",max:"365",readonly:"",placeholder:"自动计算",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all bg-gray-50 cursor-not-allowed",s(o).totalDays?"border-red-300 focus:ring-red-100":"border-gray-200"])},null,2),[[b,s(a).totalDays]]),s(o).totalDays?(m(),p("p",nt,u(s(o).totalDays),1)):h("",!0)])])])]),t("div",ot,[e[49]||(e[49]=t("div",{class:"flex items-center justify-between mb-6"},[t("h2",{class:"text-lg font-bold text-text-primary"},"请假事由详细说明")],-1)),t("div",lt,[t("div",it,[e[48]||(e[48]=t("label",{class:"text-sm font-medium text-text-primary"},[y(" 请假事由详细说明 "),t("span",{class:"text-red-500"},"*")],-1)),v(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=r=>s(a).leaveReason=r),placeholder:"请详细说明请假原因（至少20字）",rows:"4",minlength:"20",maxlength:"500",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all resize-none",s(o).leaveReason?"border-red-300 focus:ring-red-100":"border-gray-200 focus:ring-primary/20 focus:border-primary"]),onInput:e[13]||(e[13]=r=>_("leaveReason"))},null,34),[[b,s(a).leaveReason]]),t("div",dt,[t("span",ut,"已输入："+u(s(a).leaveReason?.length||0)+"/20",1),e[47]||(e[47]=t("span",{class:"text-xs text-text-secondary"},"最小20，最大500",-1))]),s(o).leaveReason?(m(),p("p",pt,u(s(o).leaveReason),1)):h("",!0)])])]),t("div",mt,[e[53]||(e[53]=t("div",{class:"flex items-center justify-between mb-6"},[t("h2",{class:"text-lg font-bold text-text-primary"},"部门负责人审批意见")],-1)),t("div",ct,[t("div",gt,[e[50]||(e[50]=t("label",{class:"text-sm font-medium text-text-secondary"}," 审批意见（可选） ",-1)),v(t("textarea",{"onUpdate:modelValue":e[14]||(e[14]=r=>s(a).departmentOpinion=r),placeholder:"请输入审批意见（可选）",rows:"2",maxlength:"200",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all resize-none","border-gray-200 focus:ring-primary/20 focus:border-primary"])},null,512),[[b,s(a).departmentOpinion]]),t("div",xt,[t("span",vt,"已输入："+u(s(a).departmentOpinion?.length||0)+"/200",1)])]),t("div",ft,[e[51]||(e[51]=t("label",{class:"text-sm font-medium text-text-secondary"}," 签名（可选） ",-1)),t("div",yt,[t("canvas",{ref:"departmentSignatureCanvas",id:"departmentSignatureCanvas",class:"w-full h-20 cursor-crosshair",onMousedown:e[15]||(e[15]=r=>P("department")),onMousemove:e[16]||(e[16]=r=>z("department")),onMouseup:e[17]||(e[17]=r=>T("department")),onMouseleave:e[18]||(e[18]=r=>T("department"))},null,544),t("button",{onClick:e[19]||(e[19]=r=>A("department")),class:"absolute top-2 right-2 text-xs text-text-secondary hover:text-primary"}," 清除 ")])]),t("div",bt,[e[52]||(e[52]=t("label",{class:"text-sm font-medium text-text-secondary"}," 审批日期（可选） ",-1)),v(t("input",{"onUpdate:modelValue":e[20]||(e[20]=r=>s(a).departmentDate=r),type:"date",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all","border-gray-200 focus:ring-primary/20 focus:border-primary"])},null,512),[[b,s(a).departmentDate]])])])]),t("div",ht,[e[57]||(e[57]=t("div",{class:"flex items-center justify-between mb-6"},[t("h2",{class:"text-lg font-bold text-text-primary"},"人力资源部审核意见")],-1)),t("div",wt,[t("div",Dt,[e[54]||(e[54]=t("label",{class:"text-sm font-medium text-text-secondary"}," 审核意见（可选） ",-1)),v(t("textarea",{"onUpdate:modelValue":e[21]||(e[21]=r=>s(a).hrOpinion=r),placeholder:"请输入审核意见（可选）",rows:"2",maxlength:"200",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all resize-none","border-gray-200 focus:ring-primary/20 focus:border-primary"])},null,512),[[b,s(a).hrOpinion]]),t("div",_t,[t("span",kt,"已输入："+u(s(a).hrOpinion?.length||0)+"/200",1)])]),t("div",St,[e[55]||(e[55]=t("label",{class:"text-sm font-medium text-text-secondary"}," 签名（可选） ",-1)),t("div",Ct,[t("canvas",{ref:"hrSignatureCanvas",id:"hrSignatureCanvas",class:"w-full h-20 cursor-crosshair",onMousedown:e[22]||(e[22]=r=>P("hr")),onMousemove:e[23]||(e[23]=r=>z("hr")),onMouseup:e[24]||(e[24]=r=>T("hr")),onMouseleave:e[25]||(e[25]=r=>T("hr"))},null,544),t("button",{onClick:e[26]||(e[26]=r=>A("hr")),class:"absolute top-2 right-2 text-xs text-text-secondary hover:text-primary"}," 清除 ")])]),t("div",Tt,[e[56]||(e[56]=t("label",{class:"text-sm font-medium text-text-secondary"}," 审核日期（可选） ",-1)),v(t("input",{"onUpdate:modelValue":e[27]||(e[27]=r=>s(a).hrDate=r),type:"date",class:c(["w-full px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 transition-all","border-gray-200 focus:ring-primary/20 focus:border-primary"])},null,512),[[b,s(a).hrDate]])])])]),t("div",qt,[t("button",{onClick:Q,class:"flex-1 py-3 rounded-lg font-medium bg-gray-100 text-text-primary hover:bg-gray-200 transition-colors"}," 保存草稿 "),t("button",{onClick:te,disabled:s(x),class:c(["flex-1 py-3 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2",s(x)?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-primary to-primary-light text-white hover:shadow-lg hover:scale-[1.02] active:scale-[0.98]"])},[s(x)?(m(),p("svg",Rt,[...e[58]||(e[58]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(m(),p("svg",$t,[...e[59]||(e[59]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])])),y(" "+u(s(x)?"提交中...":"提交申请"),1)],10,Ot)])]),t("div",It,[t("div",Lt,[t("div",Et,[e[63]||(e[63]=t("h2",{class:"text-lg font-bold text-text-primary"},"实时预览",-1)),t("div",jt,[t("button",{onClick:ne,disabled:s(f)<=.5,class:"p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"缩小"},[...e[60]||(e[60]=[t("svg",{class:"w-4 h-4 text-text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])],8,Bt),t("span",Mt,u(Math.round(s(f)*100))+"%",1),t("button",{onClick:re,disabled:s(f)>=1.5,class:"p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"放大"},[...e[61]||(e[61]=[t("svg",{class:"w-4 h-4 text-text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,Nt),t("button",{onClick:oe,class:"p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"全屏"},[...e[62]||(e[62]=[t("svg",{class:"w-4 h-4 text-text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})],-1)])])])]),t("div",{ref:"previewContainer",class:c(["overflow-auto border rounded-lg bg-gray-100",s(O)?"fixed inset-0 z-50 rounded-none":"h-[calc(100vh-300px)]"])},[t("div",{class:"mx-auto bg-white shadow-lg transition-transform origin-top preview-content",style:be({width:"210mm",minHeight:"297mm",padding:"20mm",transform:`scale(${s(f)})`,transformOrigin:"top center"})},[e[74]||(e[74]=t("div",{class:"text-center mb-8"},[t("h1",{class:"text-2xl font-bold text-gray-900 mb-4"},"请假条"),t("div",{class:"border-b-2 border-gray-900"})],-1)),t("div",Vt,[t("div",Pt,[e[64]||(e[64]=t("span",{class:"font-bold text-gray-900 min-w-[80px]"},"姓名：",-1)),t("span",zt,u(s(a).employeeName||"（未填写）"),1)]),t("div",At,[e[65]||(e[65]=t("span",{class:"font-bold text-gray-900 min-w-[80px]"},"部门：",-1)),t("span",Ft,u(s(a).department||"（未填写）"),1)]),t("div",Ut,[e[66]||(e[66]=t("span",{class:"font-bold text-gray-900 min-w-[80px]"},"工号：",-1)),t("span",Ht,u(s(a).employeeId||"（未填写）"),1)]),t("div",Wt,[e[67]||(e[67]=t("span",{class:"font-bold text-gray-900 min-w-[80px]"},"请假类型：",-1)),t("span",Yt,u(s(C).find(r=>r.value===s(a).leaveType)?.label||"（未填写）"),1)]),t("div",Gt,[e[68]||(e[68]=t("span",{class:"font-bold text-gray-900 min-w-[80px]"},"请假天数：",-1)),t("span",Xt,u(s(a).totalDays?`${s(a).totalDays} 天`:"（未填写）"),1)]),t("div",Jt,[e[69]||(e[69]=t("h2",{class:"text-lg font-bold text-gray-900 mb-3"},"请假事由：",-1)),t("p",Zt,u(s(a).leaveReason||"（未填写）"),1)]),t("div",Kt,[e[71]||(e[71]=t("h2",{class:"text-lg font-bold text-gray-900 mb-3"},"部门负责人审批意见",-1)),t("p",Qt,u(s(a).departmentOpinion||"无"),1),t("div",es,[e[70]||(e[70]=t("span",{class:"font-bold text-gray-900 min-w-[80px]"},"审批日期：",-1)),t("span",ts,u(s(a).departmentDate||"无"),1)])]),t("div",ss,[e[73]||(e[73]=t("h2",{class:"text-lg font-bold text-gray-900 mb-3"},"人力资源部审核意见",-1)),t("p",as,u(s(a).hrOpinion||"无"),1),t("div",rs,[e[72]||(e[72]=t("span",{class:"font-bold text-gray-900 min-w-[80px]"},"审核日期：",-1)),t("span",ns,u(s(a).hrDate||"无"),1)])])])],4)],2),t("div",os,[t("button",{onClick:e[28]||(e[28]=r=>U("docx")),disabled:s(S),class:"flex-1 py-2 px-4 rounded-lg font-medium bg-blue-50 text-blue-600 hover:bg-blue-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"},[...e[75]||(e[75]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),y(" 导出 Word ",-1)])],8,ls),t("button",{onClick:e[29]||(e[29]=r=>U("pdf")),disabled:s(S),class:"flex-1 py-2 px-4 rounded-lg font-medium bg-red-50 text-red-600 hover:bg-red-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2"},[...e[76]||(e[76]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),y(" 导出 PDF ",-1)])],8,is)])])])])])]),E(d)])])}}};export{ms as default};
