import{j as e,w as l,o as a,a as t,b as s,c as o,F as r,p as u,t as n,l as i,q as d,s as c,y as v,d as m,B as p,r as g,x as b}from"./BGpdZ-s9.js";import{_ as x}from"./B4wm4ekp.js";import{G as f}from"./BtAA_ILT.js";import{s as y}from"./C2gVa5gV.js";import"./DILYegs3.js";import"./D_BBTi0O.js";import"./9Oz-M6e1.js";import"./DKLvglw8.js";import"./BCo6x5W8.js";const h={class:"space-y-6"},k={key:0,class:"bg-gray-50 p-4 rounded-lg"},w={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4"},j={class:"flex justify-center mb-3"},M={key:0,class:"flex flex-col items-center justify-center bg-gray-100 rounded w-full h-24"},C={key:1,class:"flex flex-col items-center justify-center bg-gray-100 rounded w-full h-24"},B={class:"text-center"},q={class:"font-medium truncate"},V={class:"text-sm text-gray-500"},z={key:0,class:"text-sm text-gray-500"},$=["onClick"],U={key:1,class:"space-y-4"},L={key:0,class:"bg-gray-50 p-4 rounded-lg"},_={class:"space-y-3"},F={class:"text-right text-sm text-gray-500"},P={key:1,class:"bg-gray-50 p-4 rounded-lg"},E={class:"space-y-3"},H={class:"text-right text-sm text-gray-500"},A={class:"bg-gray-50 p-4 rounded-lg"},D={class:"space-y-3"},G={class:"flex space-x-4"},R=["disabled"],S={key:0},T={key:1,class:"flex items-center justify-center"},W={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},I={class:"flex items-center justify-between mb-2"},K={class:"text-blue-700"},O={class:"w-full bg-gray-200 rounded-full h-2.5"},Y={class:"mt-2 text-sm text-blue-700"},Z={key:3,class:"bg-green-50 border border-green-200 rounded-lg p-4"},J={class:"mt-2 text-green-700"},N={class:"mt-3 space-y-2"},Q=["href","download"],X={key:4,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ee={class:"mt-2 text-red-700"},le={key:0,class:"mt-2 text-sm text-gray-600"},ae={__name:"index",setup(ae){const te=g({quality:70,bitrate:"auto",resolution:"original"}),se=g({quality:80,bitrate:"auto"}),oe=g({format:"same"}),re=g([]),ue=b(()=>re.value),ne=g(!1),ie=g(!1),de=g(""),ce=g(""),ve=g(""),me=g(0),pe=g(""),ge=g([]),be=b(()=>ue.value.some(e=>ye(e.name))),xe=b(()=>ue.value.some(e=>he(e.name))),fe=["1. 上传音视频文件：支持MP4、MP3等常见格式","2. 配置压缩参数：根据文件类型设置相应的压缩选项",'3. 点击"开始压缩"按钮进行处理',"4. 等待处理完成，下载压缩后的文件"],ye=e=>[".mp4",".avi",".mov",".wmv",".flv"].some(l=>e.toLowerCase().endsWith(l)),he=e=>[".mp3",".wav",".ogg",".m4a"].some(l=>e.toLowerCase().endsWith(l)),ke=e=>e.split(".").pop().toLowerCase(),we=e=>{if(0===e)return"0 B";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["B","KB","MB","GB"][l]},je=e=>{if(!e)return"";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`},Me=e=>{re.value=e,ce.value="",ie.value=!1},Ce=e=>{ce.value=e,ve.value=Be(e)},Be=e=>e.includes("文件大小")?"请尝试上传 smaller 文件，或分批上传多个文件":e.includes("文件类型")?"请确保上传的文件格式受支持":e.includes("网络")?"请检查网络连接，然后重试":"请检查文件是否损坏，或尝试使用其他文件",qe=async()=>{if(0!==ue.length){ne.value=!0,ce.value="",ve.value="",ie.value=!1,me.value=0,pe.value="准备处理...",ge.value=[];try{await new Promise(e=>{let l=0;const a=y(()=>{l+=Math.floor(10*Math.random())+5,l>100&&(l=100),me.value=l,pe.value=l<30?"正在分析文件...":l<60?"正在压缩音视频...":l<90?"正在优化输出...":"正在生成结果...",100===l&&(clearInterval(a),setTimeout(e,500))},500)});ue.value,te.value,se.value,oe.value;de.value=`成功压缩 ${ue.length} 个音视频文件！`,ie.value=!0,ue.forEach((e,l)=>{const a=ke(e.name),t="same"===oe.value.format?a:oe.value.format,s=new Blob(["模拟压缩后的音视频内容"],{type:ye(e.name)?`video/${t}`:`audio/${t}`}),o=URL.createObjectURL(s),r=`compressed_${e.name.replace(/\.[^/.]+$/,`.${t}`)}`;ge.value.push({url:o,filename:r})}),ge.value.length>0&&setTimeout(()=>{const e=document.createElement("a");e.href=ge.value[0].url,e.download=ge.value[0].filename,document.body.appendChild(e),e.click(),document.body.removeChild(e)},1e3)}catch(e){ce.value=`处理失败：${e.message||"未知错误"}`,ve.value=Be(ce.value)}finally{ne.value=!1}}else ce.value="请选择文件"},Ve=()=>{re.value=[],te.value={quality:70,bitrate:"auto",resolution:"original"},se.value={quality:80,bitrate:"auto"},oe.value={format:"same"},ce.value="",ve.value="",ie.value=!1,de.value="",me.value=0,pe.value="",ge.value=[]};return(g,b)=>(a(),e(x,{title:"音视频压缩",description:"减小音视频文件大小，保持画质音质",tips:fe},{default:l(()=>[t("div",h,[s(f,{multiple:!0,accept:[".mp4",".avi",".mov",".wmv",".flv",".mp3",".wav",".ogg",".m4a"],"max-size":524288e3,modelValue:re.value,"onUpdate:modelValue":b[0]||(b[0]=e=>re.value=e),onFilesChanged:Me,onError:Ce},null,8,["modelValue"]),ue.value.length>0?(a(),o("div",k,[b[9]||(b[9]=t("h3",{class:"text-lg font-semibold mb-2"},"源文件信息",-1)),t("div",w,[(a(!0),o(r,null,u(ue.value,(e,l)=>(a(),o("div",{key:l,class:"bg-white rounded border p-3"},[t("div",j,[ye(e.name)?(a(),o("div",M,[...b[7]||(b[7]=[t("svg",{class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("span",{class:"text-xs text-gray-500 mt-1"},"视频文件",-1)])])):(a(),o("div",C,[...b[8]||(b[8]=[t("svg",{class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3",class:"text-gray-400"})],-1),t("span",{class:"text-xs text-gray-500 mt-1"},"音频文件",-1)])]))]),t("div",B,[t("div",q,n(e.name),1),t("div",V,n(ke(e.name))+" • "+n(we(e.size)),1),e.duration?(a(),o("div",z,n(je(e.duration)),1)):i("",!0)]),t("button",{onClick:e=>(e=>{re.value.splice(e,1),0===re.value.length&&Ve()})(l),class:"mt-2 w-full py-1 text-red-500 hover:text-red-700 text-sm"}," 删除 ",8,$)]))),128))])])):i("",!0),ue.value.length>0?(a(),o("div",U,[be.value?(a(),o("div",L,[b[15]||(b[15]=t("h3",{class:"text-lg font-semibold mb-3"},"视频压缩设置",-1)),t("div",_,[t("div",null,[b[10]||(b[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"视频质量",-1)),d(t("input",{"onUpdate:modelValue":b[1]||(b[1]=e=>te.value.quality=e),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[c,te.value.quality,void 0,{number:!0}]]),t("div",F,n(te.value.quality)+"%",1)]),t("div",null,[b[12]||(b[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"视频比特率",-1)),d(t("select",{"onUpdate:modelValue":b[2]||(b[2]=e=>te.value.bitrate=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[11]||(b[11]=[t("option",{value:"auto"},"自动",-1),t("option",{value:"1000"},"1000 kbps",-1),t("option",{value:"2000"},"2000 kbps",-1),t("option",{value:"3000"},"3000 kbps",-1),t("option",{value:"5000"},"5000 kbps",-1),t("option",{value:"8000"},"8000 kbps",-1)])],512),[[v,te.value.bitrate]])]),t("div",null,[b[14]||(b[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"分辨率",-1)),d(t("select",{"onUpdate:modelValue":b[3]||(b[3]=e=>te.value.resolution=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[13]||(b[13]=[t("option",{value:"original"},"保持原始",-1),t("option",{value:"1920x1080"},"1920x1080 (Full HD)",-1),t("option",{value:"1280x720"},"1280x720 (HD)",-1),t("option",{value:"854x480"},"854x480 (480p)",-1),t("option",{value:"640x360"},"640x360 (360p)",-1)])],512),[[v,te.value.resolution]])])])])):i("",!0),xe.value?(a(),o("div",P,[b[19]||(b[19]=t("h3",{class:"text-lg font-semibold mb-3"},"音频压缩设置",-1)),t("div",E,[t("div",null,[b[16]||(b[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"音频质量",-1)),d(t("input",{"onUpdate:modelValue":b[4]||(b[4]=e=>se.value.quality=e),type:"range",min:"10",max:"100",class:"w-full"},null,512),[[c,se.value.quality,void 0,{number:!0}]]),t("div",H,n(se.value.quality)+"%",1)]),t("div",null,[b[18]||(b[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"音频比特率",-1)),d(t("select",{"onUpdate:modelValue":b[5]||(b[5]=e=>se.value.bitrate=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[17]||(b[17]=[t("option",{value:"auto"},"自动",-1),t("option",{value:"64"},"64 kbps",-1),t("option",{value:"128"},"128 kbps",-1),t("option",{value:"192"},"192 kbps",-1),t("option",{value:"256"},"256 kbps",-1),t("option",{value:"320"},"320 kbps",-1)])],512),[[v,se.value.bitrate]])])])])):i("",!0),t("div",A,[b[22]||(b[22]=t("h3",{class:"text-lg font-semibold mb-3"},"输出设置",-1)),t("div",D,[t("div",null,[b[21]||(b[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"输出格式",-1)),d(t("select",{"onUpdate:modelValue":b[6]||(b[6]=e=>oe.value.format=e),class:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},[...b[20]||(b[20]=[t("option",{value:"same"},"保持原格式",-1),t("option",{value:"mp4"},"MP4 (视频)",-1),t("option",{value:"mp3"},"MP3 (音频)",-1)])],512),[[v,oe.value.format]])])])])])):i("",!0),t("div",G,[t("button",{onClick:qe,disabled:!ue.value.length||ne.value,class:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[ne.value?(a(),o("span",T,[b[23]||(b[23]=t("svg",{class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),m(" 处理中... "+n(me.value)+"% ",1)])):(a(),o("span",S,"开始压缩"))],8,R),t("button",{onClick:Ve,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"}," 重置 ")]),ne.value?(a(),o("div",W,[t("div",I,[b[24]||(b[24]=t("h4",{class:"font-semibold text-blue-800"},"处理进度",-1)),t("span",K,n(me.value)+"%",1)]),t("div",O,[t("div",{class:"bg-blue-600 h-2.5 rounded-full",style:p({width:me.value+"%"})},null,4)]),t("p",Y,n(pe.value),1)])):i("",!0),ie.value?(a(),o("div",Z,[b[25]||(b[25]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-green-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),t("h4",{class:"font-semibold text-green-800"},"处理成功")],-1)),t("p",J,n(de.value),1),t("div",N,[(a(!0),o(r,null,u(ge.value,(e,l)=>(a(),o("a",{key:l,href:e.url,download:e.filename,class:"block px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"}," 下载压缩结果 "+n(l+1),9,Q))),128))])])):i("",!0),ce.value?(a(),o("div",X,[b[26]||(b[26]=t("div",{class:"flex items-center"},[t("svg",{class:"w-6 h-6 text-red-500 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-.77-2.694-.77-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})]),t("h4",{class:"font-semibold text-red-800"},"处理失败")],-1)),t("p",ee,n(ce.value),1),ve.value?(a(),o("p",le,"建议："+n(ve.value),1)):i("",!0)])):i("",!0)])]),_:1}))}};export{ae as default};
